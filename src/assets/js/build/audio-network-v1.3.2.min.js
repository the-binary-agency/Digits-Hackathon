/*
The MIT License (MIT)

Copyright (c) 2015-2018 Robert Rypu≈Ça - https://audio-network.rypula.pl

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/

"use strict";var AudioNetwork={},AudioNetworkBootConfig=AudioNetworkBootConfig||{};AudioNetwork.version="1.3.2",AudioNetwork.isNode=!("undefined"==typeof module||!module.exports),AudioNetwork.isWebWorker=!AudioNetwork.isNode&&"undefined"!=typeof WorkerGlobalScope&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,AudioNetwork.isBrowser=!AudioNetwork.isNode&&!AudioNetwork.isWebWorker&&"undefined"!=typeof navigator&&"undefined"!=typeof document,AudioNetwork.MULTICORE_STATE={DISABLED:"DISABLED",ENABLED_USE_PROD_SCRIPT:"ENABLED_USE_PROD_SCRIPT",ENABLED_USE_DEV_SCRIPT:"ENABLED_USE_DEV_SCRIPT"},AudioNetwork.bootConfig={devScriptBaseUrl:"string"==typeof AudioNetworkBootConfig.devScriptBaseUrl?AudioNetworkBootConfig.devScriptBaseUrl:AudioNetwork.isBrowser?window.location.origin+"/src/":"",prodScriptBaseUrl:"string"==typeof AudioNetworkBootConfig.prodScriptBaseUrl?AudioNetworkBootConfig.prodScriptBaseUrl:AudioNetwork.isBrowser?window.location.origin+"/build/":"",prodScriptName:"string"==typeof AudioNetworkBootConfig.prodScriptName?AudioNetworkBootConfig.prodScriptName:"audio-network-v"+AudioNetwork.version+".min.js",devScriptLoad:void 0!==AudioNetworkBootConfig.devScriptLoad&&!!AudioNetworkBootConfig.devScriptLoad,createAlias:void 0===AudioNetworkBootConfig.createAlias||!!AudioNetworkBootConfig.createAlias,multicoreState:-1!==Object.keys(AudioNetwork.MULTICORE_STATE).indexOf(AudioNetworkBootConfig.multicoreState)?AudioNetworkBootConfig.multicoreState:AudioNetwork.MULTICORE_STATE.DISABLED},AudioNetwork.Injector=function(){var n;return(n=function(){this.$$injectRepository={}}).RESOLVE_RECURSION_LIMIT=20,n.RESOLVE_RECURSION_LIMIT_EXCEED_EXCEPTION="Injector - resolve recursion limit exceed",n.MULTIPLE_REGISTER_EXCEPTION="Injector - multiple register calls for the same name",n.UNABLE_TO_FIND_ITEM_EXCEPTION="Injector - unable to find factory/service for given name: ",n.TYPE={SERVICE:"SERVICE",FACTORY:"FACTORY"},n.$$resolveRecursionCounter=0,n.prototype.$$register=function(e,t,i){if(void 0!==this.$$injectRepository[e])throw n.MULTIPLE_REGISTER_EXCEPTION;this.$$injectRepository[e]={type:i,item:t,resolveCache:null}},n.prototype.registerService=function(e,t){this.$$register(e,t,n.TYPE.SERVICE)},n.prototype.registerFactory=function(e,t){this.$$register(e,t,n.TYPE.FACTORY)},n.prototype.resolve=function(e){var t,i,r=[];if((i=this.$$find(e)).resolveCache)return i.resolveCache;for(this.$$resolveRecursionInc(),t=0;t<i.item.$inject.length;t++)r.push(this.resolve(i.item.$inject[t]));switch(i.type){case n.TYPE.SERVICE:i.resolveCache=this.$$injectDependenciesAndInstantiate(i,r);break;case n.TYPE.FACTORY:i.resolveCache=this.$$injectDependencies(i,r)}return this.$$resolveRecursionDec(),i.resolveCache},n.prototype.$$resolveRecursionInc=function(){if(n.RESOLVE_RECURSION_LIMIT<=++n.$$resolveRecursionCounter)throw n.RESOLVE_RECURSION_LIMIT_EXCEED_EXCEPTION},n.prototype.$$resolveRecursionDec=function(){n.$$resolveRecursionCounter--},n.prototype.$$injectDependenciesAndInstantiate=function(e,t){var i,r=e,n=t;switch(t.length){case 0:i=new r.item;break;case 1:i=new r.item(n[0]);break;case 2:i=new r.item(n[0],n[1]);break;case 3:i=new r.item(n[0],n[1],n[2]);break;case 4:i=new r.item(n[0],n[1],n[2],n[3]);break;case 5:i=new r.item(n[0],n[1],n[2],n[3],n[4]);break;case 6:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5]);break;case 7:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6]);break;case 8:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);break;case 9:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8]);break;case 10:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]);break;case 11:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10]);break;case 12:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11])}return i},n.prototype.$$injectDependencies=function(e,t){var i,r=e,n=t;switch(t.length){case 0:i=r.item();break;case 1:i=r.item(n[0]);break;case 2:i=r.item(n[0],n[1]);break;case 3:i=r.item(n[0],n[1],n[2]);break;case 4:i=r.item(n[0],n[1],n[2],n[3]);break;case 5:i=r.item(n[0],n[1],n[2],n[3],n[4]);break;case 6:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5]);break;case 7:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6]);break;case 8:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);break;case 9:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8]);break;case 10:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]);break;case 11:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10]);break;case 12:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11])}return i},n.prototype.$$find=function(e){var t;for(t in this.$$injectRepository)if(this.$$injectRepository.hasOwnProperty(t)&&t===e)return this.$$injectRepository[t];throw n.UNABLE_TO_FIND_ITEM_EXCEPTION+e},new n}(),AudioNetwork.DynamicScriptLoader=function(){var e;return(e=function(){}).prototype.loadList=function(e,t){var i;for(void 0===t&&(t=0),i=t;i<e.length;i++)this.loadOne(e[i])},e.prototype.loadOne=function(e){document.write('<script src="'+AudioNetwork.bootConfig.devScriptBaseUrl+e+'"><\/script>')},new e}(),AudioNetwork.devScriptList=["audio-network-boot.js","-deprecated-probably/common/math-util/math-util.service.js","-deprecated-probably/common/simple-promise/simple-promise-builder.service.js","-deprecated-probably/common/simple-promise/simple-promise.factory.js","-deprecated-probably/common/stopwatch/stopwatch-builder.service.js","-deprecated-probably/common/stopwatch/stopwatch.factory.js","-deprecated-probably/common/window-function/window-function.service.js","-deprecated-probably/physical-layer-core/receive-multicore-worker/receive-multicore-worker-thread.service.js","-deprecated-probably/physical-layer-core/receive-multicore-worker/receive-multicore-worker.factory.js","-deprecated-probably/physical-layer-core/receive-worker/receive-worker.factory.js","-deprecated/audio/active-audio-context/active-audio-context.service.js","-deprecated/audio/simple-audio-context/simple-audio-context-builder.service.js","-deprecated/audio/simple-audio-context/simple-audio-context.factory.js","-deprecated/common/abstract-value-collector/abstract-value-collector.factory.js","-deprecated/common/average-value-collector/average-value-collector-builder.service.js","-deprecated/common/average-value-collector/average-value-collector.factory.js","-deprecated/common/carrier-generate/carrier-generate-builder.service.js","-deprecated/common/carrier-generate/carrier-generate.factory.js","-deprecated/common/carrier-recovery/carrier-recovery-builder.service.js","-deprecated/common/carrier-recovery/carrier-recovery.factory.js","-deprecated/common/complex/complex-builder.service.js","-deprecated/common/complex/complex.factory.js","-deprecated/common/queue/queue-builder.service.js","-deprecated/common/queue/queue.factory.js","-deprecated/common/util/util.service.js","-deprecated/physical-layer-adapter/guard-power-collector/guard-power-collector-builder.service.js","-deprecated/physical-layer-adapter/guard-power-collector/guard-power-collector.factory.js","-deprecated/physical-layer-adapter/phase-offset-collector/phase-offset-collector-builder.service.js","-deprecated/physical-layer-adapter/phase-offset-collector/phase-offset-collector.factory.js","-deprecated/physical-layer-adapter/receive-adapter-state.service.js","-deprecated/physical-layer-adapter/receive-adapter.factory.js","-deprecated/physical-layer-adapter/rx-state-machine-manager/rx-state-machine-manager-builder.service.js","-deprecated/physical-layer-adapter/rx-state-machine-manager/rx-state-machine-manager.factory.js","-deprecated/physical-layer-adapter/rx-state-machine/rx-state-machine-builder.service.js","-deprecated/physical-layer-adapter/rx-state-machine/rx-state-machine.factory.js","-deprecated/physical-layer-adapter/signal-power-collector/signal-power-collector-builder.service.js","-deprecated/physical-layer-adapter/signal-power-collector/signal-power-collector.factory.js","-deprecated/physical-layer-adapter/transmit-adapter.factory.js","-deprecated/physical-layer/abstract-channel-manager/abstract-channel-manager.factory.js","-deprecated/physical-layer/channel-receive-manager/channel-receive-manager-builder.service.js","-deprecated/physical-layer/channel-receive-manager/channel-receive-manager.factory.js","-deprecated/physical-layer/channel-receive/channel-receive-builder.service.js","-deprecated/physical-layer/channel-receive/channel-receive.factory.js","-deprecated/physical-layer/channel-transmit-manager/channel-transmit-manager-builder.service.js","-deprecated/physical-layer/channel-transmit-manager/channel-transmit-manager.factory.js","-deprecated/physical-layer/channel-transmit/channel-transmit-builder.service.js","-deprecated/physical-layer/channel-transmit/channel-transmit.factory.js","-deprecated/physical-layer/configuration-parser.service.js","-deprecated/physical-layer/default-config.service.js","-deprecated/physical-layer/physical-layer.factory.js","-deprecated/physical-layer/rx-handler/rx-handler-builder.service.js","-deprecated/physical-layer/rx-handler/rx-handler.factory.js","-deprecated/physical-layer/rx-input.service.js","data-link-layer/checksum-service.js","data-link-layer/data-link-layer-builder.js","data-link-layer/data-link-layer.js","data-link-layer/frame.js","data-link-layer/tx-frame-manager.js","data-link-layer/tx-frame.js","dsp/complex.js","dsp/correlator.js","dsp/fft-result.js","dsp/fft.js","dsp/wave-analyser.js","dsp/wave-generator.js","physical-layer/physical-layer-builder.js","physical-layer/physical-layer.js","physical-layer/rx-sync-detector.js","physical-layer/tx-symbol-manager.js","physical-layer/tx-symbol.js","util/buffer.js","util/frequency-calculator.js","util/music-calculator.js","util/smart-timer.js","util/wav-audio-file.js","visualizer/abstract-2d-visualizer/abstract-2d-visualizer.factory.js","visualizer/abstract-visualizer/abstract-visualizer.factory.js","visualizer/analyser-chart/analyser-chart-builder.service.js","visualizer/analyser-chart/analyser-chart-template-axis-x.service.js","visualizer/analyser-chart/analyser-chart-template-main.service.js","visualizer/analyser-chart/analyser-chart.factory.js","visualizer/complex-plane-chart/complex-plane-chart-builder.service.js","visualizer/complex-plane-chart/complex-plane-chart-template-main.service.js","visualizer/complex-plane-chart/complex-plane-chart.factory.js","visualizer/constellation-diagram/constellation-diagram-builder.service.js","visualizer/constellation-diagram/constellation-diagram-template-main.service.js","visualizer/constellation-diagram/constellation-diagram.factory.js","visualizer/frequency-domain-chart/frequency-domain-chart-builder.service.js","visualizer/frequency-domain-chart/frequency-domain-chart-template-main.service.js","visualizer/frequency-domain-chart/frequency-domain-chart.factory.js","visualizer/power-chart/power-chart-builder.service.js","visualizer/power-chart/power-chart-template-main.service.js","visualizer/power-chart/power-chart.factory.js","visualizer/sample-chart/sample-chart-builder.service.js","visualizer/sample-chart/sample-chart-template-main.service.js","visualizer/sample-chart/sample-chart.factory.js","web-audio/audio-mono-io-lite.js","web-audio/audio-mono-io.js","audio-network-end.js"],AudioNetwork.isBrowser&&AudioNetwork.bootConfig.devScriptLoad&&AudioNetwork.DynamicScriptLoader.loadList(AudioNetwork.devScriptList,1),function(){function e(){var n;return(n=function(e,t){this.$$real=e,this.$$imag=t}).$$_EPSILON=1e-6,n.$$_UNIT_RADIUS=1,n.prototype.clone=function(){return new n(this.$$real,this.$$imag)},n.polar=function(e,t){var i;return t=void 0===t?n.$$_UNIT_RADIUS:t,i=2*Math.PI*e,new n(t*Math.cos(i),t*Math.sin(i))},n.zero=function(){return new n(0,0)},n.prototype.swap=function(){var e=this.$$real;return this.$$real=this.$$imag,this.$$imag=e,this},n.prototype.add=function(e){return this.$$real+=e.$$real,this.$$imag+=e.$$imag,this},n.prototype.subtract=function(e){return this.$$real-=e.$$real,this.$$imag-=e.$$imag,this},n.prototype.multiply=function(e){var t=this.$$real*e.$$real-this.$$imag*e.$$imag,i=this.$$real*e.$$imag+this.$$imag*e.$$real;return this.$$real=t,this.$$imag=i,this},n.prototype.conjugate=function(){return this.$$imag*=-1,this},n.prototype.multiplyScalar=function(e){return this.$$real*=e,this.$$imag*=e,this},n.prototype.divideScalar=function(e){return this.$$real/=e,this.$$imag/=e,this},n.prototype.getReal=function(){return this.$$real},n.prototype.getImaginary=function(){return this.$$imag},n.prototype.getMagnitude=function(){return Math.sqrt(this.$$real*this.$$real+this.$$imag*this.$$imag)},n.prototype.getUnitAngle=function(){var e,t,i,r;switch(e=this.$$real,t=this.$$imag,i=(i=this.getMagnitude())<n.$$_EPSILON?n.$$_EPSILON:i,0<=t?0<=e?1:2:e<=0?3:4){case 1:r=Math.asin(t/i);break;case 2:r=Math.asin(-e/i)+.5*Math.PI;break;case 3:r=Math.asin(-t/i)+Math.PI;break;case 4:r=Math.asin(e/i)+1.5*Math.PI}return r/(2*Math.PI)},n.prototype.normalize=function(){return this.divideScalar(this.getMagnitude()),this},n}AudioNetwork.Injector.registerFactory("Rewrite.Dsp.Complex",e),e.$inject=[]}(),function(){function e(r){var s;return(s=function(e,t){this.$$correlationCode=t?t.slice(0):s.DEFAULT_CORRELATION_CODE.slice(0),this.$$skipFactor=void 0,this.$$dataBuffer=void 0,this.$$signalDecibelBuffer=void 0,this.$$noiseDecibelBuffer=void 0,this.$$cacheCorrelactionValue=void 0,this.$$cacheSignalDecibelAverage=void 0,this.$$cacheNoiseDecibelAverage=void 0,this.$$setSkipFactor(e)}).DEFAULT_CORRELATION_CODE=[1,1,1,-1,-1,-1,1,-1,-1,1,-1],s.CORRELATION_POSITIVE="CORRELATION_POSITIVE",s.CORRELATION_NONE="CORRELATION_NONE",s.CORRELATION_NEGATIVE="CORRELATION_NEGATIVE",s.THRESHOLD_UNIT=.9,s.NO_DECIBEL=null,s.NO_DATA=0,s.POSITION_OUT_OF_RANGE_EXCEPTION="Position out of range",s.prototype.reset=function(){this.$$setSkipFactor(this.$$skipFactor)},s.prototype.handle=function(e,t,i){var r,n;switch(r=s.NO_DATA,e){case-1:case 1:r=e}this.$$dataBuffer.pushEvenIfFull(r),n=r&&(t||0===t),this.$$signalDecibelBuffer.pushEvenIfFull(n?t:s.NO_DECIBEL),n=r&&(i||0===i),this.$$noiseDecibelBuffer.pushEvenIfFull(n?i:s.NO_DECIBEL),this.$$clearCache()},s.prototype.isCorrelated=function(){var e=this.getCorrelation();return e===s.CORRELATION_NEGATIVE||e===s.CORRELATION_POSITIVE},s.prototype.getCorrelation=function(){var e=this.getCorrelationValue(),t=Math.floor(s.THRESHOLD_UNIT*this.$$correlationCode.length);return t<=e?s.CORRELATION_POSITIVE:-t<e?s.CORRELATION_NONE:s.CORRELATION_NEGATIVE},s.prototype.getCorrelationValue=function(){var e,t,i,r,n;if(void 0!==this.$$cacheCorrelactionValue)return this.$$cacheCorrelactionValue;for(n=0,t=this.$$skipFactor-1,e=0;e<this.$$correlationCode.length;e++)i=t+e*this.$$skipFactor,(r=this.$$dataBuffer.getItem(i))!==s.NO_DATA&&(n+=r*this.$$correlationCode[e]);return this.$$cacheCorrelactionValue=n},s.prototype.getSignalDecibelAverage=function(){return void 0===this.$$cacheSignalDecibelAverage&&(this.$$cacheSignalDecibelAverage=this.$$getDecibelAverage(this.$$signalDecibelBuffer)),this.$$cacheSignalDecibelAverage},s.prototype.getNoiseDecibelAverage=function(){return void 0===this.$$cacheNoiseDecibelAverage&&(this.$$cacheNoiseDecibelAverage=this.$$getDecibelAverage(this.$$noiseDecibelBuffer)),this.$$cacheNoiseDecibelAverage},s.prototype.getSignalToNoiseRatio=function(){var e=this.getSignalDecibelAverage(),t=this.getNoiseDecibelAverage(),i=0;return e!==s.NO_DECIBEL&&t!==s.NO_DECIBEL&&(i=e-t),i},s.prototype.getCorrelationCodeLength=function(){return this.$$correlationCode.length},s.prototype.$$clearCache=function(){this.$$cacheCorrelactionValue=void 0,this.$$cacheSignalDecibelAverage=void 0,this.$$cacheNoiseDecibelAverage=void 0},s.prototype.$$getDecibelAverage=function(e){var t,i,r,n,o,a;for(a=o=0,i=this.$$skipFactor-1,t=0;t<this.$$correlationCode.length;t++)r=i+t*this.$$skipFactor,(n=e.getItem(r))!==s.NO_DECIBEL&&(o+=n,a++);return 0<a?o/a:s.NO_DECIBEL},s.prototype.$$setSkipFactor=function(e){var t,i;for(e=e||1,i=this.$$correlationCode.length*e,this.$$skipFactor=e,this.$$dataBuffer=new r(i),this.$$signalDecibelBuffer=new r(i),this.$$noiseDecibelBuffer=new r(i),this.$$cacheCorrelactionValue=void 0,this.$$cacheSignalDecibelAverage=void 0,this.$$cacheNoiseDecibelAverage=void 0,t=0;t<i;t++)this.$$dataBuffer.pushEvenIfFull(s.NO_DATA),this.$$signalDecibelBuffer.pushEvenIfFull(s.NO_DECIBEL),this.$$noiseDecibelBuffer.pushEvenIfFull(s.NO_DECIBEL)},s}AudioNetwork.Injector.registerFactory("Rewrite.Dsp.Correlator",e),e.$inject=["Rewrite.Util.Buffer"]}(),function(){function e(){var $;return($=function(e,t){this.$$fftData=e,this.$$sampleRate=t}).$$_FREQUENCY_BIN_INDEX_ZERO=0,$.$$_FREQUENCY_BIN_INDEX_FIRST=1,$.$$_EQUAL_EPSILON=.001,$.$$_HALF=.5,$.VALUES_OUT_OF_RANGE="Values out of range",$.prototype.downconvert=function(e){var t,i,r,n,o=[],a=Math.floor(e/2);for(r=0;r<this.$$fftData.length;r+=e){for(i=this.$$fftData[r],n=Math.max(0,r-a);n<Math.min(r-a+e,this.$$fftData.length);n++)i=this.$$fftData[n]>i?this.$$fftData[n]:i;o.push(i)}t=e*o.length/this.$$fftData.length,this.$$sampleRate*=t,this.$$fftData=o},$.prototype.getLoudestBinIndex=function(e,t){return this.$$getLoudestBinIndexInRange(e,t)},$.prototype.getLoudestBinIndexInBinRange=function(e,t){var i=$.$$_HALF*this.getFFTSize();if(e<0||i<=t)throw $.VALUES_OUT_OF_RANGE;return $.$$findMaxIndexInRange(this.$$fftData,e,t)},$.prototype.getLoudestFrequency=function(e,t){var i=this.$$getLoudestBinIndexInRange(e,t);return $.getFrequency(i,this.$$sampleRate,this.getFFTSize())},$.prototype.getLoudestDecibel=function(e,t){var i=this.$$getLoudestBinIndexInRange(e,t);return this.$$fftData[i]},$.prototype.getDecibelAverage=function(e,t,i){var r,n,o,a,s=$.$$_HALF*this.getFFTSize();if(e<0||s<=t)throw $.VALUES_OUT_OF_RANGE;for(n=r=0,a=e;a<=t;a++)void 0!==i&&a===i||(n+=this.getDecibel(a),r++);return(o=0)<r&&(o=n/r),o},$.prototype.getDecibelRange=function(e,t){var i,r=$.$$_HALF*this.getFFTSize(),n=[];if(e<0||r<=t)throw $.VALUES_OUT_OF_RANGE;for(i=e;i<=t;i++)n.push(this.getDecibel(i));return n},$.prototype.getDecibel=function(e){return this.$$fftData[e]},$.prototype.getDecibelFromFrequency=function(e){var t=this.getBinIndex(e);return this.$$fftData[t]},$.prototype.getFrequencyData=function(){return this.$$fftData},$.prototype.getFrequency=function(e){return $.getFrequency(e,this.$$sampleRate,this.getFFTSize())},$.prototype.getFrequencyOfClosestBin=function(e){return $.getFrequencyOfClosestBin(e,this.$$sampleRate,this.getFFTSize())},$.prototype.getBinIndex=function(e){return $.getBinIndex(e,this.$$sampleRate,this.getFFTSize())},$.prototype.getResolution=function(){return $.getResolution(this.$$sampleRate,this.getFFTSize())},$.prototype.getLastBinIndex=function(){return this.$$fftData.length-1},$.prototype.getLastFrequency=function(){return this.getFrequency(this.getLastBinIndex())},$.prototype.getNyquistFrequency=function(){return $.$$_HALF*this.$$sampleRate},$.prototype.getSampleRate=function(){return this.$$sampleRate},$.prototype.getFFTSize=function(){return 2*this.$$fftData.length},$.prototype.equal=function(e){var t,i,r,n,o;if(r=$.$$isEqual(this.getNyquistFrequency(),e.getNyquistFrequency()),n=$.$$isEqual(this.getFFTSize(),e.getFFTSize()),!r||!n)return!1;for(o=!0,t=0;t<this.$$fftData.length;t++)if(i=Math.abs(this.$$fftData[t]-e.getDecibel(t)),$.$$_EQUAL_EPSILON<i){o=!1;break}return o},$.prototype.$$getLoudestBinIndexInRange=function(e,t){var i,r;return e=$.$$getValueOrDefault(e,$.$$_FREQUENCY_BIN_INDEX_ZERO),t=$.$$getValueOrDefault(t,this.getLastFrequency()),i=this.getBinIndex(e),r=this.getBinIndex(t),$.$$findMaxIndexInRange(this.$$fftData,i,r)},$.$$isEqual=function(e,t){return e===t},$.$$getValueOrDefault=function(e,t){return void 0!==e?e:t},$.$$findMaxIndexInRange=function(e,t,i){var r,n,o;for(r=-1,n=void 0,o=t;o<=i;o++)(-1===r||e[o]>n)&&(n=e[o],r=o);return r},$.getResolution=function(e,t){return $.getFrequency($.$$_FREQUENCY_BIN_INDEX_FIRST,e,t)},$.getFrequency=function(e,t,i){if(e<0||$.$$_HALF*i<=e)throw $.VALUES_OUT_OF_RANGE;return e*t/i},$.getBinIndex=function(e,t,i){var r=Math.round(e*i/t);if(r<0||$.$$_HALF*i<=r)throw $.VALUES_OUT_OF_RANGE;return r},$.getFrequencyOfClosestBin=function(e,t,i){var r=$.getBinIndex(e,t,i);return $.getFrequency(r,t,i)},$}AudioNetwork.Injector.registerFactory("Rewrite.Dsp.FFTResult",e),e.$inject=[]}(),function(){function e(l){var c;return(c=function(){}).forward=function(e){var t,i,r,n,o,a,s=e.length,$=[];if(1===s)return e;for(i=c.forward(c.$$getHalf(e,0)),r=c.forward(c.$$getHalf(e,1)),t=($.length=s)/2,o=0;o<t;o++)a=-o/s,n=l.polar(a).clone().multiply(r[o]),$[o]=i[o].clone().add(n),$[t+o]=i[o].clone().subtract(n);return $},c.inverse=function(e){var t,i=[];for(t=0;t<e.length;t++)i.push(e[t].clone().swap());for(i=c.forward(i),t=0;t<i.length;t++)i[t].swap().divideScalar(i.length);return i},c.$$getHalf=function(e,t){var i,r,n,o;for(r=[],o=e.length/2,i=0;i<o;i++)n=e[2*i+t],r.push(n);return r},c}AudioNetwork.Injector.registerFactory("Rewrite.Dsp.Fft",e),e.$inject=["Rewrite.Dsp.Complex"]}(),function(){function e(s,r){var $;return($=function(e,t,i){e=e||$.$$_DEFAULT_SAMPLE_PER_PERIOD,t=t||$.$$_DEFAULT_WINDOW_SIZE,this.$$cyclePerSample=null,this.$$firstSampleOfBufferNumber=null,this.setSamplePerPeriod(e),this.$$sampleBuffer=new r(t),this.$$applyWindowFunction=!!i,this.$$frequencyBin=null}).$$_UNIT_PHASE=1,$.$$_NEGATIVE_FREQUENCIES_AMPLITUDE_FIX=2,$.$$_PHASE_CORRECTION=.75,$.$$_DECIBEL_POWER_FROM_AMPLITUDE_FACTOR=20,$.$$_DEFAULT_SAMPLE_PER_PERIOD=32,$.$$_DEFAULT_WINDOW_SIZE=1024,$.prototype.$$computeFrequencyBin=function(){var e,t,i,r,n,o,a;for(this.$$frequencyBin=s.zero(),e=this.$$sampleBuffer.getSize(),t=0;t<e;t++)i=this.$$firstSampleOfBufferNumber+t,r=this.$$cyclePerSample*i,n=s.polar(-r),o=this.$$sampleBuffer.getItem(t),n.multiplyScalar(o),this.$$applyWindowFunction&&(a=$.blackman(t,e),n.multiplyScalar(a)),this.$$frequencyBin.add(n)},$.prototype.setSamplePerPeriod=function(e){this.$$cyclePerSample=1/e,this.$$firstSampleOfBufferNumber=0,this.$$frequencyBin=null},$.prototype.setWindowSize=function(e){this.$$sampleBuffer.setSizeMax(e),this.$$firstSampleOfBufferNumber=0,this.$$frequencyBin=null},$.prototype.enableWindowFunction=function(){this.$$applyWindowFunction=!0,this.$$frequencyBin=null},$.prototype.disableWindowFunction=function(){this.$$applyWindowFunction=!1,this.$$frequencyBin=null},$.prototype.handle=function(e){this.$$sampleBuffer.isFull()&&this.$$firstSampleOfBufferNumber++,this.$$sampleBuffer.pushEvenIfFull(e),this.$$frequencyBin=null},$.prototype.getAmplitude=function(){return this.$$frequencyBin||this.$$computeFrequencyBin(),this.$$frequencyBin.getMagnitude()/this.$$sampleBuffer.getSize()*$.$$_NEGATIVE_FREQUENCIES_AMPLITUDE_FIX},$.prototype.getUnitPhase=function(){var e;return this.$$frequencyBin||this.$$computeFrequencyBin(),e=(e=this.$$frequencyBin.getUnitAngle()-$.$$_PHASE_CORRECTION)<0?e+$.$$_UNIT_PHASE:e,(e=$.$$_UNIT_PHASE-e)%$.$$_UNIT_PHASE},$.prototype.getDecibel=function(){var e;return this.$$frequencyBin||this.$$computeFrequencyBin(),e=this.getAmplitude(),$.$$_DECIBEL_POWER_FROM_AMPLITUDE_FACTOR*Math.log(e)/Math.LN10},$.prototype.getFrequencyBin=function(){return this.$$frequencyBin||this.$$computeFrequencyBin(),this.$$frequencyBin.clone()},$.blackmanNuttall=function(e,t){return.3635819-.4891775*Math.cos(2*Math.PI*e/(t-1))+.1365995*Math.cos(4*Math.PI*e/(t-1))-.0106411*Math.cos(6*Math.PI*e/(t-1))},$.blackman=function(e,t){return.42-.5*Math.cos(2*Math.PI*e/(t-1))+.08*Math.cos(4*Math.PI*e/(t-1))},$}AudioNetwork.Injector.registerFactory("Rewrite.Dsp.WaveAnalyser",e),e.$inject=["Rewrite.Dsp.Complex","Rewrite.Util.Buffer"]}(),function(){function e(){var t;return(t=function(e){e=e||t.$$_DEFAULT_SAMPLE_PER_PERIOD,this.$$omega=null,this.$$sampleNumber=null,this.setSamplePerPeriod(e),this.$$phase=t.NO_PHASE_SHIFT,this.$$amplitude=t.UNIT_AMPLITUDE,this.$$sample=null}).UNIT_AMPLITUDE=1,t.NO_PHASE_SHIFT=0,t.$$_DEFAULT_SAMPLE_PER_PERIOD=32,t.prototype.$$computeSample=function(){var e;e=this.$$omega*this.$$sampleNumber,this.$$sample=this.$$amplitude*Math.sin(e-this.$$phase)},t.prototype.setSamplePerPeriod=function(e){this.$$omega=2*Math.PI/e,this.$$sampleNumber=0},t.prototype.setUnitPhase=function(e){this.$$phase=2*Math.PI*e},t.prototype.setAmplitude=function(e){this.$$amplitude=e},t.prototype.nextSample=function(){this.$$sampleNumber++,this.$$sample=null},t.prototype.getSample=function(){return null===this.$$sample&&this.$$computeSample(),this.$$sample},t}AudioNetwork.Injector.registerFactory("Rewrite.Dsp.WaveGenerator",e),e.$inject=[]}(),function(){function e(e){var t;return(t=function(){this._fftSize=8192,this._unitTime=.25,this._fftSkipFactor=3,this._microphoneMode=e.MICROPHONE_MODE_ALWAYS_ON,this._samplePerSymbol=2,this._symbolMin44100=114,this._symbolMin48000=82,this._symbolMinDefault=1,this._symbolRange=258,this._correlationCode=[1,-1,1,-1],this._txSampleRate=44100,this._txAmplitude=.2,this._rxSignalDecibelThresholdFactor=.6,this._rxSymbolListener=void 0,this._rxSyncStatusListener=void 0,this._rxSampleDspDetailsListener=void 0,this._rxSyncDspDetailsListener=void 0,this._rxDspConfigListener=void 0,this._dspConfigListener=void 0,this._txSymbolListener=void 0,this._txSymbolProgressListener=void 0,this._txDspConfigListener=void 0}).prototype.fftSize=function(e){return this._fftSize=e,this},t.prototype.unitTime=function(e){return this._unitTime=e,this},t.prototype.fftSkipFactor=function(e){return this._fftSkipFactor=e,this},t.prototype.microphoneMode=function(e){return this._microphoneMode=e,this},t.prototype.samplePerSymbol=function(e){return this._samplePerSymbol=e,this},t.prototype.symbolMin44100=function(e){return this._symbolMin44100=e,this},t.prototype.symbolMin48000=function(e){return this._symbolMin48000=e,this},t.prototype.symbolMinDefault=function(e){return this._symbolMinDefault=e,this},t.prototype.symbolRange=function(e){return this._symbolRange=e,this},t.prototype.txAmplitude=function(e){return this._txAmplitude=e,this},t.prototype.rxSymbolListener=function(e){return this._rxSymbolListener=e,this},t.prototype.rxSyncStatusListener=function(e){return this._rxSyncStatusListener=e,this},t.prototype.rxSampleDspDetailsListener=function(e){return this._rxSampleDspDetailsListener=e,this},t.prototype.rxSyncDspDetailsListener=function(e){return this._rxSyncDspDetailsListener=e,this},t.prototype.rxDspConfigListener=function(e){return this._rxDspConfigListener=e,this},t.prototype.dspConfigListener=function(e){return this._dspConfigListener=e,this},t.prototype.txSymbolListener=function(e){return this._txSymbolListener=e,this},t.prototype.txSymbolProgressListener=function(e){return this._txSymbolProgressListener=e,this},t.prototype.txDspConfigListener=function(e){return this._txDspConfigListener=e,this},t.prototype.build=function(){return new e(this)},t}AudioNetwork.Injector.registerFactory("Rewrite.PhysicalLayer.PhysicalLayerBuilder",e),e.$inject=["Rewrite.PhysicalLayer.PhysicalLayer"]}(),function(){function e(t,i,r,a,n){var s;return(s=function(e){this.$$fftSize=e._fftSize,this.$$audioMonoIO=new t(this.$$fftSize),this.$$unitTime=e._unitTime,this.$$smartTimer=new i(this.$$unitTime),this.$$smartTimer.setListener(this.$$smartTimerListener.bind(this)),this.$$fftSkipFactor=e._fftSkipFactor,this.$$samplePerSymbol=e._samplePerSymbol,this.$$symbolMin44100=e._symbolMin44100,this.$$symbolMin48000=e._symbolMin48000,this.$$symbolMinDefault=e._symbolMinDefault,this.$$symbolRange=e._symbolRange,this.$$rxSampleRate=this.$$audioMonoIO.getSampleRate(),this.$$txAmplitude=e._txAmplitude,this.$$correlationCode=e._correlationCode.slice(0),this.$$rxSyncDetector=new r(this.$$samplePerSymbol,this.$$correlationCode),this.$$rxSignalDecibelThresholdFactor=e._rxSignalDecibelThresholdFactor,this.$$sampleNumber=s.$$_INITIAL_SAMPLE_NUMER,this.$$sampleOffset=void 0,this.$$rxSymbolId=s.$$_INITIAL_ID,this.$$rxSampleDspDetailsId=s.$$_INITIAL_ID,this.$$rxSyncStatusId=s.$$_INITIAL_ID,this.$$rxSymbol=void 0,this.$$rxSymbolRaw=void 0,this.$$rxSignalDecibel=void 0,this.$$rxSignalDecibelNextCandidate=void 0,this.$$rxNoiseDecibel=void 0,this.$$rxFrequencyData=void 0,this.$$isRxSyncInProgress=void 0,this.$$isRxSymbolSamplingPoint=void 0,this.$$rxSignalDecibelThreshold=s.$$_INITIAL_RX_SIGNAL_DECIBEL_THRESHOLD,this.$$rxSyncDspDetailsLastId=void 0,this.$$txSymbolManager=new n,this.$$rxSymbolMin=this.$$getSymbolMin(this.$$rxSampleRate),this.$$rxSymbolMax=this.$$getSymbolMax(this.$$rxSampleRate),this.$$txSampleRate=void 0,this.$$txSymbolMin=void 0,this.$$txSymbolMax=void 0,this.setTxSampleRate(e._txSampleRate),this.$$rxSymbolListener=s.$$isFunction(e._rxSymbolListener)?e._rxSymbolListener:null,this.$$rxSyncStatusListener=s.$$isFunction(e._rxSyncStatusListener)?e._rxSyncStatusListener:null,this.$$rxSampleDspDetailsListener=s.$$isFunction(e._rxSampleDspDetailsListener)?e._rxSampleDspDetailsListener:null,this.$$rxSyncDspDetailsListener=s.$$isFunction(e._rxSyncDspDetailsListener)?e._rxSyncDspDetailsListener:null,this.$$rxDspConfigListener=s.$$isFunction(e._rxDspConfigListener)?e._rxDspConfigListener:null,this.$$dspConfigListener=s.$$isFunction(e._dspConfigListener)?e._dspConfigListener:null,this.$$txSymbolListener=s.$$isFunction(e._txSymbolListener)?e._txSymbolListener:null,this.$$txSymbolProgressListener=s.$$isFunction(e._txSymbolProgressListener)?e._txSymbolProgressListener:null,this.$$txDspConfigListener=s.$$isFunction(e._txDspConfigListener)?e._txDspConfigListener:null,this.$$firstSmartTimerCall=!0}).MICROPHONE_MODE_ALWAYS_ON=0,s.MICROPHONE_MODE_AUTO_ON_OFF_WITH_GAP=1,s.$$_INITIAL_SAMPLE_NUMER=0,s.$$_INITIAL_ID=0,s.$$_INITIAL_RX_SIGNAL_DECIBEL_THRESHOLD=1/0,s.$$_TX_AMPLITUDE_SILENT=0,s.$$_TX_FREQUENCY_ZERO=0,s.$$_FIRST_SYMBOL=1,s.$$_SYMBOL_SYNC_A_OFFSET=1,s.$$_SYMBOL_SYNC_B_OFFSET=0,s.$$_RX_SYMBOL_IDLE=null,s.SYMBOL_IS_NOT_VALID_EXCEPTION="Symbol is not valid. Please pass number that is inside symbol range.",s.prototype.getRxSampleRate=function(){return this.getRxDspConfig().rxSampleRate},s.prototype.txSync=function(){var e,t,i;for(this.$$txSymbolManager.handleGapLogicAtStart(),e=0;e<this.$$correlationCode.length;e++)t=-1===this.$$correlationCode[e]?this.$$txSymbolMax-s.$$_SYMBOL_SYNC_A_OFFSET:this.$$txSymbolMax-s.$$_SYMBOL_SYNC_B_OFFSET,this.$$txSymbolManager.addTxFskSymbol(t);i=Math.ceil(this.$$correlationCode.length/2)+1,this.$$txSymbolManager.handleGapLogicAtEndOfSync(i),this.$$txSymbolProgressListener&&this.$$txSymbolProgressListener(this.getTxSymbolProgress())},s.prototype.txSymbol=function(e){var t,i,r,n;if(this.$$txSymbolManager.handleGapLogicAtStart(),t="number"==typeof(i=parseInt(e)),r=this.$$txSymbolMin<=i&&i<=this.$$txSymbolMax,!(t&&r))throw s.SYMBOL_IS_NOT_VALID_EXCEPTION;return n=this.$$txSymbolManager.addTxFskSymbol(i),this.$$txSymbolManager.handleGapLogicAtEnd(),this.$$txSymbolProgressListener&&this.$$txSymbolProgressListener(this.getTxSymbolProgress()),n},s.prototype.setTxSampleRate=function(e){this.$$txSampleRate=e,this.$$txSymbolMin=this.$$getSymbolMin(this.$$txSampleRate),this.$$txSymbolMax=this.$$getSymbolMax(this.$$txSampleRate),this.$$txSymbolManager.clearTxSymbolQueue(),this.$$txSymbolProgressListener&&this.$$txSymbolProgressListener(this.getTxSymbolProgress()),this.$$txDspConfigListener&&this.$$txDspConfigListener(this.getTxDspConfig())},s.prototype.setLoopback=function(e){this.$$audioMonoIO.setLoopback(e),this.$$dspConfigListener&&this.$$dspConfigListener(this.getDspConfig())},s.prototype.setUnitTime=function(e){this.$$unitTime=e,this.$$smartTimer.setInterval(e),this.$$dspConfigListener&&this.$$dspConfigListener(this.getDspConfig())},s.prototype.setTxAmplitude=function(e){this.$$txAmplitude=e,this.$$txDspConfigListener&&this.$$txDspConfigListener(this.getTxDspConfig())},s.prototype.getRxSymbol=function(){return{id:this.$$rxSymbolId,rxSymbol:this.$$rxSymbol,rxSampleDspDetailsId:this.$$rxSampleDspDetailsId}},s.prototype.getRxSyncStatus=function(){var e=this.$$rxSyncDetector.getRxSyncDspDetails();return{id:this.$$rxSyncStatusId,isRxSyncInProgress:this.$$isRxSyncInProgress,isRxSyncOk:!!e.id,rxSyncDspDetailsId:e.id,rxSampleDspDetailsId:this.$$rxSampleDspDetailsId}},s.prototype.getRxSampleDspDetails=function(){return{id:this.$$rxSampleDspDetailsId,rxSymbolRaw:this.$$rxSymbolRaw,rxSignalDecibel:this.$$rxSignalDecibel,rxNoiseDecibel:this.$$rxNoiseDecibel,rxFrequencyData:this.$$rxFrequencyData.slice(0),isRxSymbolSamplingPoint:this.$$isRxSymbolSamplingPoint,rxSampleNumber:this.$$sampleNumber,rxSampleOffset:this.$$sampleOffset}},s.prototype.getRxSyncDspDetails=function(){var e=this.$$rxSyncDetector.getRxSyncDspDetails();return{id:e.id,rxSymbolSamplingPointOffset:e.rxSymbolSamplingPointOffset,rxCorrelationValue:e.rxCorrelationValue,rxCorrelationCodeLength:e.rxCorrelationCodeLength,rxSignalDecibelAverage:e.rxSignalDecibelAverage,rxNoiseDecibelAverage:e.rxNoiseDecibelAverage,rxSignalToNoiseRatio:e.rxSignalToNoiseRatio}},s.prototype.getRxDspConfig=function(){var e=this.$$getFrequency(s.$$_FIRST_SYMBOL,this.$$rxSampleRate);return{rxSampleRate:this.$$rxSampleRate,rxSymbolFrequencySpacing:e,rxSymbolMin:this.$$rxSymbolMin,rxSymbolMax:this.$$rxSymbolMax,rxSignalDecibelThreshold:this.$$rxSignalDecibelThreshold,rxSignalDecibelThresholdFactor:this.$$rxSignalDecibelThresholdFactor}},s.prototype.getDspConfig=function(){return{fftSkipFactor:this.$$fftSkipFactor,fftSize:this.$$fftSize,samplePerSymbol:this.$$samplePerSymbol,unitTime:this.$$unitTime,isLoopbackEnabled:this.$$audioMonoIO.isLoopbackEnabled()}},s.prototype.getTxSymbol=function(){return this.$$txSymbolManager.getTxSymbol()},s.prototype.getTxSymbolProgress=function(){return this.$$txSymbolManager.getTxSymbolProgress()},s.prototype.getTxDspConfig=function(){var e=this.$$getFrequency(s.$$_FIRST_SYMBOL,this.$$txSampleRate);return{txSampleRate:this.$$txSampleRate,txSymbolFrequencySpacing:e,txSymbolMin:this.$$txSymbolMin,txSymbolMax:this.$$txSymbolMax,txAmplitude:this.$$txAmplitude}},s.prototype.$$smartTimerListener=function(){this.$$firstSmartTimerCall&&(this.$$rxDspConfigListener&&this.$$rxDspConfigListener(this.getRxDspConfig()),this.$$dspConfigListener&&this.$$dspConfigListener(this.getDspConfig()),this.$$txDspConfigListener&&this.$$txDspConfigListener(this.getTxDspConfig())),this.$$sampleOffset=this.$$sampleNumber%this.$$samplePerSymbol,this.$$rx(),this.$$tx(),this.$$sampleNumber++,this.$$firstSmartTimerCall=!1},s.prototype.$$rx=function(){var e,t,i,r,n,o=!1;if(this.$$rxSampleDspDetailsId++,this.$$rxSyncStatusId++,this.$$txSymbolManager.getTxSymbolCurrent().isIdle()||this.$$audioMonoIO.isLoopbackEnabled())(e=new a(this.$$audioMonoIO.getFrequencyData(),this.$$rxSampleRate)).downconvert(this.$$fftSkipFactor),this.$$rxFrequencyData=e.getFrequencyData(),this.$$rxSymbolRaw=e.getLoudestBinIndexInBinRange(this.$$rxSymbolMin,this.$$rxSymbolMax),this.$$rxSignalDecibel=e.getDecibel(this.$$rxSymbolRaw),this.$$rxSignalDecibelNextCandidate=-1/0,this.$$rxNoiseDecibel=e.getDecibelAverage(this.$$rxSymbolMin,this.$$rxSymbolMax,this.$$rxSymbolRaw);else{for(r=[],n=0;n<.5*this.$$fftSize;n++)r.push(-160);(e=new a(r,this.$$rxSampleRate)).downconvert(this.$$fftSkipFactor),this.$$rxFrequencyData=e.getFrequencyData(),this.$$rxSymbolRaw=this.$$rxSymbolMin,this.$$rxSignalDecibel=-1/0,this.$$rxSignalDecibelNextCandidate=-1/0,this.$$rxNoiseDecibel=-1/0}this.$$handleRxSync(),this.$$isRxSyncInProgress=this.$$rxSyncDetector.isRxSyncInProgress(),(t=this.$$rxSyncDetector.getRxSyncDspDetails()).id&&t.id!==this.$$rxSyncDspDetailsLastId&&(this.$$rxSignalDecibelThreshold=t.rxNoiseDecibelAverage+this.$$rxSignalDecibelThresholdFactor*t.rxSignalToNoiseRatio,this.$$rxSyncDspDetailsLastId=t.id,o=!0),this.$$isRxSymbolSamplingPoint=0<t.id&&this.$$sampleOffset===t.rxSymbolSamplingPointOffset,i=this.$$isRxSymbolSamplingPoint&&this.$$rxSignalDecibel>this.$$rxSignalDecibelThreshold,this.$$rxSymbol=i?this.$$rxSymbolRaw:s.$$_RX_SYMBOL_IDLE,o&&(this.$$rxSyncDspDetailsListener&&this.$$rxSyncDspDetailsListener(this.getRxSyncDspDetails()),this.$$rxDspConfigListener&&this.$$rxDspConfigListener(this.getRxDspConfig())),this.$$rxSampleDspDetailsListener&&this.$$rxSampleDspDetailsListener(this.getRxSampleDspDetails()),this.$$rxSyncStatusListener&&this.$$rxSyncStatusListener(this.getRxSyncStatus()),this.$$isRxSymbolSamplingPoint&&(this.$$rxSymbolId++,this.$$rxSymbolListener&&this.$$rxSymbolListener(this.getRxSymbol()))},s.prototype.$$tx=function(){var e,t;0===this.$$sampleOffset&&(e=this.$$txSymbolManager.isTxAboutToStart(),t=this.$$txSymbolManager.isTxAboutToEnd(),this.$$txSymbolManager.tick(),e&&this.$$audioMonoIO.microphoneDisable(),t&&this.$$audioMonoIO.microphoneEnable(),this.$$updateOscillator(),this.$$txSymbolListener&&this.$$txSymbolListener(this.getTxSymbol()),this.$$txSymbolProgressListener&&this.$$txSymbolProgressListener(this.getTxSymbolProgress()))},s.prototype.$$handleRxSync=function(){var e=null;switch(this.$$rxSymbolRaw){case this.$$rxSymbolMax-s.$$_SYMBOL_SYNC_A_OFFSET:e=-1;break;case this.$$rxSymbolMax-s.$$_SYMBOL_SYNC_B_OFFSET:e=1}this.$$rxSyncDetector.handle(e,this.$$rxSignalDecibel,this.$$rxNoiseDecibel)},s.prototype.$$getSymbolMin=function(e){switch(e){case 44100:return this.$$symbolMin44100;case 48e3:return this.$$symbolMin48000;default:return this.$$symbolMinDefault}},s.prototype.$$getSymbolMax=function(e){return this.$$getSymbolMin(e)+this.$$symbolRange-1},s.prototype.$$updateOscillator=function(){var e,t,i;(i=this.$$txSymbolManager.getTxSymbolCurrent()).isFsk()?(e=this.$$getFrequency(i.getTxFskSymbol(),this.$$txSampleRate),t=this.$$txAmplitude):(e=s.$$_TX_FREQUENCY_ZERO,t=s.$$_TX_AMPLITUDE_SILENT),this.$$audioMonoIO.setPeriodicWave(e,t)},s.prototype.$$getFrequency=function(e,t){var i=a.getFrequency(e,t,this.$$fftSize);return this.$$fftSkipFactor*i},s.$$isFunction=function(e){return"function"==typeof e},s}AudioNetwork.Injector.registerFactory("Rewrite.PhysicalLayer.PhysicalLayer",e),e.$inject=["Rewrite.WebAudio.AudioMonoIO","Rewrite.Util.SmartTimer","Rewrite.PhysicalLayer.RxSyncDetector","Rewrite.Dsp.FFTResult","Rewrite.PhysicalLayer.TxSymbolManager"]}(),function(){function e(i){var c;return(c=function(e,t){this.$$samplePerSymbol=e,this.$$rxSyncInProgress=!1,this.$$rxSyncDspDetails=c.$$getEmpty(),this.$$id=c.$$_INITIAL_ID,this.$$correlator=new i(e,t),this.$$blockHistory=void 0,this.$$rxSampleNumber=c.$$_INITIAL_RX_SAMPLE_NUMBER,this.$$initializeBlockHistory()}).$$_FIRST_ELEMENT=0,c.$$_INITIAL_ID=1,c.$$_INITIAL_RX_SAMPLE_NUMBER=0,c.prototype.isRxSyncInProgress=function(){return this.$$rxSyncInProgress},c.prototype.getRxSyncDspDetails=function(){return this.$$rxSyncDspDetails},c.prototype.handle=function(e,t,i){var r,n,o,a,s,$,l;r=this.$$rxSampleNumber%this.$$samplePerSymbol,n=this.$$blockHistory[r],o=r===this.$$samplePerSymbol-1,this.$$correlator.handle(e,t,i),(a=this.$$correlator.isCorrelated())&&((l=c.$$getEmpty()).rxSymbolSamplingPointOffset=r,l.rxCorrelationValue=this.$$correlator.getCorrelationValue(),l.rxCorrelationCodeLength=this.$$correlator.getCorrelationCodeLength(),l.rxSignalDecibelAverage=this.$$correlator.getSignalDecibelAverage(),l.rxNoiseDecibelAverage=this.$$correlator.getNoiseDecibelAverage(),l.rxSignalToNoiseRatio=this.$$correlator.getSignalToNoiseRatio(),n.decisionList.push(l)),$=n.syncDetected,n.syncJustLost=$&&!a,n.syncDetected=a,o&&(s=this.$$tryToUpdateSync()),this.$$rxSyncInProgress=!s&&this.$$isRxSyncInProgressInHistoryBlock(),this.$$rxSampleNumber++},c.prototype.$$sortByCorrelationValue=function(e,t){return e.rxCorrelationValue<t.rxCorrelationValue?1:e.rxCorrelationValue>t.rxCorrelationValue?-1:0},c.prototype.$$sortBySignalDecibel=function(e,t){return e.rxSignalDecibelAverage<t.rxSignalDecibelAverage?1:e.rxSignalDecibelAverage>t.rxSignalDecibelAverage?-1:0},c.prototype.$$sortDecisionList=function(e){var i=this;e.sort(function(e,t){return i.$$sortByCorrelationValue(e,t)||i.$$sortBySignalDecibel(e,t)})},c.prototype.$$initializeBlockHistory=function(){var e;for(this.$$blockHistory=[],e=0;e<this.$$samplePerSymbol;e++)this.$$blockHistory.push({decisionList:[],syncJustLost:void 0,syncDetected:void 0})},c.prototype.$$resetBlockHistory=function(){var e,t;for(e=0;e<this.$$samplePerSymbol;e++)(t=this.$$blockHistory[e]).decisionList.length=0,t.syncJustLost=void 0,t.syncDetected=void 0},c.prototype.$$getTheBestRxSyncDspDetails=function(){var e,t,i;for(t=[],e=0;e<this.$$samplePerSymbol;e++)0<(i=this.$$blockHistory[e].decisionList).length&&(this.$$sortDecisionList(i),t.push(i[c.$$_FIRST_ELEMENT]));return this.$$sortDecisionList(t),t[c.$$_FIRST_ELEMENT]},c.prototype.$$updateSync=function(){this.$$rxSyncDspDetails=this.$$getTheBestRxSyncDspDetails(),this.$$rxSyncDspDetails.id=this.$$id++,this.$$resetBlockHistory(),this.$$correlator.reset()},c.prototype.$$tryToUpdateSync=function(){var e;for(e=0;e<this.$$samplePerSymbol;e++)if(this.$$blockHistory[e].syncJustLost)return this.$$updateSync(),!0;return!1},c.prototype.$$isRxSyncInProgressInHistoryBlock=function(){var e,t;for(e=0;e<this.$$samplePerSymbol;e++)if((t=this.$$blockHistory[e]).syncDetected||t.syncJustLost)return!0;return!1},c.$$getEmpty=function(){return{id:null,rxSymbolSamplingPointOffset:void 0,rxCorrelationValue:void 0,rxCorrelationCodeLength:void 0,rxSignalDecibelAverage:void 0,rxNoiseDecibelAverage:void 0,rxSignalToNoiseRatio:void 0}},c}AudioNetwork.Injector.registerFactory("Rewrite.PhysicalLayer.RxSyncDetector",e),e.$inject=["Rewrite.Dsp.Correlator"]}(),function(){function e(i){var e;return(e=function(){this.$$txSymbolId=1,this.$$txSymbol=null,this.$$txSymbolCurrent=this.$$getTxSymbolIdle(),this.$$txSymbolQueue=[]}).prototype.clearTxSymbolQueue=function(){this.$$txSymbolQueue.length=0},e.prototype.getTxSymbol=function(){return this.$$txSymbol.cloneClean()},e.prototype.getTxSymbolCurrent=function(){return this.$$txSymbolCurrent},e.prototype.getTxSymbolProgress=function(){var e,t={};for(t.txSymbol=this.getTxSymbol(),t.txSymbolCurrent=this.$$txSymbolCurrent.cloneClean(),t.txSymbolQueue=[],e=0;e<this.$$txSymbolQueue.length;e++)t.txSymbolQueue.push(this.$$txSymbolQueue[e].cloneClean());return t.isTxInProgress=this.isTxInProgress(),t},e.prototype.isTxInProgress=function(){return 0<this.$$txSymbolQueue.length||this.$$txSymbolCurrent.isNotIdle()},e.prototype.addTxFskSymbol=function(e){var t=new i(this.$$txSymbolId++,i.TX_SYMBOL_FSK);return t.setTxFskSymbol(e),this.$$txSymbolQueue.push(t),t.getId()},e.prototype.addTxSymbolGapImportant=function(){var e=new i(this.$$txSymbolId++,i.TX_SYMBOL_GAP_IMPORTANT);this.$$txSymbolQueue.push(e)},e.prototype.addTxSymbolGapDeletable=function(){var e=new i(this.$$txSymbolId++,i.TX_SYMBOL_GAP_DELETABLE);this.$$txSymbolQueue.push(e)},e.prototype.$$getTxSymbolIdle=function(){return new i(this.$$txSymbolId++,i.TX_SYMBOL_IDLE)},e.prototype.isTxAboutToStart=function(){var e=0!==this.$$txSymbolQueue.length;return this.$$txSymbolCurrent.isIdle()&&e},e.prototype.isTxAboutToEnd=function(){return 0===this.$$txSymbolQueue.length&&this.$$txSymbolCurrent.isNotIdle()},e.prototype.tick=function(){var e,t;t=0===this.$$txSymbolQueue.length,this.$$txSymbol=this.$$txSymbolCurrent,t?(e=this.$$getTxSymbolIdle(),this.$$txSymbolCurrent=e):this.$$txSymbolCurrent=this.$$txSymbolQueue.shift()},e.prototype.handleGapLogicAtStart=function(){this.isTxInProgress()?this.$$clearAllDeletableGapFromTheEndOfTheQueue():(this.addTxSymbolGapDeletable(),this.addTxSymbolGapDeletable())},e.prototype.handleGapLogicAtEnd=function(){this.addTxSymbolGapDeletable()},e.prototype.handleGapLogicAtEndOfSync=function(e){var t;for(t=0;t<e;t++)this.addTxSymbolGapImportant()},e.prototype.$$clearAllDeletableGapFromTheEndOfTheQueue=function(){var e;for(e=this.$$txSymbolQueue.length-1;0<=e;e--)if(this.$$txSymbolQueue[e].isNotGapDeletable()){this.$$txSymbolQueue.length=e+1;break}},e}AudioNetwork.Injector.registerFactory("Rewrite.PhysicalLayer.TxSymbolManager",e),e.$inject=["Rewrite.PhysicalLayer.TxSymbol"]}(),function(){function e(){var e;return(e=function(e,t){this.$$id=e,this.$$txSymbolType=t,this.$$txFskSymbol=null}).TX_SYMBOL_IDLE="TX_SYMBOL_IDLE",e.TX_SYMBOL_GAP_IMPORTANT="TX_SYMBOL_GAP_IMPORTANT",e.TX_SYMBOL_GAP_DELETABLE="TX_SYMBOL_GAP_DELETABLE",e.TX_SYMBOL_FSK="TX_SYMBOL_FSK",e.prototype.setTxFskSymbol=function(e){this.$$txFskSymbol=e},e.prototype.cloneClean=function(){return{id:this.$$id,txSymbolType:this.$$txSymbolType,txFskSymbol:this.$$txFskSymbol}},e.prototype.isNotIdle=function(){return this.$$txSymbolType!==e.TX_SYMBOL_IDLE},e.prototype.isIdle=function(){return this.$$txSymbolType===e.TX_SYMBOL_IDLE},e.prototype.isFsk=function(){return this.$$txSymbolType===e.TX_SYMBOL_FSK},e.prototype.isNotGapDeletable=function(){return this.$$txSymbolType!==e.TX_SYMBOL_GAP_DELETABLE},e.prototype.getId=function(){return this.$$id},e.prototype.getTxFskSymbol=function(){return this.$$txFskSymbol},e}AudioNetwork.Injector.registerFactory("Rewrite.PhysicalLayer.TxSymbol",e),e.$inject=[]}(),function(){function e(){var r;return(r=function(e){this.$$data=[],this.$$positionStart=null,this.$$positionEnd=null,this.$$size=null,this.$$sizeMax=null,this.setSizeMax(e)}).prototype.clone=function(){var e,t=new r(this.$$sizeMax),i=this.$$data.length;for(t.$$positionStart=this.$$positionStart,t.$$positionEnd=this.$$positionEnd,t.$$size=this.$$size,e=0;e<i;e++)t[e]=this.$$data[e];return t},r.prototype.setSizeMax=function(e){this.$$positionStart=0,this.$$positionEnd=0,this.$$size=0,this.$$sizeMax=e,this.$$data.length=0,this.$$data.length=e},r.prototype.push=function(e){return this.$$size!==this.$$sizeMax&&(this.$$data[this.$$positionEnd]=e,this.$$positionEnd=(this.$$positionEnd+1)%this.$$sizeMax,this.$$size++,!0)},r.prototype.pushEvenIfFull=function(e){this.isFull()&&this.pop(),this.push(e)},r.prototype.pop=function(){var e;return 0===this.$$size?null:(e=this.$$data[this.$$positionStart],this.$$positionStart=(this.$$positionStart+1)%this.$$sizeMax,this.$$size--,e)},r.prototype.getItem=function(e){return e>=this.$$size||e<0?null:this.$$data[(this.$$positionStart+e)%this.$$sizeMax]},r.prototype.getSize=function(){return this.$$size},r.prototype.getSizeMax=function(){return this.$$sizeMax},r.prototype.isFull=function(){return this.$$size===this.$$sizeMax},r.prototype.getAll=function(){var e,t=[];for(e=0;e<this.getSize();e++)t.push(this.getItem(e));return t},r.prototype.fillWith=function(e){var t;for(t=0;t<this.getSizeMax();t++)this.pushEvenIfFull(e)},r}AudioNetwork.Injector.registerFactory("Rewrite.Util.Buffer",e),e.$inject=[]}(),function(){function e(){var i;return(i=function(e,t){if(this.$$sampleRateProvider=e||null,this.$$windowSizeProvider=t||null,!this.$$sampleRateProvider||!this.$$windowSizeProvider)throw i.PLEASE_SET_BOTH_PROVIDERS}).PLEASE_SET_BOTH_PROVIDERS="Please set both providers",i.$$isFunction=function(e){return"function"==typeof e},i.prototype.getSamplePerPeriodFromHertz=function(e){return(i.$$isFunction(this.$$sampleRateProvider)?this.$$sampleRateProvider():this.$$sampleRateProvider)/e},i.prototype.getHertzFromSamplePerPeriod=function(e){return(i.$$isFunction(this.$$sampleRateProvider)?this.$$sampleRateProvider():this.$$sampleRateProvider)/e},i.prototype.getCyclePerWindowFromHertz=function(e){return e*(i.$$isFunction(this.$$windowSizeProvider)?this.$$windowSizeProvider():this.$$windowSizeProvider)/(i.$$isFunction(this.$$sampleRateProvider)?this.$$sampleRateProvider():this.$$sampleRateProvider)},i.prototype.getHertzFromCyclePerWindow=function(e){var t;return t=i.$$isFunction(this.$$windowSizeProvider)?this.$$windowSizeProvider():this.$$windowSizeProvider,e*(i.$$isFunction(this.$$sampleRateProvider)?this.$$sampleRateProvider():this.$$sampleRateProvider)/t},i.prototype.getSamplePerPeriodFromCyclePerWindow=function(e){return(i.$$isFunction(this.$$windowSizeProvider)?this.$$windowSizeProvider():this.$$windowSizeProvider)/e},i.prototype.getCyclePerWindowFromSamplePerPeriod=function(e){return(i.$$isFunction(this.$$windowSizeProvider)?this.$$windowSizeProvider():this.$$windowSizeProvider)/e},i}AudioNetwork.Injector.registerFactory("Rewrite.Util.FrequencyCalculator",e),e.$inject=[]}(),function(){function e(){var n;return(n=function(e){this.$$a4Frequency=e||n.A4_FREQUENCY_DEFAULT}).C4_A4_DELTA=9,n.A4_FREQUENCY_DEFAULT=440,n.SEMITONE_PER_OCTAVE=12,n.OCTAVE_MIN=0,n.OCTAVE_HOLDING_A4=4,n.OCTAVE_MAX=10,n.NOTE_NAME_LIST=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],n.prototype.getSemitoneNumber=function(e){var t,i;return e<=0?null:(t=Math.log(e/this.$$a4Frequency)/Math.log(2),i=Math.round(n.SEMITONE_PER_OCTAVE*t+n.C4_A4_DELTA),n.$$checkSemitoneNumberRange(i),i)},n.prototype.getFrequency=function(e){var t;return n.$$checkSemitoneNumberRange(e),t=(e-n.C4_A4_DELTA)/n.SEMITONE_PER_OCTAVE,this.$$a4Frequency*Math.pow(2,t)},n.prototype.getNoteName=function(e){return n.getNoteName(e)},n.getNoteName=function(e){var t,i,r;return n.$$checkSemitoneNumberRange(e),t=n.OCTAVE_HOLDING_A4*n.SEMITONE_PER_OCTAVE+e,i=Math.floor(t/n.SEMITONE_PER_OCTAVE),r=t%n.SEMITONE_PER_OCTAVE,n.NOTE_NAME_LIST[r]+i},n.prototype.getFirstSemitoneNumber=function(e){return n.getFirstSemitoneNumber(e)},n.getFirstSemitoneNumber=function(e){return e<0?null:(e-n.OCTAVE_HOLDING_A4)*n.SEMITONE_PER_OCTAVE},n.$$checkSemitoneNumberRange=function(e){},n}AudioNetwork.Injector.registerFactory("Rewrite.Util.MusicCalculator",e),e.$inject=[]}(),function(){function e(){var n;return(n=function(e){this.$$interval=null,this.$$intervalCounter=null,this.$$timeRefference=null,this.$$timeoutId=null,this.$$listener=void 0,this.setInterval(e)}).$$_MILISECOND_IN_SECOND=1e3,n.$$isFunction=function(e){return"function"==typeof e},n.prototype.setInterval=function(e){null!==this.$$timeoutId&&clearTimeout(this.$$timeoutId),this.$$interval=e,this.$$intervalCounter=0,this.$$timeRefference=new Date,this.$$scheduleNext()},n.prototype.setListener=function(e){n.$$isFunction(e)?this.$$listener=e.bind(e):this.$$listener=null},n.prototype.$$scheduleNext=function(){var e,t,i=new Date(this.$$timeRefference),r=new Date;this.$$intervalCounter++,e=n.$$_MILISECOND_IN_SECOND*this.$$interval*this.$$intervalCounter,i.setMilliseconds(i.getMilliseconds()+e),t=i.getTime()-r.getTime(),this.$$timeoutId=setTimeout(this.$$notifyListener.bind(this),t)},n.prototype.$$notifyListener=function(){this.$$listener&&this.$$listener(),this.$$scheduleNext()},n}AudioNetwork.Injector.registerFactory("Rewrite.Util.SmartTimer",e),e.$inject=[]}(),function(){function e(){var a;return(a=function(){}).$$_MONO_CHANNEL_COUNT=1,a.$$writeString=function(e,t,i){var r;for(r=0;r<i.length;r++)e.setUint8(t+r,i.charCodeAt(r))},a.$$clipToUnit=function(e){return e=1<(e=e<-1?-1:e)?1:e},a.$$floatTo16BitPCM=function(e,t,i){var r,n,o;for(r=0;r<i.length;r++)o=(n=a.$$clipToUnit(i[r]))<0?32768*n:32767*n,e.setInt16(t,o,!0),t+=2},a.$$getObjectUrl=function(e){return(window.URL||window.webkitURL).createObjectURL(e)},a.$$pad=function(e,t){var i="000000"+e;return i.substr(i.length-t)},a.getFilename=function(){var e=new Date;return""+e.getFullYear()+a.$$pad(e.getMonth()+1,2)+a.$$pad(e.getDate(),2)+"_"+a.$$pad(e.getHours(),2)+a.$$pad(e.getMinutes(),2)+a.$$pad(e.getSeconds(),2)+"_"+a.$$pad(e.getMilliseconds(),3)+".wav"},a.getBlobUrl=function(e,t){var i,r=new ArrayBuffer(44+2*e.length),n=new DataView(r);return a.$$writeString(n,0,"RIFF"),n.setUint32(4,36+2*e.length,!0),a.$$writeString(n,8,"WAVE"),a.$$writeString(n,12,"fmt "),n.setUint32(16,16,!0),n.setUint16(20,1,!0),n.setUint16(22,a.$$_MONO_CHANNEL_COUNT,!0),n.setUint32(24,t,!0),n.setUint32(28,4*t,!0),n.setUint16(32,2*a.$$_MONO_CHANNEL_COUNT,!0),n.setUint16(34,16,!0),a.$$writeString(n,36,"data"),n.setUint32(40,2*e.length,!0),a.$$floatTo16BitPCM(n,44,e),i=new Blob([n],{type:"audio/wav"}),a.$$getObjectUrl(i)},a}AudioNetwork.Injector.registerFactory("Rewrite.Util.WavAudioFile",e),e.$inject=[]}(),function(){function e(){var i;return(i=function(e){this.$$audioContext=null,this.$$microphone=null,this.$$microphoneVirtual=null,this.$$sampleInProcessor=null,this.$$sampleOutProcessor=null,this.$$volume=null,this.$$bufferSize=i.$$getValueOrDefault(e,i.BUFFER_SIZE),this.$$loopback=!1,this.$$sampleInHandler=null,this.$$sampleOutHandler=null,this.$$initialize()}).$$firstInstance=!0,i.$$_MONO=1,i.$$_MONO_INDEX=0,i.$$_NO_CHANNEL=0,i.BUFFER_SIZE=4096,i.prototype.$$initialize=function(){this.$$normalizeBrowserApi(),this.$$audioContext=this.$$createAudioContext(),this.$$microphoneVirtual=this.$$audioContext.createGain(),this.$$volume=this.$$audioContext.createGain(),this.$$volume.connect(this.$$audioContext.destination)},i.prototype.$$normalizeBrowserApi=function(){i.$$firstInstance&&(this.$$crossBrowserAudioContext(),this.$$crossBrowserMediaDevices(),i.$$firstInstance=!1)},i.prototype.$$crossBrowserAudioContext=function(){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext},i.prototype.$$crossBrowserMediaDevices=function(){var r;void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(i){return(r=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia)?new Promise(function(e,t){r.call(navigator,i,e,t)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))})},i.prototype.$$logAndRethrow=function(e,t){throw alert(t),console.log(e),e},i.prototype.$$createAudioContext=function(){var e;try{e=new window.AudioContext}catch(e){this.$$logAndRethrow(e,"AudioContext creation failed")}return e},i.prototype.$$connectMicrophoneTo=function(t){var i=this;navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then(function(e){i.$$microphone=i.$$audioContext.createMediaStreamSource(e),i.$$microphone.connect(t)}).catch(function(e){i.$$logAndRethrow(e,"Microphone initialization failed")})},i.prototype.$$onAudioProcessInHandler=function(e){var t;i.$$isFunction(this.$$sampleInHandler)&&(t=e.inputBuffer.getChannelData(i.$$_MONO_INDEX),this.$$sampleInHandler(t))},i.prototype.$$onAudioProcessOutHandler=function(e){var t;i.$$isFunction(this.$$sampleOutHandler)&&(t=e.outputBuffer.getChannelData(i.$$_MONO_INDEX),this.$$sampleOutHandler(t))},i.$$isFunction=function(e){return"function"==typeof e},i.$$getValueOrDefault=function(e,t){return void 0!==e?e:t},i.prototype.$$setImmediately=function(e,t){var i=this.$$audioContext.currentTime;e.value=t,e.setValueAtTime(t,i)},i.prototype.setLoopback=function(e){this.$$loopback!==!!e&&(this.$$lazyLoadSampleInProcessor(),this.$$loopback?(this.$$volume.disconnect(this.$$sampleInProcessor),this.$$volume.connect(this.$$audioContext.destination),this.$$microphoneVirtual.connect(this.$$sampleInProcessor)):(this.$$microphoneVirtual.disconnect(this.$$sampleInProcessor),this.$$volume.disconnect(this.$$audioContext.destination),this.$$volume.connect(this.$$sampleInProcessor)),this.$$loopback=!!e)},i.prototype.setVolume=function(e){this.$$setImmediately(this.$$volume.gain,e)},i.prototype.$$lazyLoadSampleInProcessor=function(){this.$$sampleInProcessor||(this.$$sampleInProcessor=this.$$audioContext.createScriptProcessor(this.$$bufferSize,i.$$_MONO,i.$$_MONO),this.$$sampleInProcessor.onaudioprocess=this.$$onAudioProcessInHandler.bind(this),this.$$sampleInProcessor.connect(this.$$audioContext.destination),this.$$microphoneVirtual.connect(this.$$sampleInProcessor),this.$$connectMicrophoneTo(this.$$microphoneVirtual))},i.prototype.$$lazyLoadSampleOutProcessor=function(){this.$$sampleOutProcessor||(this.$$sampleOutProcessor=this.$$audioContext.createScriptProcessor(this.$$bufferSize,i.$$_NO_CHANNEL,i.$$_MONO),this.$$sampleOutProcessor.onaudioprocess=this.$$onAudioProcessOutHandler.bind(this),this.$$sampleOutProcessor.connect(this.$$volume))},i.prototype.setSampleInHandler=function(e){i.$$isFunction(e)?(this.$$lazyLoadSampleInProcessor(),this.$$sampleInHandler=e.bind(e)):this.$$sampleInHandler=null},i.prototype.setSampleOutHandler=function(e){i.$$isFunction(e)?(this.$$lazyLoadSampleOutProcessor(),this.$$sampleOutHandler=e.bind(e)):this.$$sampleOutHandler=null},i.prototype.getSampleRate=function(){return this.$$audioContext.sampleRate},i}AudioNetwork.Injector.registerFactory("Rewrite.WebAudio.AudioMonoIOLite",e),e.$inject=[]}(),function(){function e(){var s;return(s=function(e,t,i){this.$$audioContext=null,this.$$microphoneStream=null,this.$$microphone=null,this.$$microphoneVirtual=null,this.$$masterIn=null,this.$$masterOut=null,this.$$masterOutVolume=null,this.$$sampleProcessor=null,this.$$inAnalyzer=null,this.$$outOscillator=null,this.$$outOscillatorGain=null,this.$$fftSize=s.$$getValueOrDefault(e,s.FFT_SIZE),this.$$bufferSize=s.$$getValueOrDefault(t,s.BUFFER_SIZE),this.$$smoothingTimeConstant=s.$$getValueOrDefault(i,s.SMOOTHING_TIME_CONSTANT),this.$$sampleInHandler=null,this.$$sampleOutHandler=null,this.$$loopbackEnabled=!1,this.$$initialize()}).$$firstInstance=!0,s.$$_MONO=1,s.$$_MONO_INDEX=0,s.$$_OUTPUT_WAVE_FREQUENCY=0,s.$$_OUTPUT_WAVE_VOLUME=1,s.$$_OUTPUT_WAVE_PHASE=0,s.$$_OUTPUT_WAVE_HARMONIC_AMPLITUDE=[1],s.$$_OUTPUT_WAVE_HARMONIC_PHASE=[0],s.FFT_SIZE=2048,s.BUFFER_SIZE=4096,s.SMOOTHING_TIME_CONSTANT=0,s.START_TIME_NEEDS_TO_GREATER_THAN_END_TIME_EXCEPTION="Start time needs to greater than end time",s.prototype.$$normalizeBrowserApi=function(){s.$$firstInstance&&(this.$$crossBrowserAudioContext(),this.$$crossBrowserMediaDevices(),s.$$firstInstance=!1)},s.prototype.$$initialize=function(){this.$$normalizeBrowserApi(),this.$$audioContext=this.$$createAudioContext(),this.$$initializeCommon(),this.$$initializeInput(),this.$$initializeOutput(),this.$$sourceAttach(),this.$$masterOutVolume.connect(this.$$audioContext.destination)},s.prototype.$$sourceDetach=function(){this.$$loopbackEnabled?this.$$masterOut.disconnect(this.$$masterIn):this.$$microphoneVirtual.disconnect(this.$$masterIn)},s.prototype.$$sourceAttach=function(){this.$$loopbackEnabled?this.$$masterOut.connect(this.$$masterIn):this.$$microphoneVirtual.connect(this.$$masterIn)},s.prototype.$$initializeCommon=function(){this.$$microphoneVirtual=this.$$audioContext.createGain(),this.$$connectMicrophoneTo(this.$$microphoneVirtual),this.$$masterIn=this.$$audioContext.createGain(),this.$$masterOut=this.$$audioContext.createGain(),this.$$masterOutVolume=this.$$audioContext.createGain(),this.$$sampleProcessor=this.$$audioContext.createScriptProcessor(this.$$bufferSize,s.$$_MONO,s.$$_MONO),this.$$sampleProcessor.onaudioprocess=this.$$onAudioProcessHandler.bind(this),this.$$masterIn.connect(this.$$sampleProcessor),this.$$sampleProcessor.connect(this.$$masterOut),this.$$masterOut.connect(this.$$masterOutVolume)},s.prototype.$$initializeInput=function(){this.$$inAnalyzer=this.$$audioContext.createAnalyser(),this.setFFTSize(this.$$fftSize),this.setSmoothingTimeConstant(this.$$smoothingTimeConstant),this.$$masterIn.connect(this.$$inAnalyzer)},s.prototype.$$initializeOutput=function(){this.$$outOscillator=this.$$audioContext.createOscillator(),this.$$outOscillatorGain=this.$$audioContext.createGain(),this.setPeriodicWave(s.$$_OUTPUT_WAVE_FREQUENCY,s.$$_OUTPUT_WAVE_VOLUME,s.$$_OUTPUT_WAVE_PHASE,s.$$_OUTPUT_WAVE_HARMONIC_AMPLITUDE,s.$$_OUTPUT_WAVE_HARMONIC_PHASE),this.$$outOscillator.start(),this.$$outOscillator.connect(this.$$outOscillatorGain),this.$$outOscillatorGain.connect(this.$$masterOut)},s.prototype.$$crossBrowserAudioContext=function(){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext},s.prototype.$$crossBrowserMediaDevices=function(){var r;void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(i){return(r=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia)?new Promise(function(e,t){r.call(navigator,i,e,t)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))})},s.prototype.$$logAndRethrow=function(e,t){throw alert(t),console.log(e),e},s.prototype.$$createAudioContext=function(){var e;try{e=new window.AudioContext}catch(e){this.$$logAndRethrow(e,"AudioContext creation failed")}return e},s.prototype.$$resumeAudioContext=function(){"suspended"===this.$$audioContext.state&&this.$$audioContext.resume()},s.prototype.$$connectMicrophoneTo=function(t){var i=this;navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then(function(e){i.$$microphoneStream=e,i.$$microphone=i.$$audioContext.createMediaStreamSource(e),i.$$microphone.connect(t)}).catch(function(e){i.$$logAndRethrow(e,"Microphone initialization failed")})},s.prototype.$$onAudioProcessHandler=function(e){var t,i;t=e.inputBuffer.getChannelData(s.$$_MONO_INDEX),i=e.outputBuffer.getChannelData(s.$$_MONO_INDEX),s.$$isFunction(this.$$sampleInHandler)&&this.$$sampleInHandler(t),s.$$isFunction(this.$$sampleOutHandler)&&this.$$sampleOutHandler(i,t)},s.prototype.$$setLinearly=function(e,t,i,r){var n=this.$$audioContext.currentTime;if(r<=i)throw s.START_TIME_NEEDS_TO_GREATER_THAN_END_TIME_EXCEPTION;e.setValueAtTime(e.value,n+i),e.linearRampToValueAtTime(t,n+r)},s.prototype.$$setImmediately=function(e,t){var i=this.$$audioContext.currentTime;e.value=t,e.setValueAtTime(t,i)},s.$$isFunction=function(e){return"function"==typeof e},s.$$getValueOrDefault=function(e,t){return void 0!==e?e:t},s.prototype.microphoneDisable=function(){var e;this.$$microphone&&(this.$$microphone.disconnect(this.$$microphoneVirtual),this.$$microphone=null,this.$$microphoneStream&&"function"==typeof this.$$microphoneStream.getTracks&&(e=this.$$microphoneStream.getTracks())&&0<e.length&&"function"==typeof e[0].stop&&(e[0].stop(),this.$$microphoneStream=null))},s.prototype.microphoneEnable=function(){this.$$connectMicrophoneTo(this.$$microphoneVirtual)},s.prototype.setVolume=function(e){this.$$setImmediately(this.$$masterOutVolume.gain,e)},s.prototype.isLoopbackEnabled=function(){return this.$$loopbackEnabled},s.prototype.setLoopback=function(e){return e=!!e,this.$$loopbackEnabled!==e&&(this.$$sourceDetach(),this.$$loopbackEnabled=e,this.$$sourceAttach(),!0)},s.prototype.setPeriodicWaveFading=function(e,t,i){this.$$setLinearly(this.$$outOscillatorGain.gain,e,t,i)},s.prototype.setPeriodicWave=function(e,t,i,r,n){var o,a;this.$$resumeAudioContext(),a=void 0===i&&void 0===r&&void 0===n,e=s.$$getValueOrDefault(e,s.$$_OUTPUT_WAVE_FREQUENCY),((t=s.$$getValueOrDefault(t,s.$$_OUTPUT_WAVE_VOLUME))||0===t)&&this.$$setImmediately(this.$$outOscillatorGain.gain,t),(e||0===e)&&this.$$setImmediately(this.$$outOscillator.frequency,e),a?this.$$outOscillator.type="sine":(i=s.$$getValueOrDefault(i,s.$$_OUTPUT_WAVE_PHASE),r=s.$$getValueOrDefault(r,s.$$_OUTPUT_WAVE_HARMONIC_AMPLITUDE),n=s.$$getValueOrDefault(n,s.$$_OUTPUT_WAVE_HARMONIC_PHASE),o=this.$$getPeriodicWave(i,r,n),this.$$outOscillator.setPeriodicWave(o))},s.prototype.$$getPeriodicWave=function(e,t,i){var r,n,o,a,s,$;if(t.length!==i.length)throw"Length of amplitude and phase arrays should match";if(t.length<1)throw"Amplitude and phase arrays should have at least one item";for(r=new Float32Array(1+t.length),n=new Float32Array(1+t.length),s=2*Math.PI*-e,a=n[r[0]=0]=0;a<t.length;a++)$=s*(o=1+a)+2*Math.PI*-i[a],r[o]=t[a]*Math.sin($),n[o]=t[a]*Math.cos($);return this.$$audioContext.createPeriodicWave(r,n)},s.prototype.setSampleInHandler=function(e){s.$$isFunction(e)?this.$$sampleInHandler=e.bind(e):this.$$sampleInHandler=null},s.prototype.setSampleOutHandler=function(e){s.$$isFunction(e)?this.$$sampleOutHandler=e.bind(e):this.$$sampleOutHandler=null},s.prototype.setFFTSize=function(e){this.$$fftSize=e,this.$$inAnalyzer.fftSize!==this.$$fftSize&&(this.$$inAnalyzer.fftSize=this.$$fftSize)},s.prototype.getFFTSize=function(){return this.$$fftSize},s.prototype.setSmoothingTimeConstant=function(e){this.$$smoothingTimeConstant=e,this.$$inAnalyzer.smoothingTimeConstant!==this.$$smoothingTimeConstant&&(this.$$inAnalyzer.smoothingTimeConstant=this.$$smoothingTimeConstant)},s.prototype.getFrequencyData=function(){var e;return this.$$resumeAudioContext(),e=new Float32Array(this.$$inAnalyzer.frequencyBinCount),this.$$inAnalyzer.getFloatFrequencyData(e),e},s.prototype.getTimeDomainData=function(){var e;return this.$$resumeAudioContext(),e=new Float32Array(this.$$inAnalyzer.fftSize),this.$$inAnalyzer.getFloatTimeDomainData(e),e},s.prototype.getSampleRate=function(){return this.$$audioContext.sampleRate},s.prototype.getFFTResolution=function(){return this.getSampleRate()/audioMonoIO.getFFTSize()},s}AudioNetwork.Injector.registerFactory("Rewrite.WebAudio.AudioMonoIO",e),e.$inject=[]}(),function(){function e(){var e;return(e=function(){}).fletcher8=function(e){var t,i,r,n,o;for(r=i=t=0;r<2*e.length;r++)n=r%2==0,o=e[r>>>1],i=(i+(t=(t+(n?(240&o)>>>4:15&o))%15))%15;return i<<4|t},e}AudioNetwork.Injector.registerFactory("Rewrite.DataLinkLayer.ChecksumService",e),e.$inject=[]}(),function(){function e(e){var t;return(t=function(){this._framePayloadLengthLimit=7,this._rxFrameListener=void 0,this._rxFrameCandidateListener=void 0,this._txFrameListener=void 0,this._txFrameProgressListener=void 0,this._rxSymbolListener=void 0,this._rxSampleDspDetailsListener=void 0,this._rxSyncDspDetailsListener=void 0,this._rxDspConfigListener=void 0,this._dspConfigListener=void 0,this._txSymbolProgressListener=void 0,this._txDspConfigListener=void 0}).prototype.framePayloadLengthLimit=function(e){return this._framePayloadLengthLimit=e,this},t.prototype.rxFrameListener=function(e){return this._rxFrameListener=e,this},t.prototype.txFrameListener=function(e){return this._txFrameListener=e,this},t.prototype.txFrameProgressListener=function(e){return this._txFrameProgressListener=e,this},t.prototype.rxFrameCandidateListener=function(e){return this._rxFrameCandidateListener=e,this},t.prototype.rxSymbolListener=function(e){return this._rxSymbolListener=e,this},t.prototype.rxSampleDspDetailsListener=function(e){return this._rxSampleDspDetailsListener=e,this},t.prototype.rxSyncStatusListener=function(e){return this._rxSyncStatusListener=e,this},t.prototype.rxSyncDspDetailsListener=function(e){return this._rxSyncDspDetailsListener=e,this},t.prototype.rxDspConfigListener=function(e){return this._rxDspConfigListener=e,this},t.prototype.dspConfigListener=function(e){return this._dspConfigListener=e,this},t.prototype.txSymbolListener=function(e){return this._txSymbolListener=e,this},t.prototype.txSymbolProgressListener=function(e){return this._txSymbolProgressListener=e,this},t.prototype.txDspConfigListener=function(e){return this._txDspConfigListener=e,this},t.prototype.build=function(){return new e(this)},t}AudioNetwork.Injector.registerFactory("Rewrite.DataLinkLayer.DataLinkLayerBuilder",e),e.$inject=["Rewrite.DataLinkLayer.DataLinkLayer"]}(),function(){function e(t,i,s,$){var l;return(l=function(e){this.$$physicalLayer=(new t).rxSymbolListener(this.$$rxSymbolListener.bind(this)).rxSampleDspDetailsListener(e._rxSampleDspDetailsListener).rxSyncStatusListener(e._rxSyncStatusListener).rxSyncDspDetailsListener(e._rxSyncDspDetailsListener).rxDspConfigListener(e._rxDspConfigListener).dspConfigListener(e._dspConfigListener).txSymbolListener(this.$$txSymbolListener.bind(this)).txSymbolProgressListener(e._txSymbolProgressListener).txDspConfigListener(e._txDspConfigListener).build(),this.$$framePayloadLengthLimit=e._framePayloadLengthLimit,this.$$frame=void 0,this.$$frameId=l.$$_INITIAL_ID,this.$$frameCandidateId=l.$$_INITIAL_ID,this.$$frameCandidateList=[],this.$$txFrameManager=new i,this.$$rxFrameListener=l.$$isFunction(e._rxFrameListener)?e._rxFrameListener:null,this.$$rxFrameCandidateListener=l.$$isFunction(e._rxFrameCandidateListener)?e._rxFrameCandidateListener:null,this.$$txFrameListener=l.$$isFunction(e._txFrameListener)?e._txFrameListener:null,this.$$txFrameProgressListener=l.$$isFunction(e._txFrameProgressListener)?e._txFrameProgressListener:null,this.$$externalRxSymbolListener=l.$$isFunction(e._rxSymbolListener)?e._rxSymbolListener:null,this.$$externalTxSymbolListener=l.$$isFunction(e._txSymbolListener)?e._txSymbolListener:null}).PAYLOAD_TO_BIG_EXCEPTION="Payload is too big!",l.COMMAND_TWO_WAY_SYNC_44100=0,l.COMMAND_TWO_WAY_SYNC_48000=1,l.$$_HEADER_FRAME_START_MARKER=224,l.$$_HEADER_RESERVED_BIT=8,l.$$_HEADER_COMMAND_BIT_SET=16,l.$$_HEADER_COMMAND_BIT_NOT_SET=0,l.$$_HEADER_PAYLOAD_LENGTH_MASK=15,l.$$_ONE_BYTE_MASK=255,l.$$_PAYLOAD_TYPE_COMMAND="PAYLOAD_TYPE_COMMAND",l.$$_PAYLOAD_TYPE_DATA="PAYLOAD_TYPE_DATA",l.$$_INITIAL_ID=1,l.$$_HEADER_AND_CHECKSUM_BYTE_OVERHEAD=2,l.prototype.getPhysicalLayer=function(){return this.$$physicalLayer},l.prototype.getRxSampleRate=function(){return this.$$physicalLayer.getRxDspConfig().rxSampleRate},l.prototype.setTxSampleRate=function(e){this.$$physicalLayer.setTxSampleRate(e)},l.prototype.txSync=function(){this.$$physicalLayer.txSync()},l.prototype.txTwoWaySync=function(){switch(this.txSync(),this.getRxSampleRate()){case 44100:this.txFrame([l.COMMAND_TWO_WAY_SYNC_44100],!0);break;case 48e3:this.txFrame([l.COMMAND_TWO_WAY_SYNC_48000],!0)}},l.prototype.setLoopback=function(e){this.$$physicalLayer.setLoopback(e)},l.prototype.getFramePayloadLengthLimit=function(){return this.$$framePayloadLengthLimit},l.prototype.txFrame=function(e,t){var i,r,n,o,a;if(e.length>this.$$framePayloadLengthLimit)throw l.PAYLOAD_TO_BIG_EXCEPTION;for(i=new s(this.$$txFrameManager.getNextTxFrameId(),e,t),r=this.$$physicalLayer.getTxDspConfig().txSymbolMin,n=0;n<i.getTxByteLength();n++)o=r+i.getTxByte(n),a=this.$$physicalLayer.txSymbol(o),i.addTxSymbolId(a);return this.$$txFrameManager.addTxFrame(i),this.$$txFrameProgressListener&&this.$$txFrameProgressListener(this.getTxFrameProgress()),i.getId()},l.prototype.getTxFrame=function(){return this.$$txFrameManager.getTxFrameCloned()},l.prototype.getTxFrameProgress=function(){return this.$$txFrameManager.getTxFrameProgressCloned()},l.prototype.getRxFrame=function(){var e=this.$$frame;return e?{id:e.id,header:e.rxFrameHeader,pyload:e.rxFramePayload.slice(0),checksum:e.rxFrameChecksum,isCommand:e.isRxFrameCommand,rxFrameCandidateId:e.rxFrameCandidateId}:null},l.prototype.getRxFrameCandidate=function(){var e,t,i,r=[];for(e=0;e<this.$$frameCandidateList.length;e++)i={id:(t=this.$$frameCandidateList[e]).id,byteReceived:t.rxByteReceived.slice(0),byteExpected:t.rxByteExpected,unitProgress:t.rxByteReceived.length/t.rxByteExpected,isFullyReceived:t.rxByteReceived.length===t.rxByteExpected,isValid:t.isRxFrameCandidateValid,rxSampleDspDetailsId:t.rxSampleDspDetailsId.slice(0)},r.push(i);return r},l.prototype.$$handleRxSymbol=function(e){var t,i,r=this.$$physicalLayer.getRxSampleDspDetails(),n=this.$$physicalLayer.getRxDspConfig().rxSymbolMin,o=r.rxSymbolRaw-n&l.$$_ONE_BYTE_MASK,a=r.id;this.$$cleanUpFrameCandidateList(),this.$$addNewByteToFrameCandidateList(o,a),this.$$tryToCreateNewFrameCandidate(o,a),t=this.$$tryToFindNewFrame(),this.$$rxFrameCandidateListener&&this.$$rxFrameCandidateListener(this.getRxFrameCandidate()),t&&(this.$$frame.isRxFrameCommand&&(i=this.$$frame.rxFramePayload[0],this.$$handleReceivedCommand(i)),this.$$rxFrameListener&&this.$$rxFrameListener(this.getRxFrame()))},l.prototype.$$handleTxSymbol=function(e){var t,i;t=e.id,this.$$txFrameManager.handleTxSymbolId(t),(i=this.$$txFrameManager.getTxFrameCloned())&&this.$$txFrameListener&&this.$$txFrameListener(i),this.$$txFrameProgressListener&&this.$$txFrameProgressListener(this.getTxFrameProgress())},l.prototype.$$cleanUpFrameCandidateList=function(){var e,t;for(e=this.$$frameCandidateList.length-1;0<=e;e--)(t=this.$$frameCandidateList[e]).rxByteReceived.length===t.rxByteExpected&&this.$$frameCandidateList.splice(e,1)},l.prototype.$$addNewByteToFrameCandidateList=function(e,t){var i,r,n,o;for(i=0;i<this.$$frameCandidateList.length;i++)(r=this.$$frameCandidateList[i]).rxByteReceived.length<r.rxByteExpected&&(r.rxByteReceived.push(e),r.rxSampleDspDetailsId.push(t)),r.rxByteReceived.length===r.rxByteExpected-1&&(n=r.rxByteReceived,r.rxChecksumExpected=$.fletcher8(n)),r.rxByteReceived.length===r.rxByteExpected&&(o=r.rxByteReceived[r.rxByteReceived.length-1],r.isRxFrameCandidateValid=r.rxChecksumExpected===o)},l.prototype.$$tryToCreateNewFrameCandidate=function(e,t){var i,r,n;l.$$isValidHeader(e)&&(r=e,n=l.$$getPayloadLength(r),i={id:this.$$frameCandidateId++,rxByteReceived:[r],rxByteExpected:n+l.$$_HEADER_AND_CHECKSUM_BYTE_OVERHEAD,isRxFrameCandidateValid:!1,rxChecksumExpected:null,rxSampleDspDetailsId:[t]},this.$$frameCandidateList.push(i))},l.prototype.$$tryToFindNewFrame=function(){var e,t;for(e=0;e<this.$$frameCandidateList.length;e++)if((t=this.$$frameCandidateList[e]).isRxFrameCandidateValid)return this.$$frame=l.$$getRxFrameFromFrameCandidate(t,this.$$frameId++),!0;return!1},l.prototype.$$handleReceivedCommand=function(e){switch(e){case l.COMMAND_TWO_WAY_SYNC_44100:this.setTxSampleRate(44100),this.txSync();break;case l.COMMAND_TWO_WAY_SYNC_48000:this.setTxSampleRate(48e3),this.txSync()}},l.prototype.$$txSymbolListener=function(e){this.$$externalTxSymbolListener&&this.$$externalTxSymbolListener(e),this.$$handleTxSymbol(e)},l.prototype.$$rxSymbolListener=function(e){this.$$externalRxSymbolListener&&this.$$externalRxSymbolListener(e),this.$$handleRxSymbol(e)},l.$$getRxFrameFromFrameCandidate=function(e,t){var i;return{id:t,rxFrameHeader:i=e.rxByteReceived[0],rxFramePayload:e.rxByteReceived.slice(1,e.rxByteReceived.length-1),rxFrameChecksum:e.rxByteReceived[e.rxByteReceived.length-1],isRxFrameCommand:l.$$getIsCommand(i),rxFrameCandidateId:e.id}},l.$$buildFrame=function(e,t){var i,r,n,o,a,s;for(i=[],r=e===l.$$_PAYLOAD_TYPE_COMMAND,n=l.$$getHeader(r,t.length),i.push(n),a=0;a<t.length;a++)s=t[a]&l.$$_ONE_BYTE_MASK,i.push(s);return o=$.fletcher8(i),i.push(o),i},l.$$getHeader=function(e,t){return l.$$_HEADER_FRAME_START_MARKER|(e?l.$$_HEADER_COMMAND_BIT_SET:l.$$_HEADER_COMMAND_BIT_NOT_SET)|(t=l.$$_HEADER_PAYLOAD_LENGTH_MASK&t)},l.$$isValidHeader=function(e){var t,i;return t=(l.$$_HEADER_FRAME_START_MARKER&e)===l.$$_HEADER_FRAME_START_MARKER,i=!(l.$$_HEADER_RESERVED_BIT&e),t&&i},l.$$getPayloadLength=function(e){return e&l.$$_HEADER_PAYLOAD_LENGTH_MASK},l.$$getIsCommand=function(e){return!!(e&l.$$_HEADER_COMMAND_BIT_SET)},l.$$isFunction=function(e){return"function"==typeof e},l}AudioNetwork.Injector.registerFactory("Rewrite.DataLinkLayer.DataLinkLayer",e),e.$inject=["Rewrite.PhysicalLayer.PhysicalLayerBuilder","Rewrite.DataLinkLayer.TxFrameManager","Rewrite.DataLinkLayer.TxFrame","Rewrite.DataLinkLayer.ChecksumService"]}(),function(){function e(t){var o;return(o=function(e,t,i){this.$$id=e,this.$$header=void 0,this.$$payload=[],this.$$checksum=void 0,this.setPayload(t,i)}).$$_HEADER_FRAME_START_MARKER=224,o.$$_HEADER_COMMAND_BIT_SET=16,o.$$_HEADER_COMMAND_BIT_NOT_SET=0,o.$$_HEADER_PAYLOAD_LENGTH_MASK=15,o.$$_ONE_BYTE_MASK=255,o.prototype.getId=function(){return this.$$id},o.prototype.getHeader=function(){return this.$$header},o.prototype.getPayload=function(){return this.$$payload},o.prototype.getChecksum=function(){return this.$$checksum},o.prototype.setPayload=function(e,t){var i,r,n;for(i=[],this.$$header=o.$$generateHeader(t,e.length),i.push(this.$$header),r=this.$$payload.length=0;r<e.length;r++)n=e[r]&o.$$_ONE_BYTE_MASK,this.$$payload.push(n),i.push(n);this.$$checksum=o.$$computeChecksum(i)},o.$$computeChecksum=function(e){return t.fletcher8(e)},o.$$generateHeader=function(e,t){return o.$$_HEADER_FRAME_START_MARKER|(e?o.$$_HEADER_COMMAND_BIT_SET:o.$$_HEADER_COMMAND_BIT_NOT_SET)|(t&=o.$$_HEADER_PAYLOAD_LENGTH_MASK)},o}AudioNetwork.Injector.registerFactory("Rewrite.DataLinkLayer.Frame",e),e.$inject=["Rewrite.DataLinkLayer.ChecksumService"]}(),function(){function e(){var e;return(e=function(){this.$$txFrameId=e.$$_INITIAL_TX_FRAME_ID,this.$$txFrame=null,this.$$txFrameCurrent=null,this.$$txFrameQueue=[]}).$$_INITIAL_TX_FRAME_ID=1,e.prototype.getNextTxFrameId=function(){return this.$$txFrameId++},e.prototype.getTxFrameCloned=function(){return this.$$txFrame?this.$$txFrame.cloneClean():null},e.prototype.getTxFrameProgressCloned=function(){var e,t={};for(t.txFrame=this.getTxFrameCloned(),t.txFrameCurrent=this.$$txFrameCurrent?this.$$txFrameCurrent.cloneClean():null,t.txFrameQueue=[],e=0;e<this.$$txFrameQueue.length;e++)t.txFrameQueue.push(this.$$txFrameQueue[e].cloneClean());return t.isTxFrameInProgress=this.isTxFrameInProgress(),t},e.prototype.isTxFrameInProgress=function(){return 0<this.$$txFrameQueue.length||!!this.$$txFrameCurrent},e.prototype.addTxFrame=function(e){this.$$txFrameQueue.push(e)},e.prototype.handleTxSymbolId=function(e){var t,i;t=0<this.$$txFrameQueue.length,this.$$txFrameCurrent?(i=this.$$txFrameCurrent.tryToConfirmTxSymbolId(e),this.$$txFrameCurrent.isFullyTransmitted()&&(this.$$txFrame=this.$$txFrameCurrent,this.$$txFrameCurrent=t?this.$$txFrameQueue.shift():null)):(this.$$txFrame=null,this.$$txFrameCurrent=t?this.$$txFrameQueue.shift():null),this.$$txFrameCurrent&&!i&&this.$$txFrameCurrent.tryToConfirmTxSymbolId(e)},e}AudioNetwork.Injector.registerFactory("Rewrite.DataLinkLayer.TxFrameManager",e),e.$inject=[]}(),function(){function e(r){var i;return(((i=function(e,t,i){r.call(this,e,t,i),this.$$txSymbolId=[],this.$$txSymbolTransmitted=0}).prototype=Object.create(r.prototype)).constructor=i).TX_BYTE_INDEX_OUT_OF_RANGE_EXCEPTION="TX_BYTE_INDEX_OUT_OF_RANGE_EXCEPTION",i.prototype.cloneClean=function(){return{id:this.$$id,header:this.$$header,payload:this.$$payload.slice(0),checksum:this.$$checksum,isFullyTransmitted:this.isFullyTransmitted(),unitProgress:this.getUnitProgress(),txSymbolId:this.$$txSymbolId.slice(0),txSymbolTransmitted:this.$$txSymbolTransmitted}},i.prototype.getTxByteLength=function(){return this.$$payload.length+2},i.prototype.addTxSymbolId=function(e){this.$$txSymbolId.push(e)},i.prototype.tryToConfirmTxSymbolId=function(e){return!!i.$$inArray(this.$$txSymbolId,e)&&(this.$$txSymbolTransmitted++,!0)},i.prototype.isFullyTransmitted=function(){return this.$$txSymbolId.length===this.$$txSymbolTransmitted},i.prototype.getUnitProgress=function(){return this.$$txSymbolTransmitted/this.$$txSymbolId.length},i.prototype.getTxByte=function(e){var t=this.getTxByteLength();if(e<0||t<=e)throw i.TX_BYTE_INDEX_OUT_OF_RANGE_EXCEPTION;return 0===e?this.$$header:e===t-1?this.$$checksum:this.$$payload[e-1]},i.$$inArray=function(e,t){var i;for(i=0;i<e.length;i++)if(e[i]===t)return!0;return!1},i}AudioNetwork.Injector.registerFactory("Rewrite.DataLinkLayer.TxFrame",e),e.$inject=["Rewrite.DataLinkLayer.Frame"]}(),function(){function e(r,s,$){function n(e,t){var i,r,n,o,a;for(n=[],o=!!(r=s.accessor(e,t+".channel")),a=(r=r||[]).length,i=0;i<(o?a:2);i++)n.push({baseFrequency:s.accessor(r[i],"baseFrequency")||(i%2==0?$.CHANNEL_1_FREQUENCY:$.CHANNEL_2_FREQUENCY),ofdmSize:s.accessor(r[i],"ofdmSize")||$.OFDM_SIZE,ofdmFrequencySpacing:s.accessor(r[i],"ofdmFrequencySpacing")||$.OFDM_FREQUENCY_SPACING});return n}return{parse:function(e){var t=e,i=s.accessor;return{tx:{bufferSize:t&&t.tx&&void 0!==t.tx.bufferSize?t.tx.bufferSize:0,channel:n(t,"tx")},rx:{bufferSize:t&&t.rx&&void 0!==t.rx.bufferSize?t.rx.bufferSize:0,channel:n(t,"rx"),input:i(t,"rx.input")||$.RX_INPUT,notificationPerSecond:i(t,"rx.notificationPerSecond")||$.RX_NOTIFICATION_PER_SECOND,dftWindowTime:i(t,"rx.dftWindowTime")||$.RX_DFT_WINDOW_TIME,spectrum:{elementId:i(t,"rx.spectrum.elementId")||null,color:{axis:i(t,"rx.spectrum.color.axis")||"#444",data:i(t,"rx.spectrum.color.data")||"#888888"},fftSize:i(t,"rx.spectrum.fftSize")||$.RX_SPECTRUM_FFT_SIZE,height:i(t,"rx.spectrum.height")||200},constellationDiagram:{elementId:i(t,"rx.constellationDiagram.elementId")||null,color:{historyPoint:{red:{newest:i(t,"rx.constellationDiagram.color.historyPoint.red.newest")||0,tailNewest:i(t,"rx.constellationDiagram.color.historyPoint.red.tailNewest")||100,tailOldest:i(t,"rx.constellationDiagram.color.historyPoint.red.tailOldest")||180},green:{newest:i(t,"rx.constellationDiagram.color.historyPoint.green.newest")||0,tailNewest:i(t,"rx.constellationDiagram.color.historyPoint.green.tailNewest")||100,tailOldest:i(t,"rx.constellationDiagram.color.historyPoint.green.tailOldest")||200},blue:{newest:i(t,"rx.constellationDiagram.color.historyPoint.blue.newest")||0,tailNewest:i(t,"rx.constellationDiagram.color.historyPoint.blue.tailNewest")||100,tailOldest:i(t,"rx.constellationDiagram.color.historyPoint.blue.tailOldest")||150}},axis:i(t,"rx.constellationDiagram.color.axis")||"green"},historyPointSize:r.round(i(t,"rx.constellationDiagram.historyPointSize")||$.RX_HISTORY_POINT_SIZE),width:i(t,"rx.constellationDiagram.width")||200,height:i(t,"rx.constellationDiagram.height")||200}}}}}}AudioNetwork.Injector.registerService("PhysicalLayer.ConfigurationParser",e),e.$inject=["Common.MathUtil","Common.Util","PhysicalLayer.DefaultConfig"]}(),function(){function e(e,t){var i=t.round(1/.065*2.5),r=i;return{CONSTELLATION_DIAGRAM_DECIBEL_LIMIT:-40,MINIMUM_POWER_DECIBEL:-99,FAKE_NOISE_MAX_AMPLITUDE:.001,CHANNEL_1_FREQUENCY:1070,CHANNEL_2_FREQUENCY:2025,OFDM_SIZE:1,OFDM_FREQUENCY_SPACING_POSITIVE_INTEGER:2,OFDM_FREQUENCY_SPACING:2/.065,SYMBOL_FREQUENCY:1/.065,SYMBOL_FREQUENCY_FACTOR:2.5,RX_INPUT:e.MICROPHONE,RX_NOTIFICATION_PER_SECOND:i,RX_HISTORY_POINT_SIZE:r,RX_DFT_WINDOW_TIME:.065,RX_SPECTRUM_FFT_SIZE:1024,BAUD:4,BAUD_MULTIPLICATIVE_INVERSE:.25,FACTOR_SYMBOL:.26,FACTOR_GUARD:.74,SYNC_DURATION:2,SYMBOL_DURATION:.065,GUARD_INTERVAL:.185,FACTOR_INTERPACKET_GAP:5,INTERPACKET_GAP:.925,PSK_SIZE:2,SYNC_PREAMBLE:!0}}AudioNetwork.Injector.registerService("PhysicalLayer.DefaultConfig",e),e.$inject=["PhysicalLayer.RxInput","Common.MathUtil"]}(),function(){function e(a,s,$,t,i,r,e,n,l,o,c,h){var u;return(u=function(e){this.$$configuration=t.parse(e),this.$$channelTransmitManager=null,this.$$channelReceiveManager=null,this.$$currentInput=null,this.$$rxAnalyser=null,this.$$rxAnalyserChart=null,this.$$rxConstellationDiagram=[],this.$$outputTx=void 0,this.$$outputMicrophone=void 0,this.$$outputRecordedAudio=void 0,this.$$rxExternalHandler={callback:null},this.$$rxHandler=r.build(this.$$rxConstellationDiagram,this.$$rxExternalHandler),this.$$initTx(),this.$$initRx(),this.setRxInput(this.$$configuration.rx.input)}).prototype.$$initTx=function(){this.$$channelTransmitManager=e.build(this.$$configuration.tx.channel,this.$$configuration.tx.bufferSize),this.outputTxEnable(),this.outputMicrophoneDisable(),this.outputRecordedAudioDisable()},u.prototype.$$initConstellationDiagram=function(e,t){var i,r,n,o;for(r=[],n=[],i=0;i<t.ofdmSize;i++){if(o=(o=(o=this.$$configuration.rx.constellationDiagram.elementId).replace("{{ channelIndex }}",e+"")).replace("{{ ofdmIndex }}",i+""),!document.getElementById(o))throw"Constellation diagram DOM element not found";r.push(a.build(this.$$configuration.rx.constellationDiagram.historyPointSize)),n.push(l.build(document.getElementById(o),this.$$configuration.rx.constellationDiagram.width,this.$$configuration.rx.constellationDiagram.height,r[r.length-1],$.CONSTELLATION_DIAGRAM_DECIBEL_LIMIT,this.$$configuration.rx.constellationDiagram.color.axis,this.$$configuration.rx.constellationDiagram.color.historyPoint))}this.$$rxConstellationDiagram.push({constellationDiagram:n,queue:r})},u.prototype.$$initRx=function(){var e,t,i=s.round(c.getSampleRate()*this.$$configuration.rx.dftWindowTime),r=s.round(c.getSampleRate()/this.$$configuration.rx.notificationPerSecond);for(t=0;t<this.$$configuration.rx.channel.length;t++)(e=this.$$configuration.rx.channel[t]).dftWindowSize=i,e.notifyInterval=r,e.notifyHandler=this.$$rxHandler.handle.bind(this.$$rxHandler),this.$$configuration.rx.constellationDiagram.elementId&&this.$$initConstellationDiagram(t,e);if(this.$$channelReceiveManager=n.build(this.$$configuration.rx.channel,this.$$configuration.rx.bufferSize),this.$$rxAnalyser=c.createAnalyser(),this.$$rxAnalyser.fftSize=this.$$configuration.rx.spectrum.fftSize,this.$$rxAnalyser.connect(this.$$channelReceiveManager.getInputNode()),this.$$configuration.rx.spectrum.elementId){if(!document.getElementById(this.$$configuration.rx.spectrum.elementId))throw"Spectrum DOM element not found";this.$$rxAnalyserChart=o.build(document.getElementById(this.$$configuration.rx.spectrum.elementId),this.$$rxAnalyser,this.$$configuration.rx.spectrum.height,this.$$configuration.rx.spectrum.color.data,this.$$configuration.rx.spectrum.color.axis)}},u.prototype.$$getTxInputNode=function(e){var t=null;switch(e){case i.MICROPHONE:t=c.getMicrophoneNode();break;case i.LOOPBACK:t=this.$$channelTransmitManager.getOutputNode();break;case i.RECORDED_AUDIO:t=c.getRecordedAudioNode()}return t},u.prototype.getRxInput=function(){return this.$$currentInput},u.prototype.setRxInput=function(e){var t;this.$$currentInput&&this.$$getTxInputNode(this.$$currentInput).disconnect(this.$$rxAnalyser),(t=this.$$getTxInputNode(e))?(t.connect(this.$$rxAnalyser),this.$$currentInput=e,this.$$currentInput===i.LOOPBACK?this.$$channelTransmitManager.enableFakeNoise():this.$$channelTransmitManager.disableFakeNoise()):this.$$currentInput=null},u.prototype.getTxBufferSize=function(){return this.$$channelTransmitManager.getBufferSize()},u.prototype.getRxBufferSize=function(){return this.$$channelReceiveManager.getBufferSize()},u.prototype.loadRecordedAudio=function(e){return c.loadRecordedAudio(e)},u.prototype.tx=function(e,t){var i,r,n=this.$$channelTransmitManager.getChannel(e),o=[];if(!t)throw"Please specify data to send";for(r=0;r<t.length;r++){if(!(i=t[r]).duration)throw"Tx - duration of all data items should be > 0";o.push({amplitude:void 0!==i.amplitude?i.amplitude:1,duration:s.round(c.getSampleRate()*i.duration),phase:void 0!==i.phase?i.phase:0})}n.addToQueue(o)},u.prototype.rx=function(e){this.$$rxExternalHandler.callback="function"==typeof e?e:null},u.prototype.getSampleRate=function(){return c.getSampleRate()},u.prototype.destroy=function(){var e,t,i=[];if(this.setRxInput(null),this.$$rxAnalyserChart&&(i.push(this.$$rxAnalyserChart.destroy()),this.$$rxAnalyserChart=null),this.$$rxAnalyser.disconnect(this.$$channelReceiveManager.getInputNode()),this.$$rxConstellationDiagram)for(e=0;e<this.$$rxConstellationDiagram.length;e++)for(t=0;t<this.$$rxConstellationDiagram[e].constellationDiagram.length;t++)i.push(this.$$rxConstellationDiagram[e].constellationDiagram[t].destroy());return this.$$channelReceiveManager.destroy(),this.$$channelReceiveManager=null,this.outputTxDisable(),this.outputRecordedAudioDisable(),this.outputMicrophoneDisable(),this.$$channelTransmitManager.destroy(),this.$$channelTransmitManager=null,this.$$rxHandler.destroy(),h.buildFromList(i)},u.prototype.getOutputTxState=function(){return this.$$outputTx},u.prototype.getOutputMicrophoneState=function(){return this.$$outputMicrophone},u.prototype.getOutputRecordedAudioState=function(){return this.$$outputRecordedAudio},u.prototype.outputTxEnable=function(){this.$$outputTx||this.$$channelTransmitManager.getOutputNode().connect(c.getDestination()),this.$$outputTx=!0},u.prototype.outputTxDisable=function(){this.$$outputTx&&this.$$channelTransmitManager.getOutputNode().disconnect(c.getDestination()),this.$$outputTx=!1},u.prototype.outputMicrophoneEnable=function(){this.$$outputMicrophone||c.getMicrophoneNode().connect(c.getDestination()),this.$$outputMicrophone=!0},u.prototype.outputMicrophoneDisable=function(){this.$$outputMicrophone&&c.getMicrophoneNode().disconnect(c.getDestination()),this.$$outputMicrophone=!1},u.prototype.outputRecordedAudioEnable=function(){this.$$outputRecordedAudio||c.getRecordedAudioNode().connect(c.getDestination()),this.$$outputRecordedAudio=!0},u.prototype.outputRecordedAudioDisable=function(){this.$$outputRecordedAudio&&c.getRecordedAudioNode().disconnect(c.getDestination()),this.$$outputRecordedAudio=!1},u.prototype.getRxCpuLoadData=function(){return this.$$channelReceiveManager.getCpuLoadData()},u.prototype.getTxCpuLoadData=function(){return this.$$channelTransmitManager.getCpuLoadData()},u.prototype.getRxFrequency=function(e,t){return this.$$channelReceiveManager.getChannel(e).getFrequency(t)},u.prototype.getTxFrequency=function(e,t){return this.$$channelTransmitManager.getChannel(e).getFrequency(t)},u.prototype.setRxFrequency=function(e,t,i){this.$$channelReceiveManager.getChannel(e).setFrequency(t,i)},u.prototype.setTxFrequency=function(e,t,i){this.$$channelTransmitManager.getChannel(e).setFrequency(t,i)},u.prototype.getRxPhaseCorrection=function(e,t){return this.$$channelReceiveManager.getChannel(e).getRxPhaseCorrection(t)},u.prototype.getTxPhaseCorrection=function(e,t){return this.$$channelTransmitManager.getChannel(e).getTxPhaseCorrection(t)},u.prototype.setRxPhaseCorrection=function(e,t,i){this.$$channelReceiveManager.getChannel(e).setRxPhaseCorrection(t,i)},u.prototype.setTxPhaseCorrection=function(e,t,i){this.$$channelTransmitManager.getChannel(e).setTxPhaseCorrection(t,i)},u.prototype.getTxChannelSize=function(){return this.$$channelTransmitManager.getChannelSize()},u.prototype.getRxChannelSize=function(){return this.$$channelReceiveManager.getChannelSize()},u.prototype.getTxChannelOfdmSize=function(e){return this.$$channelTransmitManager.getChannel(e).getOfdmSize()},u.prototype.getRxChannelOfdmSize=function(e){return this.$$channelReceiveManager.getChannel(e).getOfdmSize()},u}AudioNetwork.Injector.registerFactory("PhysicalLayer.PhysicalLayer",e),e.$inject=["Common.QueueBuilder","Common.MathUtil","PhysicalLayer.DefaultConfig","PhysicalLayer.ConfigurationParser","PhysicalLayer.RxInput","PhysicalLayer.RxHandlerBuilder","PhysicalLayer.ChannelTransmitManagerBuilder","PhysicalLayer.ChannelReceiveManagerBuilder","Visualizer.ConstellationDiagramBuilder","Visualizer.AnalyserChartBuilder","Audio.ActiveAudioContext","Common.SimplePromiseBuilder"]}(),function(){function e(){return{MICROPHONE:"MICROPHONE",LOOPBACK:"LOOPBACK",RECORDED_AUDIO:"RECORDED_AUDIO"}}AudioNetwork.Injector.registerService("PhysicalLayer.RxInput",e),e.$inject=[]}(),function(){function e(){return{NO_INPUT:"NO_INPUT",IDLE_INIT:"IDLE_INIT",FIRST_SYNC_WAIT:"FIRST_SYNC_WAIT",FIRST_SYNC:"FIRST_SYNC",FATAL_ERROR:"FATAL_ERROR",IDLE:"IDLE",SYMBOL:"SYMBOL",SYNC:"SYNC",GUARD:"GUARD",ERROR:"ERROR"}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.ReceiveAdapterState",e),e.$inject=[]}(),function(){function e(n,o,r){var a;return(a=function(e){var t,i,r;for(this.$$physicalLayer=e,this.$$stateMachineManager=[],this.$$packetReceiveHandler=null,this.$$frequencyUpdateHandler=null,this.$$phaseCorrectionUpdateHandler=null,i=this.$$physicalLayer.getRxChannelSize(),t=0;t<i;t++)r=o.build(t,this.$$packetReceiveInternalHandler.bind(this),this.$$frequencyUpdateInternalHandler.bind(this),this.$$phaseCorrectionUpdateInternalHandler.bind(this)),this.$$stateMachineManager.push(r);this.setSymbolDuration(n.SYMBOL_DURATION),this.setGuardInterval(n.GUARD_INTERVAL),this.setSyncDuration(n.SYNC_DURATION),this.setSampleCollectionTimeIdleInitState(a.$$_SAMPLE_COLLECTION_TIME_IDLE_INIT_STATE),this.setSampleCollectionTimeFirstSyncState(a.$$_SAMPLE_COLLECTION_TIME_FIRST_SYNC_STATE),this.setSyncPreamble(n.SYNC_PREAMBLE),this.setPskSize(a.$$_ALL_CHANNEL,n.PSK_SIZE)}).$$_SAMPLE_COLLECTION_TIME_IDLE_INIT_STATE=n.SYNC_DURATION,a.$$_SAMPLE_COLLECTION_TIME_FIRST_SYNC_STATE=.85*n.SYNC_DURATION,a.$$_TIME_TOLERANCE_SYMBOL_DURATION_FACTOR=2.2,a.$$_TIME_TOLERANCE_GUARD_INTERVAL_FACTOR=1.1,a.$$_TIME_TOLERANCE_SYNC_DURATION_FACTOR=1.1,a.$$_ALL_CHANNEL=null,a.prototype.reset=function(e){return this.$$checkChannelIndexRange(e),this.$$stateMachineManager[e].reset()},a.prototype.setSymbolDuration=function(e){var t,i;for(t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setSymbolStateMaxDurationTime(e*a.$$_TIME_TOLERANCE_SYMBOL_DURATION_FACTOR)},a.prototype.setGuardInterval=function(e){var t,i;for(t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setGuardStateMaxDurationTime(e*a.$$_TIME_TOLERANCE_GUARD_INTERVAL_FACTOR)},a.prototype.setSyncDuration=function(e){var t,i;for(t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setSyncStateMaxDurationTime(e*a.$$_TIME_TOLERANCE_SYNC_DURATION_FACTOR)},a.prototype.setSampleCollectionTimeIdleInitState=function(e){var t,i;for(t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setSampleCollectionTimeIdleInitState(e)},a.prototype.setSampleCollectionTimeFirstSyncState=function(e){var t,i;for(t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setSampleCollectionTimeFirstSyncState(e)},a.prototype.setSyncPreamble=function(e){var t,i;for(e=!!e,t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setSyncPreamble(e)},a.prototype.setPskSize=function(e,t){var i,r;if(e===a.$$_ALL_CHANNEL)for(i=this.$$physicalLayer.getRxChannelSize(),r=0;r<i;r++)this.$$stateMachineManager[r].setPskSize(t);else this.$$checkChannelIndexRange(e),this.$$stateMachineManager[e].setPskSize(t)},a.prototype.$$packetReceiveInternalHandler=function(e,t){var i;for(i=0;i<t.length;i++)1===t[i].length&&(t[i]=t[i][0]);this.$$packetReceiveHandler&&this.$$packetReceiveHandler(e,t)},a.prototype.$$frequencyUpdateInternalHandler=function(e,t){var i;null!==t&&(.005<r.abs(t)&&(i=this.$$physicalLayer.getRxFrequency(e,0),console.log("phase history current",i),this.$$physicalLayer.setRxFrequency(e,0,i+t),console.log("Frequency corrected for channel "+e+" at ofdm 0: "+(i+t))),this.$$frequencyUpdateHandler&&this.$$frequencyUpdateHandler(e,t))},a.prototype.$$phaseCorrectionUpdateInternalHandler=function(e,t){var i,r;for(r=0;r<t.length;r++)i=this.$$physicalLayer.getRxPhaseCorrection(e,r),this.$$physicalLayer.setRxPhaseCorrection(e,r,i+t[r].phase),console.log("Phase corrected for channel "+e+" at ofdm "+r+": "+(i+t[r].phase));this.$$phaseCorrectionUpdateHandler&&this.$$phaseCorrectionUpdateHandler(e,t)},a.prototype.$$checkChannelIndexRange=function(e){if(e<0||e>=this.$$physicalLayer.getRxChannelSize())throw"Given channelIndex is outside range: "+e},a.prototype.setPacketReceiveHandler=function(e){this.$$packetReceiveHandler="function"==typeof e?e:null},a.prototype.setFrequencyUpdateHandler=function(e){this.$$frequencyUpdateHandler="function"==typeof e?e:null},a.prototype.setPhaseCorrectionUpdateHandler=function(e){this.$$phaseCorrectionUpdateHandler="function"==typeof e?e:null},a.prototype.receive=function(e,t,i){return this.$$checkChannelIndexRange(e),this.$$stateMachineManager[e].receive(t,i)},a}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.ReceiveAdapter",e),e.$inject=["PhysicalLayer.DefaultConfig","PhysicalLayerAdapter.RxStateMachineManagerBuilder","Common.MathUtil"]}(),function(){function e(h,u,p){var m;return(m=function(e){this.$$physicalLayer=e}).AMPLITUDE_DATA_LENGTH_DOES_NOT_MATCH_SYMBOL_LIST_LENGTH_EXCEPTION="Amplitude data length does not match symbol list length",m.$$_SYNCHRONIZATION_SYMBOL=0,m.$$_LOWEST_PSK_SIZE=1,m.$$_ZERO_GUARD_INTERVAL=0,m.$$_ZERO_INTERPACKET_GAP=0,m.$$_NO_SYNC_PREAMBLE=!1,m.$$_UNDEFINED_AMPLITUDE=void 0,m.prototype.symbol=function(e,t,i,r,n){var o,a=this.$$physicalLayer.getTxChannelOfdmSize(e),s=[];for(o=0;o<a;o++)s.push(o===t?i:null);s=[1===s.length?s[0]:s],this.packet(e,s,m.$$_NO_SYNC_PREAMBLE,r,u.valueOrDefault(n,p.SYMBOL_DURATION),m.$$_ZERO_GUARD_INTERVAL,m.$$_ZERO_INTERPACKET_GAP,m.$$_UNDEFINED_AMPLITUDE)},m.prototype.packet=function(e,t,i,r,n,o,a,s){var $,l,c=this.$$physicalLayer.getTxChannelOfdmSize(e);if(i=u.valueOrDefault(i,p.SYNC_PREAMBLE)){for($=[],l=0;l<c;l++)$.push(m.$$_SYNCHRONIZATION_SYMBOL);$=1===$.length?$[0]:$,t.unshift($)}if(void 0===s)for(s=[],l=0;l<c;l++)s.push(h.floor(1e3/c)/1e3);this.$$transmit(e,t,u.valueOrDefault(r,p.PSK_SIZE),u.valueOrDefault(n,p.SYMBOL_DURATION),u.valueOrDefault(o,p.GUARD_INTERVAL),u.valueOrDefault(a,p.INTERPACKET_GAP),s)},m.prototype.synchronization=function(e){var t,i=this.$$physicalLayer.getTxChannelOfdmSize(e),r=[],n=[];for(t=0;t<i;t++)r.push(m.$$_SYNCHRONIZATION_SYMBOL),n.push(h.floor(1e3/i)/1e3);r=[1===r.length?r[0]:r],this.$$transmit(e,r,m.$$_LOWEST_PSK_SIZE,p.SYNC_DURATION,m.$$_ZERO_GUARD_INTERVAL,p.INTERPACKET_GAP,n)},m.prototype.$$transmit=function(e,t,i,r,n,o,a){var s,$,l,c,h,u,p,d=this.$$physicalLayer.getTxChannelOfdmSize(e);for(l=[],u=0;u<t.length;u++){if((s=1===d&&"number"==typeof t[u]?[t[u]]:t[u]).length!==a.length)throw m.AMPLITUDE_DATA_LENGTH_DOES_NOT_MATCH_SYMBOL_LIST_LENGTH_EXCEPTION;for(c=[],p=0;p<s.length;p++)$=(h=null===s[p])?0:parseInt(s[p])%i,c.push({amplitude:h?0:a[p],duration:r,phase:$/i});if(l.push(c),0<n){for(c=[],p=0;p<s.length;p++)c.push({amplitude:0,duration:n});l.push(c)}}if(0<o&&s){for(c=[],p=0;p<s.length;p++)c.push({amplitude:0,duration:o});l.push(c)}for(u=0;u<l.length;u++)this.$$physicalLayer.tx(e,l[u])},m}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.TransmitAdapter",e),e.$inject=["Common.MathUtil","Common.Util","PhysicalLayer.DefaultConfig"]}(),function(){function e(o,a){var e;return(((e=function(e,t,i,r,n){o.call(this,e,t,i),this.$$colorAxis=a.valueOrDefault(r,"green"),this.$$colorCenteredCircle=a.valueOrDefault(n,"#DDD")}).prototype=Object.create(o.prototype)).constructor=e).prototype.$$drawCenteredCircle=function(e){var t=this.$$canvasContext,i=.5*this.$$width,r=.5*this.$$height;t.strokeStyle=this.$$colorCenteredCircle,t.beginPath(),t.arc(i,r,e,0,2*Math.PI,!1),t.stroke()},e.prototype.$$drawAxis=function(){var e=this.$$canvasContext,t=this.$$width,i=this.$$height,r=.5*t,n=.5*i;e.strokeStyle=this.$$colorAxis,e.beginPath(),e.moveTo(0,n),e.lineTo(t,n),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(r,0),e.lineTo(r,i),e.closePath(),e.stroke()},e.prototype.$$dropXYCache=function(){var e;for(e=0;e<this.$$queue.getSize();e++)delete this.$$queue.getItem(e).$$cache},e}AudioNetwork.Injector.registerFactory("Visualizer.Abstract2DVisualizer",e),e.$inject=["Visualizer.AbstractVisualizer","Common.Util"]}(),function(){function e(e){var t;return(t=function(e,t,i){this.$$parentElement=e,this.$$width=t,this.$$height=i,this.$$canvasContext=null,this.$$destroyPromise=null,this.$$parentElement.innerHTML=this.$$renderTemplate(),this.$$initCanvas(),requestAnimationFrame(this.$$animationFrameHandler.bind(this))}).ABSTRACT_METHOD_CALLED_EXCEPTION="Abstract method called!",t.prototype.destroy=function(){return this.$$destroyPromise||(this.$$destroyPromise=e.build()),this.$$destroyPromise},t.prototype.$$find=function(e){var t=this.$$parentElement.querySelectorAll(e);if(0===t.length)throw"Cannot $$find given selector";return t[0]},t.prototype.$$initCanvas=function(){var e=this.$$find("canvas");this.$$canvasContext=e.getContext("2d"),this.$$canvasContext.lineWidth=1},t.prototype.$$animationFrameHandler=function(){this.$$destroyPromise?(this.$$parentElement.innerHTML="",this.$$destroyPromise.resolve()):(this.$$canvasContext&&this.$$draw(),requestAnimationFrame(this.$$animationFrameHandler.bind(this)))},t.prototype.$$draw=function(){throw t.ABSTRACT_METHOD_CALLED_EXCEPTION},t.prototype.$$renderTemplate=function(){throw t.ABSTRACT_METHOD_CALLED_EXCEPTION},t}AudioNetwork.Injector.registerFactory("Visualizer.AbstractVisualizer",e),e.$inject=["Common.SimplePromiseBuilder"]}(),function(){function e(o){return{build:function(e,t,i,r,n){return new o(e,t,i,r,n)}}}AudioNetwork.Injector.registerService("Visualizer.AnalyserChartBuilder",e),e.$inject=["Visualizer.AnalyserChart"]}(),function(){function e(){return{html:'<span    style="        display: block;        box-sizing: border-box;        border-left: 1px solid {{ colorAxis }};        position: absolute;        width: {{ width }}px;        top: 0px;        left: {{ left }}px;        "    >    {{ label }}</span>'}}AudioNetwork.Injector.registerService("Visualizer.AnalyserChartTemplateAxisX",e),e.$inject=[]}(),function(){function e(){return{html:'<div    class="analyser-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas        class="analyser-chart"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas>    <div        class="analyser-action"        style="            position: absolute;        "        >        <a href="javascript:void(0)" class="analyser-action-fft256">FFT256</a>        <a href="javascript:void(0)" class="analyser-action-fft512">FFT512</a>        <a href="javascript:void(0)" class="analyser-action-fft1024">FFT1024</a>        <a href="javascript:void(0)" class="analyser-action-fft2048">FFT2048</a>        <a href="javascript:void(0)" class="analyser-action-fft4096">FFT4096</a>        <a href="javascript:void(0)" class="analyser-action-fft8192">FFT8192</a>        <a href="javascript:void(0)" class="analyser-action-fft16384">FFT16384</a>        <a href="javascript:void(0)" class="analyser-action-freq-timedomain">Freq/TimeDomain</a>        <a href="javascript:void(0)" class="analyser-action-freeze">Freeze</a>    </div>    <div         class="analyser-axis-x"         style="            position: absolute;            bottom: 0px;            left: 0px;            width: {{ width }}px;        "        ></div></div>'}}AudioNetwork.Injector.registerService("Visualizer.AnalyserChartTemplateMain",e),e.$inject=[]}(),function(){function e(n,t,e,s,$){var l;return(l=function(e,t,i,r,n){this.$$parentElement=e,this.$$analyser=t,this.$$canvas=null,this.$$canvasContext=null,this.$$canvasWidth=null,this.$$canvasHeight=i,this.$$colorData=r,this.$$colorAxis=n,this.$$data=null,this.$$freezeChart=!1,this.$$analyserMethod="getByteFrequencyData",this.$$destroyPromise=null,this.$$initAnimationFrame(),this.$$init()}).$$_AXIS_LABEL_X_ONE_ITEM_WITH=40,l.prototype.destroy=function(){return this.$$destroyPromise||(this.$$destroyPromise=e.build()),this.$$destroyPromise},l.prototype.$$init=function(){this.$$canvasContext=null,this.$$parentElement.innerHTML=this.$$renderTemplate(),this.$$connectTemplate(),this.$$initCanvasContext()},l.prototype.$$find=function(e){var t=this.$$parentElement.querySelectorAll(e);if(0===t.length)throw"Cannot $$find given selector";return t[0]},l.prototype.$$connectTemplate=function(){var e=this;this.$$canvas=this.$$find(".analyser-chart"),this.$$canvasContext=this.$$canvas.getContext("2d"),this.$$canvasWidth=this.$$analyser.fftSize,this.$$find(".analyser-action-freq-timedomain").addEventListener("click",function(){e.actionFrequencyTimeDomainToggle()}),this.$$find(".analyser-action-freeze").addEventListener("click",function(){e.actionFreezeChart()}),this.$$find(".analyser-action-fft256").addEventListener("click",function(){e.actionChangeFFTSize(256)}),this.$$find(".analyser-action-fft512").addEventListener("click",function(){e.actionChangeFFTSize(512)}),this.$$find(".analyser-action-fft1024").addEventListener("click",function(){e.actionChangeFFTSize(1024)}),this.$$find(".analyser-action-fft2048").addEventListener("click",function(){e.actionChangeFFTSize(2048)}),this.$$find(".analyser-action-fft4096").addEventListener("click",function(){e.actionChangeFFTSize(4096)}),this.$$find(".analyser-action-fft8192").addEventListener("click",function(){e.actionChangeFFTSize(8192)}),this.$$find(".analyser-action-fft16384").addEventListener("click",function(){e.actionChangeFFTSize(16384)})},l.prototype.actionFrequencyTimeDomainToggle=function(){"getByteFrequencyData"===this.$$analyserMethod?this.$$analyserMethod="getByteTimeDomainData":this.$$analyserMethod="getByteFrequencyData",this.$$generateAxisX()},l.prototype.actionFreezeChart=function(){this.$$freezeChart=!this.$$freezeChart},l.prototype.actionChangeFFTSize=function(e){this.$$analyser.fftSize=e,this.$$init()},l.prototype.$$renderTemplate=function(){var e=t.html;return e=(e=e.replace(/\{\{ width \}\}/g,this.$$analyser.frequencyBinCount.toString())).replace(/\{\{ height \}\}/g,this.$$canvasHeight.toString())},l.prototype.$$renderTemplateAxisXLabel=function(e,t,i){var r=n.html;return r=(r=(r=(r=r.replace(/\{\{ width \}\}/g,e)).replace(/\{\{ left \}\}/g,t)).replace(/\{\{ label \}\}/g,i)).replace(/\{\{ colorAxis \}\}/g,this.$$colorAxis)},l.prototype.$$generateAxisXForTimeDomain=function(){var e,t,i=[5e-4,.001,.002,.005,.01,.025,.05,.1,.25,.5],r=s.getSampleRate(),n=l.$$_AXIS_LABEL_X_ONE_ITEM_WITH/r,o=0,a="";for(t=0;t<i.length;t++)if(n<=i[t]||t==i.length-1){n=i[t];break}for(;o<this.$$analyser.frequencyBinCount/s.getSampleRate();)e=$.round(o*r),a+=this.$$renderTemplateAxisXLabel(l.$$_AXIS_LABEL_X_ONE_ITEM_WITH,e,$.round(1e3*o)+"ms"),o+=n;return a},l.prototype.$$generateAxisXForFrequency=function(){var e,t,i=[50,100,125,200,250,500,1e3,2e3,2500,5e3,1e4,2e4],r=this.$$analyser.fftSize/s.getSampleRate(),n=l.$$_AXIS_LABEL_X_ONE_ITEM_WITH/r,o=0,a="";for(t=0;t<i.length;t++)if(n<=i[t]||t==i.length-1){n=i[t];break}for(;o<.5*s.getSampleRate();)e=$.round(o*r),a+=this.$$renderTemplateAxisXLabel(l.$$_AXIS_LABEL_X_ONE_ITEM_WITH,e,o+"Hz"),o+=n;return a},l.prototype.$$generateAxisX=function(){var e=this.$$find(".analyser-axis-x");"getByteFrequencyData"==this.$$analyserMethod?e.innerHTML="<span>&nbsp;</span>"+this.$$generateAxisXForFrequency():e.innerHTML="<span>&nbsp;</span>"+this.$$generateAxisXForTimeDomain()},l.prototype.$$updateChart=function(){var e,t=this.$$data.length,i=this.$$canvasContext;if(null!==i&&!this.$$freezeChart)for(i.clearRect(0,0,this.$$canvasWidth,this.$$canvasHeight),this.$$analyser[this.$$analyserMethod](this.$$data),e=0;e<t;e++)i.beginPath(),i.moveTo(e,this.$$canvasHeight),i.lineTo(e,this.$$canvasHeight-$.round(this.$$canvasHeight*this.$$data[e]/255)),i.closePath(),i.stroke()},l.prototype.$$initCanvasContext=function(){this.$$data=new Uint8Array(this.$$analyser.frequencyBinCount),this.$$generateAxisX(),this.$$canvasContext.lineWidth=1,this.$$canvasContext.strokeStyle=this.$$colorData},l.prototype.$$initAnimationFrame=function(){var t=this;requestAnimationFrame(function e(){t.$$destroyPromise?(t.$$parentElement.innerHTML="",t.$$destroyPromise.resolve()):(t.$$updateChart(),requestAnimationFrame(e))})},l}AudioNetwork.Injector.registerFactory("Visualizer.AnalyserChart",e),e.$inject=["Visualizer.AnalyserChartTemplateAxisX","Visualizer.AnalyserChartTemplateMain","Common.SimplePromiseBuilder","Audio.ActiveAudioContext","Common.MathUtil"]}(),function(){function e(s){return{build:function(e,t,i,r,n,o,a){return new s(e,t,i,r,n,o,a)}}}AudioNetwork.Injector.registerService("Visualizer.ComplexPlaneChartBuilder",e),e.$inject=["Visualizer.ComplexPlaneChart"]}(),function(){function e(){return{html:'<div    class="complex-plane-chart-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas         class="complex-plane-chart"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas></div>'}}AudioNetwork.Injector.registerService("Visualizer.ComplexPlaneChartTemplateMain",e),e.$inject=[]}(),function(){function e(s,$,t){var p;return(((p=function(e,t,i,r,n,o,a){s.call(this,e,t,i,o,a),this.$$queue=r,this.$$maxValue=$.valueOrDefault(n,1),this.$$hashOnCanvas=null}).prototype=Object.create(s.prototype)).constructor=p).$$_VALUE_CIRCLE_STEP=1,p.prototype.setMaxValue=function(e){return this.$$maxValue!==e&&(this.$$maxValue=e,this.$$hashOnCanvas=null,this.$$dropXYCache(),!0)},p.prototype.$$renderTemplate=function(){var e=t.html;return e=(e=e.replace(/\{\{ width \}\}/g,this.$$width.toString())).replace(/\{\{ height \}\}/g,this.$$height.toString())},p.prototype.$$draw=function(){var e,t,i,r,n,o,a,s=this.$$canvasContext,$=this.$$width,l=this.$$height,c=.5*$,h=.5*l,u=this.$$queue;if(this.$$hashOnCanvas!==u.getHash()){for(s.clearRect(0,0,$,l),t=0;t<=this.$$maxValue;)i=h*this.$$getNormalizedValue(t),this.$$drawCenteredCircle(i),t+=p.$$_VALUE_CIRCLE_STEP;for(this.$$drawAxis(),a=s.lineWidth,o=0;o<u.getSize();o++)e=u.getItem(o),this.$$setItemXYCache(e),r=c+c*e.$$cache.x,n=h-h*e.$$cache.y,e.point&&(s.fillStyle=e.pointColor,s.beginPath(),s.arc(r,n,e.pointRadius,0,2*Math.PI,!1),s.fill()),e.line&&(s.lineWidth=e.lineWidth,s.strokeStyle=e.lineColor,s.beginPath(),s.moveTo(c,h),s.lineTo(r,n),s.closePath(),s.stroke());s.lineWidth=a,this.$$hashOnCanvas=u.getHash()}},p.prototype.$$setItemXYCache=function(e){e.$$cache||(e.$$cache={x:this.$$getNormalizedValue(e.real),y:this.$$getNormalizedValue(e.imm)})},p.prototype.$$getNormalizedValue=function(e){return e/this.$$maxValue},p}AudioNetwork.Injector.registerFactory("Visualizer.ComplexPlaneChart",e),e.$inject=["Visualizer.Abstract2DVisualizer","Common.Util","Visualizer.ComplexPlaneChartTemplateMain"]}(),function(){function e(c){return{build:function(e,t,i,r,n,o,a,s,$,l){return new c(e,t,i,r,n,o,a,s,$,l)}}}AudioNetwork.Injector.registerService("Visualizer.ConstellationDiagramBuilder",e),e.$inject=["Visualizer.ConstellationDiagram"]}(),function(){function e(){return{html:'<div    class="constellation-diagram-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas         class="constellation-diagram"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas></div>'}}AudioNetwork.Injector.registerService("Visualizer.ConstellationDiagramTemplateMain",e),e.$inject=[]}(),function(){function e(c,r,h,t){var y;return(((y=function(e,t,i,r,n,o,a,s,$,l){c.call(this,e,t,i,o,s),this.$$queue=r,this.$$colorHistoryPoint=h.valueOrDefault(a,{red:{newest:0,tailNewest:100,tailOldest:180},green:{newest:0,tailNewest:100,tailOldest:200},blue:{newest:0,tailNewest:100,tailOldest:150}}),this.$$radius=h.valueOrDefault($,2),this.$$radiusMain=h.valueOrDefault(l,3),this.$$powerDecibelMin=h.valueOrDefault(n,-40),this.$$hashOnCanvas=null}).prototype=Object.create(c.prototype)).constructor=y).$$_POWER_DECIBEL_AXIS_LINE_STEP=10,y.prototype.setPowerDecibelMin=function(e){return this.$$powerDecibelMin!==e&&(this.$$powerDecibelMin=e,this.$$hashOnCanvas=null,this.$$dropXYCache(),!0)},y.prototype.$$renderTemplate=function(){var e=t.html;return e=(e=e.replace(/\{\{ width \}\}/g,this.$$width.toString())).replace(/\{\{ height \}\}/g,this.$$height.toString())},y.prototype.$$draw=function(){var e,t,i,r,n,o,a,s,$,l=this.$$colorHistoryPoint,c=this.$$canvasContext,h=this.$$width,u=this.$$height,p=.5*h,d=.5*u,m=this.$$queue;if(this.$$hashOnCanvas!==m.getHash()){for(c.clearRect(0,0,h,u),t=0;t>=this.$$powerDecibelMin;)n=d*this.$$getNormalizedPowerDecibel(t),this.$$drawCenteredCircle(n),t-=y.$$_POWER_DECIBEL_AXIS_LINE_STEP;for(this.$$drawAxis(),s=0;s<m.getSize();s++)e=m.getItem(s),this.$$setItemXYCache(e),o=p+p*e.$$cache.x,a=d-d*e.$$cache.y,i=1-s/(m.getSize()-2),r=($=s===m.getSize()-1)?"rgba("+l.red.newest+", "+l.green.newest+", "+l.blue.newest+", 1)":"rgba("+this.$$colorInterpolate(l.red.tailNewest,l.red.tailOldest,i)+", "+this.$$colorInterpolate(l.green.tailNewest,l.green.tailOldest,i)+", "+this.$$colorInterpolate(l.blue.tailNewest,l.blue.tailOldest,i)+", 1)",c.fillStyle=r,c.beginPath(),c.arc(o,a,$?this.$$radiusMain:this.$$radius,0,2*Math.PI,!1),c.fill();this.$$hashOnCanvas=m.getHash()}},y.prototype.$$getNormalizedPowerDecibel=function(e){var t;return t=(t=1-(t=e/this.$$powerDecibelMin))<0?null:t},y.prototype.$$setItemXYCache=function(e){var t;e.$$cache||(t=this.$$getNormalizedPowerDecibel(e.powerDecibel),e.$$cache={x:null===t?0:t*r.sin(r.TWO_PI*e.phase),y:null===t?0:t*r.cos(r.TWO_PI*e.phase),outOfRange:null===t})},y.prototype.$$colorInterpolate=function(e,t,i){return r.round(e+(t-e)*i)},y}AudioNetwork.Injector.registerFactory("Visualizer.ConstellationDiagram",e),e.$inject=["Visualizer.Abstract2DVisualizer","Common.MathUtil","Common.Util","Visualizer.ConstellationDiagramTemplateMain"]}(),function(){function e(c){return{build:function(e,t,i,r,n,o,a,s,$,l){return new c(e,t,i,r,n,o,a,s,$,l)}}}AudioNetwork.Injector.registerService("Visualizer.FrequencyDomainChartBuilder",e),e.$inject=["Visualizer.FrequencyDomainChart"]}(),function(){function e(){return{html:'<div    class="frequency-domain-chart-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas         class="frequency-domain-chart"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas></div>'}}AudioNetwork.Injector.registerService("Visualizer.FrequencyDomainChartTemplateMain",e),e.$inject=[]}(),function(){function e(c,t,h){var l;return(((l=function(e,t,i,r,n,o,a,s,$,l){c.call(this,e,t,i),this.$$frequencyDomainQueue=r,this.$$powerDecibelMin=h.valueOrDefault(n,-40),this.$$radius=h.valueOrDefault(o,1.1),this.$$barWidth=h.valueOrDefault(a,1),this.$$barSpacingWidth=h.valueOrDefault(s,0),this.$$colorAxis=h.valueOrDefault($,"#EEE"),this.$$colorSample=h.valueOrDefault(l,"#738BD7"),this.$$checkWidth(),this.$$hashOnCanvas=null}).prototype=Object.create(c.prototype)).constructor=l).QUEUE_SIZE_NOT_MATCH_CHART_WIDTH="Queue size not match chart width",l.$$_POWER_DECIBEL_AXIS_LINE_STEP=10,l.prototype.setWidth=function(e){var t;return this.$$width!==e&&(this.$$width=e,this.$$checkWidth(),(t=this.$$find(".frequency-domain-chart-container")).style.width=e+"px",(t=this.$$find(".frequency-domain-chart")).style.width=e+"px",t.setAttribute("width",e),!(this.$$hashOnCanvas=null))},l.prototype.$$checkWidth=function(){if(this.$$frequencyDomainQueue.getSizeMax()*(this.$$barWidth+this.$$barSpacingWidth)!==this.$$width)throw l.QUEUE_SIZE_NOT_MATCH_CHART_WIDTH},l.prototype.$$renderTemplate=function(){var e=t.html;return e=(e=e.replace(/\{\{ width \}\}/g,this.$$width.toString())).replace(/\{\{ height \}\}/g,this.$$height.toString())},l.prototype.setPowerDecibelMin=function(e){return this.$$powerDecibelMin!==e&&(this.$$powerDecibelMin=e,!(this.$$hashOnCanvas=null))},l.prototype.$$draw=function(){var e,t,i,r,n,o=this.$$canvasContext,a=this.$$frequencyDomainQueue,s=this.$$width,$=this.$$height;if(this.$$hashOnCanvas!==a.getHash()){for(o.clearRect(0,0,s,$),o.strokeStyle=this.$$colorAxis,t=0;t<=-this.$$powerDecibelMin;t+=l.$$_POWER_DECIBEL_AXIS_LINE_STEP)r=t*$/-this.$$powerDecibelMin,o.beginPath(),o.moveTo(0,r),o.lineTo(s,r),o.closePath(),o.stroke();for(o.fillStyle=this.$$colorSample,n=.5*(this.$$barWidth-1),t=0;t<a.getSize();t++)e=a.getItem(t),i=t*(this.$$barWidth+this.$$barSpacingWidth),r=e/this.$$powerDecibelMin*$,1<=this.$$barSpacingWidth&&(o.beginPath(),o.moveTo(i,0),o.lineTo(i,$),o.closePath(),o.stroke()),$<=r||(o.beginPath(),o.arc(i+this.$$barSpacingWidth+n,r,this.$$radius,0,2*Math.PI,!1),o.fill());this.$$hashOnCanvas=a.getHash()}},l.prototype.$$initCanvasContext=function(){this.$$canvasContext.lineWidth=1},l}AudioNetwork.Injector.registerFactory("Visualizer.FrequencyDomainChart",e),e.$inject=["Visualizer.AbstractVisualizer","Visualizer.FrequencyDomainChartTemplateMain","Common.Util"]}(),function(){function e(r){return{build:function(e,t,i){return new r(e,t,i)}}}AudioNetwork.Injector.registerService("Visualizer.PowerChartBuilder",e),e.$inject=["Visualizer.PowerChart"]}(),function(){function e(){return{html:'<div    class="power-chart-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas         class="power-chart"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas></div>'}}AudioNetwork.Injector.registerService("Visualizer.PowerChartTemplateMain",e),e.$inject=[]}(),function(){function e(t,e){var i;return(i=function(e,t,i,r){this.$$parentElement=e,this.$$canvas=null,this.$$canvasContext=null,this.$$canvasWidth=t,this.$$canvasHeight=i,this.$$queue=r,this.$$destroyPromise=null,this.$$initAnimationFrame(),this.$$init()}).prototype.destroy=function(){return this.$$destroyPromise||(this.$$destroyPromise=e.build()),this.$$destroyPromise},i.prototype.$$init=function(){this.$$canvasContext=null,this.$$parentElement.innerHTML=this.$$renderTemplate(),this.$$connectTemplate(),this.$$initCanvasContext()},i.prototype.$$find=function(e){var t=this.$$parentElement.querySelectorAll(e);if(0===t.length)throw"Cannot $$find given selector";return t[0]},i.prototype.$$connectTemplate=function(){this.$$canvas=this.$$find(".power-chart"),this.$$canvasContext=this.$$canvas.getContext("2d")},i.prototype.$$renderTemplate=function(){var e=t.html;return e=(e=e.replace(/\{\{ width \}\}/g,this.$$canvasWidth.toString())).replace(/\{\{ height \}\}/g,this.$$canvasHeight.toString())},i.prototype.$$updateChart=function(){var e,t,i,r=this.$$canvasContext,n=this.$$queue,o=this.$$canvasWidth,a=this.$$canvasHeight;if(null!==r){for(r.clearRect(0,0,o,a),i=0;i<a;i+=10)r.strokeStyle="#EEE",r.beginPath(),r.moveTo(0,2*i),r.lineTo(o,2*i),r.closePath(),r.stroke();for(e=0;e<n.getSize();e++)t=e,i=-n.getItem(e),r.fillStyle="#738BD7",r.fillRect(t-1,2*i-1,3,3)}},i.prototype.$$initCanvasContext=function(){this.$$canvasContext.lineWidth=1},i.prototype.$$initAnimationFrame=function(){var t=this;requestAnimationFrame(function e(){t.$$destroyPromise?(t.$$parentElement.innerHTML="",t.$$destroyPromise.resolve()):(t.$$updateChart(),requestAnimationFrame(e))})},i}AudioNetwork.Injector.registerFactory("Visualizer.PowerChart",e),e.$inject=["Visualizer.PowerChartTemplateMain","Common.SimplePromiseBuilder"]}(),function(){function e(c){return{build:function(e,t,i,r,n,o,a,s,$,l){return new c(e,t,i,r,n,o,a,s,$,l)}}}AudioNetwork.Injector.registerService("Visualizer.SampleChartBuilder",e),e.$inject=["Visualizer.SampleChart"]}(),function(){function e(){return{html:'<div    class="sample-chart-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas         class="sample-chart"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas></div>'}}AudioNetwork.Injector.registerService("Visualizer.SampleChartTemplateMain",e),e.$inject=[]}(),function(){function e(c,t,h){var e;return(((e=function(e,t,i,r,n,o,a,s,$,l){c.call(this,e,t,i),this.$$queue=r,this.$$radius=h.valueOrDefault(n,1.1),this.$$barWidth=h.valueOrDefault(o,1),this.$$barSpacingWidth=h.valueOrDefault(a,0),this.$$colorAxis=h.valueOrDefault(s,"#EEE"),this.$$colorSample=h.valueOrDefault($,"rgba(115, 139, 215, 1.0"),this.$$colorBar=h.valueOrDefault(l,"rgba(115, 139, 215, 0.9)"),this.$$sampleBackgroundActive=!1,this.$$checkWidth(),this.$$hashOnCanvas=null}).prototype=Object.create(c.prototype)).constructor=e).QUEUE_SIZE_NOT_MATCH_CHART_WIDTH="Queue size not match chart width",e.prototype.setWidth=function(e){var t;return this.$$width!==e&&(this.$$width=e,this.$$checkWidth(),(t=this.$$find(".sample-chart-container")).style.width=e+"px",(t=this.$$find(".sample-chart")).style.width=e+"px",t.setAttribute("width",e),!(this.$$hashOnCanvas=null))},e.prototype.enableSampleBackground=function(){return!this.$$sampleBackgroundActive&&(this.$$sampleBackgroundActive=!0,!(this.$$hashOnCanvas=null))},e.prototype.$$checkWidth=function(){if(this.$$queue.getSizeMax()*(this.$$barWidth+this.$$barSpacingWidth)!==this.$$width)throw e.QUEUE_SIZE_NOT_MATCH_CHART_WIDTH},e.prototype.$$renderTemplate=function(){var e=t.html;return e=(e=e.replace(/\{\{ width \}\}/g,this.$$width.toString())).replace(/\{\{ height \}\}/g,this.$$height.toString())},e.prototype.$$draw=function(){var e,t,i,r,n,o=this.$$canvasContext,a=this.$$queue,s=this.$$width,$=this.$$height,l=.5*this.$$height;if(this.$$hashOnCanvas!==a.getHash()){for(o.clearRect(0,0,s,$),o.strokeStyle=this.$$colorAxis,o.beginPath(),o.moveTo(0,l),o.lineTo(s,l),o.closePath(),o.stroke(),n=.5*(this.$$barWidth-1),t=0;t<a.getSize();t++)e=a.getItem(t),i=t*(this.$$barWidth+this.$$barSpacingWidth),r=(.5-.5*e)*$,0<this.$$barSpacingWidth&&(1===this.$$barSpacingWidth?(o.strokeStyle=this.$$colorAxis,o.beginPath(),o.moveTo(i,0),o.lineTo(i,$),o.closePath(),o.stroke()):(o.fillStyle=this.$$colorAxis,o.fillRect(i,0,this.$$barSpacingWidth,$))),this.$$sampleBackgroundActive&&(1===this.$$barWidth?(o.strokeStyle=this.$$colorBar,o.beginPath(),o.moveTo(i+this.$$barSpacingWidth,l),o.lineTo(i+this.$$barSpacingWidth,r),o.closePath(),o.stroke()):(o.fillStyle=this.$$colorBar,o.fillRect(i+this.$$barSpacingWidth,l<r?l:r,this.$$barWidth,l<r?r-l:l-r))),o.fillStyle=this.$$colorSample,o.beginPath(),o.arc(i+this.$$barSpacingWidth+n,r,this.$$radius,0,2*Math.PI,!1),o.fill();this.$$hashOnCanvas=a.getHash()}},e.prototype.$$initCanvasContext=function(){this.$$canvasContext.lineWidth=1},e}AudioNetwork.Injector.registerFactory("Visualizer.SampleChart",e),e.$inject=["Visualizer.AbstractVisualizer","Visualizer.SampleChartTemplateMain","Common.Util"]}(),function(){function e(e){var t=null;function i(){null===t&&(t=e.build())}return{loadRecordedAudio:function(e){return i(),t.loadRecordedAudio(e)},getMicrophoneNode:function(){return i(),t.getMicrophoneNode()},getRecordedAudioNode:function(){return i(),t.getRecordedAudioNode()},getSampleRate:function(){return i(),t.getSampleRate()},getDestination:function(){return i(),t.getDestination()},getCurrentTime:function(){return i(),t.getCurrentTime()},createAnalyser:function(){return i(),t.createAnalyser()},createGain:function(){return i(),t.createGain()},createScriptProcessor:function(){return i(),t.createScriptProcessor()}}}AudioNetwork.Injector.registerService("Audio.ActiveAudioContext",e),e.$inject=["Audio.SimpleAudioContextBuilder"]}(),function(){function e(e){return{build:function(){return new e}}}AudioNetwork.Injector.registerService("Audio.SimpleAudioContextBuilder",e),e.$inject=["Audio.SimpleAudioContext"]}(),function(){function e(n){var e;return(e=function(){this.$$context=null,this.$$rawMicrophoneNode=null,this.$$microphoneNode=null,this.$$recordedNode=null,this.$$recordedRawNode=null,this.$$init()}).prototype.getCurrentTime=function(){return this.$$context.currentTime},e.prototype.createAnalyser=function(){return this.$$context.createAnalyser()},e.prototype.createGain=function(){return this.$$context.createGain()},e.prototype.createScriptProcessor=function(e,t,i){return this.$$context.createScriptProcessor(e,t,i)},e.prototype.getSampleRate=function(){return this.$$context.sampleRate},e.prototype.getDestination=function(){return this.$$context.destination},e.prototype.getMicrophoneNode=function(){return this.$$microphoneNode},e.prototype.getRecordedAudioNode=function(){return this.$$recordedNode},e.prototype.loadRecordedAudio=function(e){var t=this,i=new XMLHttpRequest,r=n.build();return i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){t.$$context.decodeAudioData(i.response,function(e){t.$$recordedRawNode&&t.$$recordedRawNode.disconnect(t.$$recordedNode),t.$$recordedRawNode=t.$$context.createBufferSource(),t.$$recordedRawNode.buffer=e,t.$$recordedRawNode.connect(t.$$recordedNode),t.$$recordedRawNode.loop=!0,t.$$recordedRawNode.start(0),r.resolve()},function(e){r.reject(e)})},i.send(),r},e.prototype.$$getConstraints=function(){return{video:!1,audio:{mandatory:{googEchoCancellation:!1,googAutoGainControl:!1,googNoiseSuppression:!1,googHighpassFilter:!1},optional:[]}}},e.prototype.$$normalizeGlobalVariable=function(){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia},e.prototype.$$init=function(){var t=this;this.$$normalizeGlobalVariable();try{this.$$context=new window.AudioContext}catch(e){alert("Web Audio API is not supported in this browser"),console.log(e)}this.$$microphoneNode=this.$$context.createGain(),this.$$recordedNode=this.$$context.createGain();try{navigator.getUserMedia(this.$$getConstraints(),function(e){t.$$rawMicrophoneNode=t.$$context.createMediaStreamSource(e),t.$$rawMicrophoneNode.connect(t.$$microphoneNode)},function(e){alert("Microphone initialization failed"),console.log(e)})}catch(e){alert("Microphone initialization failed"),console.log(e)}},e}AudioNetwork.Injector.registerFactory("Audio.SimpleAudioContext",e),e.$inject=["Common.SimplePromiseBuilder"]}(),function(){function e(){var e;return(e=function(){this.$$valueList=[],this.$$lastFinalizedSize=void 0,this.$$lastFinalizedResult=void 0}).ABSTRACT_METHOD_CALLED_EXCEPTION="Abstract method called!",e.prototype.collect=function(e){this.$$valueList.push(e)},e.prototype.hasAtLeastItem=function(){return 0<this.getSize()},e.prototype.getSize=function(){return this.$$valueList.length},e.prototype.clearAll=function(){this.clearList(),this.$$lastFinalizedSize=void 0,this.$$lastFinalizedResult=void 0},e.prototype.clearList=function(){this.$$valueList.length=0},e.prototype.finalize=function(){return this.$$lastFinalizedResult=this.$$finalize(),this.$$lastFinalizedSize=this.getSize(),this.clearList(),this.$$lastFinalizedResult},e.prototype.getLastFinalizedSize=function(){return this.$$lastFinalizedSize},e.prototype.getLastFinalizedResult=function(){return this.$$lastFinalizedResult},e.prototype.$$finalize=function(){throw e.ABSTRACT_METHOD_CALLED_EXCEPTION},e}AudioNetwork.Injector.registerFactory("Common.AbstractValueCollector",e),e.$inject=[]}(),function(){function e(e){return{build:function(){return new e}}}AudioNetwork.Injector.registerService("Common.AverageValueCollectorBuilder",e),e.$inject=["Common.AverageValueCollector"]}(),function(){function e(e,t){var i;return(((i=function(){e.apply(this,arguments)}).prototype=Object.create(e.prototype)).constructor=i).EMPTY_LIST_EXCEPTION="Cannot finalize AverageValueCollector without any samples collected",i.prototype.$$finalize=function(){if(0===this.$$valueList.length)throw i.EMPTY_LIST_EXCEPTION;return t.computeAverage(this.$$valueList)},i}AudioNetwork.Injector.registerFactory("Common.AverageValueCollector",e),e.$inject=["Common.AbstractValueCollector","Common.Util"]}(),function(){function e(t){return{build:function(e){return new t(e)}}}AudioNetwork.Injector.registerService("Common.CarrierGenerateBuilder",e),e.$inject=["Common.CarrierGenerate"]}(),function(){function e(n,o){var e;return(e=function(e,t){this.$$samplePerFade=t,this.$$queue=[],this.$$sampleComputed=null,this.$$currentCarrier={data:null,sampleNumberStart:null,sampleNumberEnd:null},this.$$samplePerPeriod=null,this.$$omega=null,this.$$sampleNumber=0,this.$$phaseCorrection=0,this.setSamplePerPeriod(e)}).prototype.$$sampleCompute=function(){var e,t,i,r=this.$$currentCarrier.data;r?(e=1,0<this.$$samplePerFade&&(t=(this.$$sampleNumber-this.$$currentCarrier.sampleNumberStart)/this.$$samplePerFade,i=(this.$$currentCarrier.sampleNumberEnd-this.$$sampleNumber)/this.$$samplePerFade,0<=t&&t<=1?e=o.unitFade(t):0<=i&&i<=1&&(e=o.unitFade(i))),this.$$sampleComputed=e*r.amplitude*n.sin(this.$$omega*this.$$sampleNumber-n.TWO_PI*(r.phase-this.$$phaseCorrection))):this.$$sampleComputed=0},e.prototype.$$grabCurrentCarrier=function(){var e;(e=o.queuePop(this.$$queue))?e===this.$$currentCarrier.data||(this.$$currentCarrier.data=e,this.$$currentCarrier.sampleNumberStart=this.$$sampleNumber,this.$$currentCarrier.sampleNumberEnd=this.$$currentCarrier.sampleNumberStart+e.duration):(this.$$currentCarrier.data=null,this.$$currentCarrier.sampleNumberStart=null,this.$$currentCarrier.sampleNumberEnd=null)},e.prototype.setPhaseCorrection=function(e){this.$$phaseCorrection=e},e.prototype.nextSample=function(){this.$$sampleNumber++,this.$$sampleComputed=null},e.prototype.getSample=function(){return this.$$sampleComputed||(this.$$grabCurrentCarrier(),this.$$sampleCompute()),this.$$sampleComputed},e.prototype.addToQueue=function(e){o.queueAdd(this.$$queue,e,function(e,t){e.amplitude=t.amplitude,e.phase=t.phase})},e.prototype.reset=function(){this.$$sampleNumber=0},e.prototype.setSamplePerPeriod=function(e){return e!==this.$$samplePerPeriod&&(this.$$samplePerPeriod=e,this.$$omega=n.TWO_PI/this.$$samplePerPeriod,!(this.$$sampleNumber=0))},e}AudioNetwork.Injector.registerFactory("Common.CarrierGenerate",e),e.$inject=["Common.MathUtil","Common.Util"]}(),function(){function e(i){return{build:function(e,t){return new i(e,t)}}}AudioNetwork.Injector.registerService("Common.CarrierRecoveryBuilder",e),e.$inject=["Common.CarrierRecovery"]}(),function(){function e(t,i,r,n){var e;return(e=function(e,t){this.$$samplePerDftWindow=void 0,this.$$complexQueue=void 0,this.$$complexQueueSum=void 0,this.setSamplePerDftWindow(t),this.$$samplePerPeriod=void 0,this.$$omega=void 0,this.$$sampleNumber=void 0,this.setSamplePerPeriod(e)}).prototype.$$getUnitComplex=function(){var e=this.$$omega*this.$$sampleNumber;return n.build(-i.cos(e),i.sin(e))},e.prototype.handleSample=function(e){var t,i;this.$$complexQueue.isFull()&&(t=this.$$complexQueue.pop(),this.$$complexQueueSum.sub(t)),(i=this.$$getUnitComplex()).mulScalar(e),this.$$complexQueue.push(i),this.$$complexQueueSum.add(i),this.$$sampleNumber++},e.prototype.getCarrierDetail=function(){var e=n.copy(this.$$complexQueueSum);return e.divScalar(this.$$complexQueue.getSize()),{phase:e.findUnitAngle(),powerDecibel:r.convertToDecibel(e.getAbsoluteValue())}},e.prototype.setSamplePerDftWindow=function(e){return e!==this.$$samplePerDftWindow&&(this.$$samplePerDftWindow=e,this.$$complexQueue=t.build(e),this.$$complexQueueSum=n.build(0,0),!0)},e.prototype.setSamplePerPeriod=function(e){return e!==this.$$samplePerPeriod&&(this.$$samplePerPeriod=e,this.$$omega=i.TWO_PI/this.$$samplePerPeriod,!(this.$$sampleNumber=0))},e}AudioNetwork.Injector.registerFactory("Common.CarrierRecovery",e),e.$inject=["Common.QueueBuilder","Common.MathUtil","Common.Util","Common.ComplexBuilder"]}(),function(){function e(i){return{build:function(e,t){return new i(e,t)},copy:function(e){return new i(e.real,e.imm)}}}AudioNetwork.Injector.registerService("Common.ComplexBuilder",e),e.$inject=["Common.Complex"]}(),function(){function e(e,t){var i;return(i=function(e,t){this.real=e,this.imm=t}).prototype.add=function(e){this.real+=e.real,this.imm+=e.imm},i.prototype.sub=function(e){this.real-=e.real,this.imm-=e.imm},i.prototype.mulScalar=function(e){this.real*=e,this.imm*=e},i.prototype.divScalar=function(e){this.real/=e,this.imm/=e},i.prototype.getAbsoluteValue=function(){return t.sqrt(this.real*this.real+this.imm*this.imm)},i.prototype.findUnitAngle=function(){return e.findUnitAngle(this.real,this.imm)},i}AudioNetwork.Injector.registerFactory("Common.Complex",e),e.$inject=["Common.Util","Common.MathUtil"]}(),function(){function e(t){return{build:function(e){return new t(e)}}}AudioNetwork.Injector.registerService("Common.QueueBuilder",e),e.$inject=["Common.Queue"]}(),function(){function e(e){var t;return(t=function(e){this.$$data=[],this.$$positionStart=null,this.$$positionEnd=null,this.$$size=null,this.$$hash=null,this.$$sizeMax=null,this.setSizeMax(e)}).prototype.$$generateNewHash=function(){this.$$hash=1e6*e.random()},t.prototype.setSizeMax=function(e){this.$$positionStart=0,this.$$positionEnd=0,this.$$size=0,this.$$hash=0,this.$$sizeMax=e,this.$$data.length=0,this.$$data.length=e},t.prototype.getHash=function(){return this.$$hash},t.prototype.push=function(e){return this.$$size!==this.$$sizeMax&&(this.$$data[this.$$positionEnd]=e,this.$$positionEnd=(this.$$positionEnd+1)%this.$$sizeMax,this.$$size++,this.$$generateNewHash(),!0)},t.prototype.pushEvenIfFull=function(e){this.isFull()&&this.pop(),this.push(e)},t.prototype.pop=function(){var e;return 0===this.$$size?null:(e=this.$$data[this.$$positionStart],this.$$positionStart=(this.$$positionStart+1)%this.$$sizeMax,this.$$size--,this.$$generateNewHash(),e)},t.prototype.getItem=function(e){return e>=this.$$size?null:this.$$data[(this.$$positionStart+e)%this.$$sizeMax]},t.prototype.getSize=function(){return this.$$size},t.prototype.getSizeMax=function(){return this.$$sizeMax},t.prototype.isFull=function(){return this.$$size===this.$$sizeMax},t}AudioNetwork.Injector.registerFactory("Common.Queue",e),e.$inject=["Common.MathUtil"]}(),function(){function e(n){function a(e,t){var i,r=t.split("."),n=e;if(e){for(i=0;i<r.length&&(n=n[r[i]]);i++);return n}}return{valueOrDefault:function(e,t){return void 0!==e?e:t},accessor:a,computeAverage:function(e){var t,i;if(!e||0===e.length)return 0;for(t=i=0;t<e.length;t++)i+=e[t];return i/e.length},convertToDecibel:function(e){return 10*n.log(e)/n.LN10},findUnitAngle:function(e,t){var i,r;switch(i=(i=n.sqrt(e*e+t*t))<1e-6?1e-6:i,0<=e?0<=t?0:1:t<0?2:3){case 0:r=n.asin(e/i);break;case 1:r=n.asin(-t/i)+n.HALF_PI;break;case 2:r=n.asin(-e/i)+n.PI;break;case 3:r=n.asin(t/i)+1.5*n.PI}return r/n.TWO_PI},unitFade:function(e){return e=1<(e=e<0?0:e)?1:e,.5*(n.sin((e-.5)*n.PI)+1)},queueAdd:function(e,t,i,r){var n;0<t[r=void 0===r?"duration":r]&&((n={})[r]=t[r],i(n,t),e.push(n))},queuePop:function(e,t){var i;return t=void 0===t?"duration":t,0===e.length?null:(e[0][t]--,i=e[0],0===e[0][t]&&e.splice(0,1),i)},findMaxValueIndex:function(e,t){var i,r,n=null,o=null;if(!e)return null;for(i=0;i<e.length;i++)r=a(e[i],t),(null===o||n<r)&&(n=r,o=i);return o}}}AudioNetwork.Injector.registerService("Common.Util",e),e.$inject=["Common.MathUtil"]}(),function(){function e(a){var e;return(e=function(){this.$$cpuLoadData={blockSampleSize:null,blockTime:null,blockRealTime:null,load:null}}).prototype.getCpuLoadData=function(){var e=this.$$cpuLoadData;return{blockSampleSize:e.blockSampleSize,blockTime:e.blockTime,blockRealTime:e.blockRealTime,load:e.load}},e.prototype.$$computeCpuLoadData=function(e,t,i){var r,n,o=this.$$cpuLoadData;r=t-e,n=i/a.getSampleRate(),o.blockSampleSize=i,o.blockTime=n,o.blockRealTime=r,o.load=r/n},e}AudioNetwork.Injector.registerFactory("PhysicalLayer.AbstractChannelManager",e),e.$inject=["Audio.ActiveAudioContext"]}(),function(){function e(i){return{build:function(e,t){return new i(e,t)}}}AudioNetwork.Injector.registerService("PhysicalLayer.ChannelReceiveBuilder",e),e.$inject=["PhysicalLayer.ChannelReceive"]}(),function(){function e(c,o,h){var t;return(t=function(e,t){this.$$carrierRecovery=[],this.$$carrierFrequency=[],this.$$carrierPhaseCorrection=[],this.$$notifyInterval=null,this.$$notifyHandler=null,this.$$index=e,this.configure(t)}).OFDM_INDEX_OUT_OF_RANGE_EXCEPTION="OFDM index out of range: ",t.prototype.configure=function(e){var t,i,r,n;for(t=0;t<e.ofdmSize;t++)n=e.baseFrequency+t*e.ofdmFrequencySpacing,r=c.getSampleRate()/n,i=o.build(r,e.dftWindowSize),this.$$carrierRecovery.push(i),this.$$carrierFrequency.push(n),this.$$carrierPhaseCorrection.push(0);this.$$notifyInterval=e.notifyInterval,this.$$notifyHandler=e.notifyHandler},t.prototype.$$checkOfdmIndex=function(e){if(e<0||e>=this.$$carrierRecovery.length)throw t.OFDM_INDEX_OUT_OF_RANGE_EXCEPTION+e},t.prototype.getOfdmSize=function(){return this.$$carrierRecovery.length},t.prototype.getRxPhaseCorrection=function(e){return this.$$checkOfdmIndex(e),this.$$carrierPhaseCorrection[e]},t.prototype.getFrequency=function(e){return this.$$checkOfdmIndex(e),this.$$carrierFrequency[e]},t.prototype.setRxPhaseCorrection=function(e,t){this.$$checkOfdmIndex(e),this.$$carrierPhaseCorrection[e]=t-h.floor(t)},t.prototype.setFrequency=function(e,t){var i;this.$$checkOfdmIndex(e),i=c.getSampleRate()/t,this.$$carrierRecovery[e].setSamplePerPeriod(i),this.$$carrierFrequency[e]=t},t.prototype.handleSample=function(e,t,i,r){var n,o,a,s,$,l;for((n=t%this.$$notifyInterval==0)&&($=[]),s=0;s<this.$$carrierRecovery.length;s++)(o=this.$$carrierRecovery[s]).handleSample(e),n&&((a=o.getCarrierDetail()).phase=a.phase-this.$$carrierPhaseCorrection[s],a.phase=a.phase-h.floor(a.phase),$.push(a));n&&(l=r/c.getSampleRate(),this.$$notifyHandler(this.$$index,$,i+l))},t.prototype.destroy=function(){this.$$carrierRecovery.length=0,this.$$carrierFrequency.length=0,this.$$carrierPhaseCorrection.length=0},t}AudioNetwork.Injector.registerFactory("PhysicalLayer.ChannelReceive",e),e.$inject=["Audio.ActiveAudioContext","Common.CarrierRecoveryBuilder","Common.MathUtil"]}(),function(){function e(i){return{build:function(e,t){return new i(e,t)}}}AudioNetwork.Injector.registerService("PhysicalLayer.ChannelReceiveManagerBuilder",e),e.$inject=["PhysicalLayer.ChannelReceiveManager"]}(),function(){function e(i,s,r){var n;return(((n=function(e,t){i.apply(this,arguments),this.$$channelReceive=[],this.$$scriptNode=null,this.$$analyserNode=null,this.$$configuration=e,this.$$bufferSize=t,this.$$sampleNumberGlobal=0,this.$$init()}).prototype=Object.create(i.prototype)).constructor=n).CHANNEL_INDEX_OUT_OF_RANGE_EXCEPTION="Channel index out of range: ",n.$$_LOWEST_FFT_SIZE=256,n.prototype.destroy=function(){var e;for(e=0;e<this.$$channelReceive.length;e++)this.$$channelReceive[e].destroy();this.$$channelReceive.length=0},n.prototype.getInputNode=function(){return this.$$scriptNode},n.prototype.getChannelSize=function(){return this.$$channelReceive.length},n.prototype.getChannel=function(e){if(e<0||e>=this.$$channelReceive.length)throw n.CHANNEL_INDEX_OUT_OF_RANGE_EXCEPTION+e;return this.$$channelReceive[e]},n.prototype.getBufferSize=function(){return this.$$scriptNode.bufferSize},n.prototype.$$init=function(){var e,t;for(this.$$scriptNode=s.createScriptProcessor(this.$$bufferSize,1,1),this.$$scriptNode.onaudioprocess=this.onAudioProcess.bind(this),this.$$analyserNode=s.createAnalyser(),this.$$analyserNode.fftSize=n.$$_LOWEST_FFT_SIZE,this.$$scriptNode.connect(this.$$analyserNode),e=0;e<this.$$configuration.length;e++)t=r.build(e,this.$$configuration[e]),this.$$channelReceive.push(t)},n.prototype.onAudioProcess=function(e){var t,i,r,n=e.inputBuffer,o=n.getChannelData(0),a=s.getCurrentTime();for(i=0;i<n.length;i++){for(t=o[i],r=0;r<this.$$channelReceive.length;r++)this.$$channelReceive[r].handleSample(t,this.$$sampleNumberGlobal,a,i);this.$$sampleNumberGlobal++}this.$$computeCpuLoadData(a,s.getCurrentTime(),n.length)},n}AudioNetwork.Injector.registerFactory("PhysicalLayer.ChannelReceiveManager",e),e.$inject=["PhysicalLayer.AbstractChannelManager","Audio.ActiveAudioContext","PhysicalLayer.ChannelReceiveBuilder"]}(),function(){function e(i){return{build:function(e,t){return new i(e,t)}}}AudioNetwork.Injector.registerService("PhysicalLayer.ChannelTransmitBuilder",e),e.$inject=["PhysicalLayer.ChannelTransmit"]}(),function(){function e(i,o,a){var r;return(r=function(e,t){this.$$carrierGenerate=[],this.$$carrierFrequency=[],this.$$carrierPhaseCorrection=[],this.$$index=e,this.configure(t)}).DATA_LENGTH_DOES_NOT_MATCH_OFDM_SIZE_EXCEPTION="Data array length does not match configured OFDM size",r.OFDM_INDEX_OUT_OF_RANGE_EXCEPTION="OFDM index out of range: ",r.prototype.addToQueue=function(e){var t;if(e.length!==this.$$carrierGenerate.length)throw r.DATA_LENGTH_DOES_NOT_MATCH_OFDM_SIZE_EXCEPTION;for(t=0;t<this.$$carrierGenerate.length;t++)this.$$carrierGenerate[t].addToQueue(e[t])},r.prototype.getOfdmSize=function(){return this.$$carrierGenerate.length},r.prototype.$$checkOfdmIndex=function(e){if(e<0||e>=this.$$carrierGenerate.length)throw r.OFDM_INDEX_OUT_OF_RANGE_EXCEPTION+e},r.prototype.getTxPhaseCorrection=function(e){return this.$$checkOfdmIndex(e),this.$$carrierPhaseCorrection[e]},r.prototype.getFrequency=function(e){return this.$$checkOfdmIndex(e),this.$$carrierFrequency[e]},r.prototype.setTxPhaseCorrection=function(e,t){this.$$checkOfdmIndex(e),this.$$carrierPhaseCorrection[e]=t-i.floor(t),this.$$carrierGenerate[e].setPhaseCorrection(this.$$carrierPhaseCorrection[e])},r.prototype.setFrequency=function(e,t){var i;this.$$checkOfdmIndex(e),i=o.getSampleRate()/t,this.$$carrierGenerate[e].setSamplePerPeriod(i),this.$$carrierFrequency[e]=t},r.prototype.configure=function(e){var t,i,r,n;for(t=0;t<e.ofdmSize;t++)n=e.baseFrequency+t*e.ofdmFrequencySpacing,r=o.getSampleRate()/n,i=a.build(r),this.$$carrierGenerate.push(i),this.$$carrierFrequency.push(n),this.$$carrierPhaseCorrection.push(0)},r.prototype.getSample=function(){var e,t,i;for(i=e=0;i<this.$$carrierGenerate.length;i++)e+=(t=this.$$carrierGenerate[i]).getSample(),t.nextSample();return e},r.prototype.destroy=function(){this.$$carrierGenerate.length=0,this.$$carrierFrequency.length=0,this.$$carrierPhaseCorrection.length=0},r}AudioNetwork.Injector.registerFactory("PhysicalLayer.ChannelTransmit",e),e.$inject=["Common.MathUtil","Audio.ActiveAudioContext","Common.CarrierGenerateBuilder"]}(),function(){function e(i){return{build:function(e,t){return new i(e,t)}}}AudioNetwork.Injector.registerService("PhysicalLayer.ChannelTransmitManagerBuilder",e),e.$inject=["PhysicalLayer.ChannelTransmitManager"]}(),function(){function e(i,s,$,l,r){var t;return(((t=function(e,t){i.apply(this,arguments),this.$$channelTransmit=[],this.$$scriptNode=null,this.$$configuration=e,this.$$bufferSize=t,this.$$fakeNoise=!1,this.$$init()}).prototype=Object.create(i.prototype)).constructor=t).CHANNEL_INDEX_OUT_OF_RANGE_EXCEPTION="Channel index out of range: ",t.prototype.destroy=function(){var e;for(e=0;e<this.$$channelTransmit.length;e++)this.$$channelTransmit[e].destroy();this.$$channelTransmit.length=0},t.prototype.getOutputNode=function(){return this.$$scriptNode},t.prototype.getChannelSize=function(){return this.$$channelTransmit.length},t.prototype.getChannel=function(e){if(e<0||e>=this.$$channelTransmit.length)throw t.CHANNEL_INDEX_OUT_OF_RANGE_EXCEPTION+e;return this.$$channelTransmit[e]},t.prototype.getBufferSize=function(){return this.$$scriptNode.bufferSize},t.prototype.$$init=function(){var e,t;for(this.$$scriptNode=$.createScriptProcessor(this.$$bufferSize,1,1),this.$$scriptNode.onaudioprocess=this.onAudioProcess.bind(this),e=0;e<this.$$configuration.length;e++)t=r.build(e,this.$$configuration[e]),this.$$channelTransmit.push(t)},t.prototype.enableFakeNoise=function(){this.$$fakeNoise=!0},t.prototype.disableFakeNoise=function(){this.$$fakeNoise=!1},t.prototype.onAudioProcess=function(e){var t,i,r,n=e.outputBuffer,o=n.getChannelData(0),a=$.getCurrentTime();for(i=0;i<n.length;i++){for(r=t=0;r<this.$$channelTransmit.length;r++)t+=this.$$channelTransmit[r].getSample();this.$$fakeNoise&&(t+=(2*s.random()-1)*l.FAKE_NOISE_MAX_AMPLITUDE),o[i]=t}this.$$computeCpuLoadData(a,$.getCurrentTime(),n.length)},t}AudioNetwork.Injector.registerFactory("PhysicalLayer.ChannelTransmitManager",e),e.$inject=["PhysicalLayer.AbstractChannelManager","Common.MathUtil","Audio.ActiveAudioContext","PhysicalLayer.DefaultConfig","PhysicalLayer.ChannelTransmitBuilder"]}(),function(){function e(i){return{build:function(e,t){return new i(e,t)}}}AudioNetwork.Injector.registerService("PhysicalLayer.RxHandlerBuilder",e),e.$inject=["PhysicalLayer.RxHandler"]}(),function(){function e(o,a,e){var n;return(n=function(e,t){this.$$delayedData=[],this.$$rxConstellationDiagram=e,this.$$rxExternalHandler=t,this.$$intervalId=setInterval(this.$$intervalHandler.bind(this),n.$$_DELAY_LOOP_RESOLUTION)}).$$_RX_EXTRA_DELAY=.05,n.$$_DELAY_LOOP_RESOLUTION=8,n.prototype.$$intervalHandler=function(){var e,t,i=a.getCurrentTime(),r=0;for(t=0;t<this.$$delayedData.length&&(e=this.$$delayedData[t]).time<i-n.$$_RX_EXTRA_DELAY;t++)this.$$handle(e.channelIndex,e.carrierDetail,e.time),r++;0<r&&this.$$delayedData.splice(0,r)},n.prototype.handle=function(e,t,i){this.$$delayedData.push({channelIndex:e,carrierDetail:t,time:i})},n.prototype.$$handle=function(e,t,i){var r,n;for(r=0;r<t.length;r++)(n=t[r]).powerDecibel===-1/0&&(n.powerDecibel=o.MINIMUM_POWER_DECIBEL),n.powerDecibel=n.powerDecibel<o.MINIMUM_POWER_DECIBEL?o.MINIMUM_POWER_DECIBEL:n.powerDecibel,0!==this.$$rxConstellationDiagram.length&&this.$$rxConstellationDiagram[e].queue[r].pushEvenIfFull({powerDecibel:n.powerDecibel,phase:n.phase});this.$$rxExternalHandler.callback&&this.$$rxExternalHandler.callback(e,t,a.getCurrentTime())},n.prototype.destroy=function(){clearInterval(this.$$intervalId)},n}AudioNetwork.Injector.registerFactory("PhysicalLayer.RxHandler",e),e.$inject=["PhysicalLayer.DefaultConfig","Audio.ActiveAudioContext","Common.MathUtil"]}(),function(){function e(e){return{build:function(){return new e}}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.GuardPowerCollectorBuilder",e),e.$inject=["PhysicalLayerAdapter.GuardPowerCollector"]}(),function(){function e(e,t){var i;return(((i=function(){e.apply(this,arguments)}).prototype=Object.create(e.prototype)).constructor=i).EMPTY_LIST_EXCEPTION="Cannot finalize GuardPowerCollector without any samples collected",i.prototype.$$finalize=function(){if(0===this.$$valueList.length)throw i.EMPTY_LIST_EXCEPTION;return t.minInArray(this.$$valueList)},i}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.GuardPowerCollector",e),e.$inject=["Common.AbstractValueCollector","Common.MathUtil"]}(),function(){function e(e){return{build:function(){return new e}}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.PhaseOffsetCollectorBuilder",e),e.$inject=["PhysicalLayerAdapter.PhaseOffsetCollector"]}(),function(){function e(e,n){var t;return(((t=function(){e.apply(this,arguments)}).prototype=Object.create(e.prototype)).constructor=t).prototype.$$finalize=function(){var e,t,i,r;if(0===this.$$valueList.length)return null;for(e=0;e<this.$$valueList.length;e++)n.round(1e3*this.$$valueList[e].time)/1e3+" "+n.round(1e3*this.$$valueList[e].phase)/1e3+" | ";return r=0,(t=n.round(.43*this.$$valueList.length))!==(i=(i=n.round(.57*this.$$valueList.length))>=this.$$valueList.length?this.$$valueList.length-1:i)&&t<i&&(console.log("phase history indexA",this.$$valueList[t].time,this.$$valueList[t].phase),console.log("phase history indexB",this.$$valueList[i].time,this.$$valueList[i].phase),r=-(this.$$valueList[i].phase-this.$$valueList[t].phase)/(this.$$valueList[i].time-this.$$valueList[t].time),console.log("phase history drift",r)),r},t.prototype.collect=function(e){this.$$valueList.push({time:e.stateDurationTime,phase:e.carrierDetail[0].phase})},t}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.PhaseOffsetCollector",e),e.$inject=["Common.AbstractValueCollector","Common.MathUtil"]}(),function(){function e(l){return{build:function(e,t,i,r,n,o,a,s,$){return new l(e,t,i,r,n,o,a,s,$)}}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.RxStateMachineBuilder",e),e.$inject=["PhysicalLayerAdapter.RxStateMachine"]}(),function(){function e(l){var n;return(n=function(e,t,i,r,n,o,a,s,$){this.$$stateHandler={},this.$$stateHandler[l.IDLE_INIT]=e,this.$$stateHandler[l.FIRST_SYNC_WAIT]=t,this.$$stateHandler[l.FIRST_SYNC]=i,this.$$stateHandler[l.FATAL_ERROR]=r,this.$$stateHandler[l.IDLE]=n,this.$$stateHandler[l.SYMBOL]=o,this.$$stateHandler[l.SYNC]=a,this.$$stateHandler[l.GUARD]=s,this.$$stateHandler[l.ERROR]=$,this.$$symbolStateMaxDurationTime=null,this.$$guardStateMaxDurationTime=null,this.$$syncStateMaxDurationTime=null,this.$$state=null,this.$$stateDurationTime=null,this.$$stateBeginTime=null,this.$$resetFlag=!0}).SET_ALL_MAX_DURATION_TIMES_FIRST_EXCEPTION="Please set all max duration times first",n.prototype.scheduleReset=function(){this.$$resetFlag=!0},n.prototype.$$changeState=function(e,t){null!==e?(this.$$state=e,this.$$stateBeginTime=t):this.$$stateDurationTime=t-this.$$stateBeginTime},n.prototype.$$handlerIdleInit=function(e,t){var i;return this.$$changeState(null,t),!(i=this.$$stateHandler[l.IDLE_INIT](this.$$stateDurationTime))||(this.$$changeState(i,t),!1)},n.prototype.$$handlerFirstSyncWait=function(e,t){return e?(this.$$changeState(l.FIRST_SYNC,t),!1):(this.$$changeState(null,t),this.$$stateHandler[l.FIRST_SYNC_WAIT](this.$$stateDurationTime),!0)},n.prototype.$$handlerFirstSync=function(e,t){var i;return this.$$changeState(null,t),!(i=this.$$stateHandler[l.FIRST_SYNC](this.$$stateDurationTime))||(this.$$changeState(i,t),!1)},n.prototype.$$handlerFatalError=function(e,t){var i;return this.$$changeState(null,t),!(i=this.$$stateHandler[l.FATAL_ERROR](this.$$stateDurationTime))||(this.$$changeState(i,t),!1)},n.prototype.$$handlerIdle=function(e,t){return e?(this.$$changeState(l.SYMBOL,t),!1):(this.$$changeState(null,t),this.$$stateHandler[l.IDLE](this.$$stateDurationTime),!0)},n.prototype.$$handlerSymbol=function(e,t){return e?(this.$$changeState(null,t),this.$$stateHandler[l.SYMBOL](this.$$stateDurationTime),!(this.$$stateDurationTime>this.$$symbolStateMaxDurationTime)||(this.$$changeState(l.SYNC,t),!1)):(this.$$changeState(l.GUARD,t),!1)},n.prototype.$$handlerSync=function(e,t){return e?(this.$$changeState(null,t),this.$$stateHandler[l.SYNC](this.$$stateDurationTime),!(this.$$stateDurationTime>this.$$syncStateMaxDurationTime)||(this.$$changeState(l.ERROR,t),!1)):(this.$$changeState(l.IDLE,t),!1)},n.prototype.$$handlerGuard=function(e,t){return e?(this.$$changeState(l.SYMBOL,t),!1):(this.$$changeState(null,t),this.$$stateHandler[l.GUARD](this.$$stateDurationTime),!(this.$$stateDurationTime>this.$$guardStateMaxDurationTime)||(this.$$changeState(l.IDLE,t),!1))},n.prototype.$$handlerError=function(e,t){return e?(this.$$changeState(null,t),this.$$stateHandler[l.ERROR](this.$$stateDurationTime),!0):(this.$$changeState(l.IDLE,t),!1)},n.prototype.setGuardStateMaxDurationTime=function(e){this.$$guardStateMaxDurationTime=e},n.prototype.setSymbolStateMaxDurationTime=function(e){this.$$symbolStateMaxDurationTime=e},n.prototype.setSyncStateMaxDurationTime=function(e){this.$$syncStateMaxDurationTime=e},n.prototype.getState=function(e,t){var i,r=l;if(this.$$resetFlag&&(this.$$changeState(r.IDLE_INIT,t),this.$$resetFlag=!1),null===this.$$guardStateMaxDurationTime||null===this.$$symbolStateMaxDurationTime||null===this.$$syncStateMaxDurationTime)throw n.SET_ALL_MAX_DURATION_TIMES_FIRST_EXCEPTION;for(;;){switch(this.$$state){case r.IDLE_INIT:i=this.$$handlerIdleInit(e,t);break;case r.FIRST_SYNC_WAIT:i=this.$$handlerFirstSyncWait(e,t);break;case r.FIRST_SYNC:i=this.$$handlerFirstSync(e,t);break;case r.FATAL_ERROR:i=this.$$handlerFatalError(e,t);break;case r.IDLE:i=this.$$handlerIdle(e,t);break;case r.SYMBOL:i=this.$$handlerSymbol(e,t);break;case r.SYNC:i=this.$$handlerSync(e,t);break;case r.GUARD:i=this.$$handlerGuard(e,t);break;case r.ERROR:i=this.$$handlerError(e,t)}if(i)break}return this.$$state},n}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.RxStateMachine",e),e.$inject=["PhysicalLayerAdapter.ReceiveAdapterState"]}(),function(){function e(n){return{build:function(e,t,i,r){return new n(e,t,i,r)}}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.RxStateMachineManagerBuilder",e),e.$inject=["PhysicalLayerAdapter.RxStateMachineManager"]}(),function(){function e(a,r,n,e,o,s,$,l,c){var h;return(h=function(e,t,i,r){this.$$channelIndex=e,this.$$packetReceiveHandler=t,this.$$frequencyUpdateHandler=i,this.$$phaseCorrectionUpdateHandler=r,this.$$stateMachine=l.build(this.$$handlerIdleInit.bind(this),this.$$handlerFirstSyncWait.bind(this),this.$$handlerFirstSync.bind(this),this.$$handlerFatalError.bind(this),this.$$handlerIdle.bind(this),this.$$handlerSymbol.bind(this),this.$$handlerSync.bind(this),this.$$handlerGuard.bind(this),this.$$handlerError.bind(this)),this.$$sampleCollectionTimeIdleInitState=null,this.$$sampleCollectionTimeFirstSyncState=null,this.$$syncPreamble=null,this.$$pskSize=null,this.$$averageIdlePowerCollector=n.build(),this.$$averageFirstSyncPowerCollector=n.build(),this.$$signalPowerCollector=o.build(),this.$$guardPowerCollector=s.build(),this.$$phaseOffsetCollector=$.build(),this.$$resetInternal()}).$$_INITIAL_POWER_THRESHOLD=0,h.$$_DECIBLES_ABOVE_AVERAGE_IDLE=10,h.$$_OFDM_PILOT_SIGNAL_INDEX=0,h.$$_AVERAGE_POWER_UNIT_FACTOR=.5,h.prototype.$$resetInternal=function(){this.$$averageIdlePowerCollector.clearAll(),this.$$averageFirstSyncPowerCollector.clearAll(),this.$$signalPowerCollector.clearAll(),this.$$guardPowerCollector.clearAll(),this.$$phaseOffsetCollector.clearAll(),this.$$powerThreshold=h.$$_INITIAL_POWER_THRESHOLD,this.$$currentData=null,this.$$dataPacket=[],this.$$dataSymbol=[]},h.prototype.reset=function(){this.$$resetInternal(),this.$$stateMachine.scheduleReset()},h.prototype.setSymbolStateMaxDurationTime=function(e){this.$$stateMachine.setSymbolStateMaxDurationTime(e)},h.prototype.setGuardStateMaxDurationTime=function(e){this.$$stateMachine.setGuardStateMaxDurationTime(e)},h.prototype.setSyncStateMaxDurationTime=function(e){this.$$stateMachine.setSyncStateMaxDurationTime(e)},h.prototype.setSampleCollectionTimeIdleInitState=function(e){this.$$sampleCollectionTimeIdleInitState=e},h.prototype.setSampleCollectionTimeFirstSyncState=function(e){this.$$sampleCollectionTimeFirstSyncState=e},h.prototype.setSyncPreamble=function(e){this.$$syncPreamble=e},h.prototype.setPskSize=function(e){this.$$pskSize=e},h.prototype.$$handlerIdleInit=function(e){var t=this.$$currentData.pilotSignal.powerDecibel,i=null;if(e<this.$$sampleCollectionTimeIdleInitState)this.$$averageIdlePowerCollector.collect(t);else try{this.$$powerThreshold=this.$$averageIdlePowerCollector.finalize()+h.$$_DECIBLES_ABOVE_AVERAGE_IDLE,i=c.FIRST_SYNC_WAIT}catch(e){i=c.FATAL_ERROR}return i},h.prototype.$$handlerFirstSyncWait=function(e){return null},h.prototype.$$handlerFirstSync=function(e){var t,i,r=this.$$currentData.pilotSignal.powerDecibel;if(this.$$averageFirstSyncPowerCollector.getLastFinalizedResult())return r<this.$$powerThreshold?c.IDLE:null;if(r<=this.$$averageIdlePowerCollector.getLastFinalizedResult())return c.FATAL_ERROR;if(e<this.$$sampleCollectionTimeFirstSyncState)this.$$phaseOffsetCollector.collect({stateDurationTime:e,carrierDetail:this.$$currentData.carrierDetail}),this.$$averageFirstSyncPowerCollector.collect(r);else try{i=this.$$averageFirstSyncPowerCollector.finalize()-(t=this.$$averageIdlePowerCollector.getLastFinalizedResult()),this.$$powerThreshold=t+h.$$_AVERAGE_POWER_UNIT_FACTOR*i}catch(e){return c.FATAL_ERROR}},h.prototype.$$handlerFatalError=function(e){},h.prototype.$$handlerIdle=function(e){0<this.$$dataPacket.length&&(this.$$packetReceiveHandler(this.$$channelIndex,this.$$preparePacket(this.$$dataPacket)),this.$$dataPacket.length=0),this.$$phaseOffsetCollector.hasAtLeastItem()&&this.$$frequencyUpdateHandler(this.$$channelIndex,this.$$phaseOffsetCollector.finalize()),this.$$guardPowerCollector.clearList()},h.prototype.$$handlerSymbol=function(e){var t=this.$$currentData.pilotSignal.powerDecibel;this.$$signalPowerCollector.collect(t),this.$$guardPowerCollector.hasAtLeastItem()&&this.$$guardPowerCollector.finalize(),this.$$dataSymbol.push(this.$$currentData)},h.prototype.$$handlerSync=function(e){this.$$phaseOffsetCollector.collect({stateDurationTime:e,carrierDetail:this.$$currentData.carrierDetail})},h.prototype.$$handlerGuard=function(e){var t,i=this.$$currentData.pilotSignal.powerDecibel;this.$$guardPowerCollector.collect(i),this.$$signalPowerCollector.hasAtLeastItem()&&this.$$signalPowerCollector.finalize(),0<this.$$dataSymbol.length&&(t=r.findMaxValueIndex(this.$$dataSymbol,"pilotSignal.powerDecibel"),this.$$dataPacket.push(this.$$dataSymbol[t].carrierDetail),this.$$isCurrentSymbolSyncPreamble()&&this.$$phaseCorrectionUpdateHandler(this.$$channelIndex,this.$$dataSymbol[t].carrierDetail),this.$$dataSymbol=[])},h.prototype.$$handlerError=function(e){},h.prototype.$$preparePacket=function(e){var t,i,r,n,o;for(r=[],t=0;t<e.length;t++)if(0!==t||!this.$$syncPreamble){for(o=e[t],n=[],i=0;i<o.length;i++)n.push(a.round(o[i].phase*this.$$pskSize)%this.$$pskSize);r.push(n)}return r},h.prototype.$$isCurrentSymbolSyncPreamble=function(){return this.$$syncPreamble&&1===this.$$dataPacket.length},h.prototype.$$isInputReallyConnected=function(){return this.$$currentData.pilotSignal.powerDecibel!==e.MINIMUM_POWER_DECIBEL},h.prototype.$$isPilotSignalPresent=function(){return this.$$currentData.pilotSignal.powerDecibel>this.$$powerThreshold},h.prototype.receive=function(e,t){var i;return this.$$currentData={pilotSignal:e[h.$$_OFDM_PILOT_SIGNAL_INDEX],carrierDetail:e},this.$$isInputReallyConnected()?i=this.$$stateMachine.getState(this.$$isPilotSignalPresent(),t):(i=c.NO_INPUT,this.reset()),{state:i,power:"<br/>averageIdlePower: "+a.round(100*this.$$averageIdlePowerCollector.getLastFinalizedResult())/100+"<br/>averageFirstSyncPower: "+a.round(100*this.$$averageFirstSyncPowerCollector.getLastFinalizedResult())/100+" <br/>&nbsp;&nbsp;&nbsp;delta: "+a.round(100*(this.$$averageFirstSyncPowerCollector.getLastFinalizedResult()-this.$$averageIdlePowerCollector.getLastFinalizedResult()))/100+" <br/>&nbsp;&nbsp;&nbsp;powerThreshold: "+a.round(100*this.$$powerThreshold)/100+" <br/>minGuardPower: "+a.round(100*this.$$guardPowerCollector.getLastFinalizedResult())/100+" sampleSize: "+this.$$guardPowerCollector.getLastFinalizedSize()+"<br/>maxSignalPower: "+a.round(100*this.$$signalPowerCollector.getLastFinalizedResult())/100+" sampleSize: "+this.$$signalPowerCollector.getLastFinalizedSize()+"<br/>&nbsp;&nbsp;&nbsp;delta: "+a.round(100*(this.$$signalPowerCollector.getLastFinalizedResult()-this.$$guardPowerCollector.getLastFinalizedResult()))/100+" <br/>&nbsp;&nbsp;&nbsp;idealPowerThreshold: "+a.round(.5*(this.$$signalPowerCollector.getLastFinalizedResult()+this.$$guardPowerCollector.getLastFinalizedResult())*100)/100+" <br/>"}},h}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.RxStateMachineManager",e),e.$inject=["Common.MathUtil","Common.Util","Common.AverageValueCollectorBuilder","PhysicalLayer.DefaultConfig","PhysicalLayerAdapter.SignalPowerCollectorBuilder","PhysicalLayerAdapter.GuardPowerCollectorBuilder","PhysicalLayerAdapter.PhaseOffsetCollectorBuilder","PhysicalLayerAdapter.RxStateMachineBuilder","PhysicalLayerAdapter.ReceiveAdapterState"]}(),function(){function e(e){return{build:function(){return new e}}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.SignalPowerCollectorBuilder",e),e.$inject=["PhysicalLayerAdapter.SignalPowerCollector"]}(),function(){function e(e,t){var i;return(((i=function(){e.apply(this,arguments)}).prototype=Object.create(e.prototype)).constructor=i).EMPTY_LIST_EXCEPTION="Cannot finalize SignalPowerCollector without any samples collected",i.prototype.$$finalize=function(){if(0===this.$$valueList.length)throw i.EMPTY_LIST_EXCEPTION;return t.maxInArray(this.$$valueList)},i}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.SignalPowerCollector",e),e.$inject=["Common.AbstractValueCollector","Common.MathUtil"]}(),function(){function e(){return{LN10:Math.LN10,HALF_PI:.5*Math.PI,TWO_PI:2*Math.PI,PI:Math.PI,abs:function(e){return Math.abs(e)},floor:function(e){return Math.floor(e)},asin:function(e){return Math.asin(e)},sqrt:function(e){return Math.sqrt(e)},round:function(e){return Math.round(e)},random:function(){return Math.random()},sin:function(e){return Math.sin(e)},cos:function(e){return Math.cos(e)},log:function(e){return Math.log(e)},minInArray:function(e){return Math.min.apply(null,e)},maxInArray:function(e){return Math.max.apply(null,e)}}}AudioNetwork.Injector.registerService("Common.MathUtil",e),e.$inject=[]}(),function(){function e(e){function o(){return new e}return{build:o,buildFromList:function(e){var t,i,r,n;for(i=o(),t=n=r=0;t<e.length;t++)e[t].then(function(){r++}).catch(function(){n++}).finally(function(){r+n===e.length&&(0===n?i.resolve():i.reject())});return i}}}AudioNetwork.Injector.registerService("Common.SimplePromiseBuilder",e),e.$inject=["Common.SimplePromise"]}(),function(){function e(){var t;return(t=function(){this.$$state=null,this.$$value=void 0,this.$$then=null,this.$$catch=null,this.$$finally=null}).$$STATE_RESOLVE=0,t.$$STATE_REJECT=1,t.prototype.$$callbackInvoke=function(){switch(this.$$state){case t.$$STATE_RESOLVE:this.$$then&&(this.$$then(this.$$value),this.$$then=null),this.$$finally&&(this.$$finally(this.$$value),this.$$finally=null);break;case t.$$STATE_REJECT:this.$$catch&&(this.$$catch(this.$$value),this.$$catch=null),this.$$finally&&(this.$$finally(this.$$value),this.$$finally=null)}},t.prototype.resolve=function(e){null===this.$$state&&(this.$$state=t.$$STATE_RESOLVE,this.$$value=e,this.$$callbackInvoke())},t.prototype.reject=function(e){null===this.$$state&&(this.$$state=t.$$STATE_REJECT,this.$$value=e,this.$$callbackInvoke())},t.prototype.then=function(e){return"function"==typeof e&&(this.$$then=e),this.$$callbackInvoke(),this},t.prototype.catch=function(e){return"function"==typeof e&&(this.$$catch=e),this.$$callbackInvoke(),this},t.prototype.finally=function(e){return"function"==typeof e&&(this.$$finally=e),this.$$callbackInvoke(),this},t}AudioNetwork.Injector.registerFactory("Common.SimplePromise",e),e.$inject=[]}(),function(){function e(e){return{build:function(){return new e}}}AudioNetwork.Injector.registerService("Common.StopwatchBuilder",e),e.$inject=["Common.Stopwatch"]}(),function(){function e(){var r;return(r=function(){this.$$running=!1,this.$$timeStart=void 0,this.$$timeEnd=void 0}).STOPWATCH_ALREADY_STARTED_EXCEPTION="Stopwatch already started",r.STOPWATCH_ALREADY_STOPPED_EXCEPTION="Stopwatch already stopped",r.RESET_BEFORE_CALLING_START_EXCEPTION="Reset stopwatch before calling start() again",r.STOPWATCH_WAS_NOT_STARTED_EXCEPTION="stopwatch was not started",r.$$_MILLISECOND_IN_SECOND=1e3,r.prototype.reset=function(){return this.$$running=!1,this.$$timeStart=void 0,this.$$timeEnd=void 0,this},r.prototype.start=function(){if(this.$$running)throw r.STOPWATCH_ALREADY_STARTED_EXCEPTION;if(this.$$timeStart&&this.$$timeEnd)throw r.RESET_BEFORE_CALLING_START_EXCEPTION;return this.$$timeStart=new Date,this.$$running=!0,this},r.prototype.stop=function(){if(!this.$$timeStart)throw r.STOPWATCH_WAS_NOT_STARTED_EXCEPTION;if(!this.$$running)throw r.STOPWATCH_ALREADY_STOPPED_EXCEPTION;return this.$$timeEnd=new Date,this.$$running=!1,this},r.prototype.getDuration=function(e){var t,i=new Date;if(!this.$$timeStart)throw r.STOPWATCH_WAS_NOT_STARTED_EXCEPTION;return t=this.$$running?i.getTime()-this.$$timeStart.getTime():this.$$timeEnd.getTime()-this.$$timeStart.getTime(),e?t/r.$$_MILLISECOND_IN_SECOND:t},r}AudioNetwork.Injector.registerFactory("Common.Stopwatch",e),e.$inject=[]}(),function(){function e(i){return{blackmanNuttall:function(e,t){return.3635819-.4891775*i.cos(2*i.PI*e/(t-1))+.1365995*i.cos(4*i.PI*e/(t-1))-.0106411*i.cos(6*i.PI*e/(t-1))}}}AudioNetwork.Injector.registerService("Common.WindowFunction",e),e.$inject=["Common.MathUtil"]}(),function(){function e(){return{getJavaScriptCode:function(){var e,t,i,r="";switch(AudioNetwork.bootConfig.multicoreState){case AudioNetwork.MULTICORE_STATE.ENABLED_USE_DEV_SCRIPT:e=function(){var e,t,i,r=[];for(e=0;e<AudioNetwork.devScriptList.length;e++)t=AudioNetwork.bootConfig.devScriptBaseUrl+AudioNetwork.devScriptList[e],i=e===AudioNetwork.devScriptList.length-1,r.push("    '"+t+"'"+(i?"":",")+"\n");return r}();break;case AudioNetwork.MULTICORE_STATE.ENABLED_USE_PROD_SCRIPT:i=[],t=AudioNetwork.bootConfig.prodScriptBaseUrl+AudioNetwork.bootConfig.prodScriptName,i.push("    '"+t+"'\n"),e=i}return r+="self.importScripts(                                                                         \n",r+=e.join(""),r+=");                                                                                          \n",r+="                                                                                            \n",r+="var                                                                                         \n",r+="    iAlias = AudioNetwork.Injector,                                                         \n",r+='    ReceiveWorker = iAlias.resolve("PhysicalLayerCore.ReceiveWorker"),                      \n',r+='    ReceiveMulticoreWorker = iAlias.resolve("PhysicalLayerCore.ReceiveMulticoreWorker"),    \n',r+="    receiveWorker = undefined;                                                              \n",r+="                                                                                            \n",r+="// eval(\"console.log('eval inside thread test');\")                                        \n",r+="                                                                                            \n",r+="self.onmessage = function(event) {                                                          \n",r+="    var                                                                                     \n",r+="        data = event.data,                                                                  \n",r+="        messageIndex = data.length > 0 ? data[0] : null,                                    \n",r+="        param = data.length > 0 ? data[1] : null,                                           \n",r+="        promise;                                                                            \n",r+="                                                                                            \n",r+="    switch (messageIndex) {                                                                 \n",r+="        case ReceiveMulticoreWorker.INITIALIZATION:                                         \n",r+="            receiveWorker = new ReceiveWorker(param);                                       \n",r+="            self.postMessage([                                                              \n",r+="                ReceiveMulticoreWorker.INITIALIZATION_SUCCESS                               \n",r+="            ]);                                                                             \n",r+="            break;                                                                          \n",r+="        case ReceiveMulticoreWorker.HANDLE_SAMPLE_BLOCK:                                    \n",r+="            promise = receiveWorker.handleSampleBlock(param);                               \n",r+="            break;                                                                          \n",r+="        case ReceiveMulticoreWorker.COMPUTE_CRAZY_SINE_SUM:                                 \n",r+="            promise = receiveWorker.computeCrazySineSum(param);                             \n",r+="            break;                                                                          \n",r+="    }                                                                                       \n",r+="                                                                                            \n",r+="    if (!promise) {                                                                         \n",r+="        return;                                                                             \n",r+="    }                                                                                       \n",r+="                                                                                            \n",r+="    promise                                                                                 \n",r+="        .then(function (result) {                                                           \n",r+="            self.postMessage([                                                              \n",r+="                messageIndex + ReceiveMulticoreWorker.MESSAGE_INDEX_OFFSET_SUCCESS,         \n",r+="                result                                                                      \n",r+="            ]);                                                                             \n",r+="        })                                                                                  \n",r+="        .catch(function () {                                                                \n",r+="            self.postMessage([                                                              \n",r+="                messageIndex + ReceiveMulticoreWorker.MESSAGE_INDEX_OFFSET_FAIL,            \n",r+="                result                                                                      \n",r+="            ]);                                                                             \n",r+="        });                                                                                 \n",r+="}                                                                                           \n",r+="                                                                                            \n"}}}AudioNetwork.Injector.registerService("PhysicalLayerCore.ReceiveMulticoreWorkerThread",e),e.$inject=[]}(),function(){function e(n,i){var a;return(a=function(e){var t,i,r;if(AudioNetwork.bootConfig.multicoreState===AudioNetwork.MULTICORE_STATE.DISABLED)throw a.MULTICORE_SUPPORT_IS_NOT_ENABLED_EXCEPTION;t=n.getJavaScriptCode(),i=new Blob([t],{type:"application/javascript"}),r=URL.createObjectURL(i),this.$$key=e,this.$$worker=new Worker(r),this.$$worker.onmessage=this.$$onMessage.bind(this),this.$$promise=[],this.$$promise.length=a.MESSAGE_TOTAL,this.$$sendToThread(a.INITIALIZATION,this.$$key)}).MULTICORE_SUPPORT_IS_NOT_ENABLED_EXCEPTION="Multicore support is not enabled",a.PREVIOUS_PROMISE_NOT_RESOLVED_YET_EXCEPTION="Previous promise not resolved yet",a.INITIALIZATION=0,a.INITIALIZATION_SUCCESS=1,a.INITIALIZATION_FAIL=2,a.HANDLE_SAMPLE_BLOCK=3,a.HANDLE_SAMPLE_BLOCK_SUCCESS=4,a.HANDLE_SAMPLE_BLOCK_FAIL=5,a.COMPUTE_CRAZY_SINE_SUM=6,a.COMPUTE_CRAZY_SINE_SUM_SUCCESS=7,a.COMPUTE_CRAZY_SINE_SUM_FAIL=8,a.MESSAGE_TOTAL=9,a.MESSAGE_INDEX_SPACING=3,a.MESSAGE_INDEX_OFFSET_SUCCESS=1,a.MESSAGE_INDEX_OFFSET_FAIL=2,a.prototype.destroy=function(){this.$$worker&&(this.$$worker.terminate(),this.$$worker=void 0)},a.prototype.getInitialization=function(){return this.$$promise[a.INITIALIZATION]},a.prototype.$$onMessage=function(e){var t,i,r=e.data,n=0<r.length?r[0]:null,o=1<r.length?r[1]:null;for(i=0;i<this.$$promise.length;i++)if(t=this.$$promise[i]){switch(n%a.MESSAGE_INDEX_SPACING){case a.MESSAGE_INDEX_OFFSET_SUCCESS:t.resolve(o);break;case a.MESSAGE_INDEX_OFFSET_FAIL:t.reject(o)}this.$$promise[i]=void 0;break}},a.prototype.$$sendToThread=function(e,t){if(this.$$promise[e])throw ReceiveWorker.PREVIOUS_PROMISE_NOT_RESOLVED_YET_EXCEPTION;return this.$$promise[e]=i.build(),this.$$worker.postMessage([e,t]),this.$$promise[e]},a.prototype.computeCrazySineSum=function(e){return this.$$sendToThread(a.COMPUTE_CRAZY_SINE_SUM,e)},a.prototype.handleSampleBlock=function(e){return this.$$sendToThread(a.HANDLE_SAMPLE_BLOCK,e)},a}AudioNetwork.Injector.registerFactory("PhysicalLayerCore.ReceiveMulticoreWorker",e),e.$inject=["PhysicalLayerCore.ReceiveMulticoreWorkerThread","Common.SimplePromiseBuilder"]}(),function(){function e(t,n,o){var e;return(e=function(e){this.$$key=e,this.$$carrierRecovery=t.build(16,16384)}).prototype.computeCrazySineSum=function(e){for(var t=o.build(),i=0,r=0;r<9000111;r++)i+=n.sin(r);return i=e+n.abs(i),t.resolve({key:this.$$key,result:i}),t},e.prototype.handleSampleBlock=function(e){var t,i,r=o.build();for(i=0;i<16384;i++)this.$$carrierRecovery.handleSample(Math.sin(2*Math.PI*(i/16-.25)));return t=this.$$carrierRecovery.getCarrierDetail(),r.resolve({key:this.$$key,result:t}),r},e}AudioNetwork.Injector.registerFactory("PhysicalLayerCore.ReceiveWorker",e),e.$inject=["Common.CarrierRecoveryBuilder","Common.MathUtil","Common.SimplePromiseBuilder"]}(),AudioNetwork.bootConfig.createAlias&&(AudioNetwork.Rewrite={},AudioNetwork.Rewrite.Dsp={},AudioNetwork.Rewrite.PhysicalLayer={},AudioNetwork.Rewrite.DataLinkLayer={},AudioNetwork.Rewrite.Util={},AudioNetwork.Rewrite.WebAudio={},AudioNetwork.Visualizer={},AudioNetwork.Rewrite.Dsp.Complex=AudioNetwork.Injector.resolve("Rewrite.Dsp.Complex"),AudioNetwork.Rewrite.Dsp.Correlator=AudioNetwork.Injector.resolve("Rewrite.Dsp.Correlator"),AudioNetwork.Rewrite.Dsp.Fft=AudioNetwork.Injector.resolve("Rewrite.Dsp.Fft"),AudioNetwork.Rewrite.Dsp.FFTResult=AudioNetwork.Injector.resolve("Rewrite.Dsp.FFTResult"),AudioNetwork.Rewrite.Dsp.WaveAnalyser=AudioNetwork.Injector.resolve("Rewrite.Dsp.WaveAnalyser"),AudioNetwork.Rewrite.Dsp.WaveGenerator=AudioNetwork.Injector.resolve("Rewrite.Dsp.WaveGenerator"),AudioNetwork.Rewrite.PhysicalLayer.PhysicalLayerBuilder=AudioNetwork.Injector.resolve("Rewrite.PhysicalLayer.PhysicalLayerBuilder"),AudioNetwork.Rewrite.DataLinkLayer.DataLinkLayerBuilder=AudioNetwork.Injector.resolve("Rewrite.DataLinkLayer.DataLinkLayerBuilder"),AudioNetwork.Rewrite.Util.Buffer=AudioNetwork.Injector.resolve("Rewrite.Util.Buffer"),AudioNetwork.Rewrite.Util.FrequencyCalculator=AudioNetwork.Injector.resolve("Rewrite.Util.FrequencyCalculator"),AudioNetwork.Rewrite.Util.MusicCalculator=AudioNetwork.Injector.resolve("Rewrite.Util.MusicCalculator"),AudioNetwork.Rewrite.Util.SmartTimer=AudioNetwork.Injector.resolve("Rewrite.Util.SmartTimer"),AudioNetwork.Rewrite.Util.WavAudioFile=AudioNetwork.Injector.resolve("Rewrite.Util.WavAudioFile"),AudioNetwork.Rewrite.WebAudio.AudioMonoIO=AudioNetwork.Injector.resolve("Rewrite.WebAudio.AudioMonoIO"),AudioNetwork.Rewrite.WebAudio.AudioMonoIOLite=AudioNetwork.Injector.resolve("Rewrite.WebAudio.AudioMonoIOLite"),AudioNetwork.Visualizer.AnalyserChart=AudioNetwork.Injector.resolve("Visualizer.AnalyserChart"),AudioNetwork.Visualizer.ConstellationDiagram=AudioNetwork.Injector.resolve("Visualizer.ConstellationDiagram"),AudioNetwork.Visualizer.PowerChart=AudioNetwork.Injector.resolve("Visualizer.PowerChart"),AudioNetwork.Visualizer.SampleChart=AudioNetwork.Injector.resolve("Visualizer.SampleChart"),AudioNetwork.Visualizer.FrequencyDomainChart=AudioNetwork.Injector.resolve("Visualizer.FrequencyDomainChart"),AudioNetwork.Visualizer.ComplexPlaneChart=AudioNetwork.Injector.resolve("Visualizer.ComplexPlaneChart"),AudioNetwork.PhysicalLayer={},AudioNetwork.PhysicalLayerAdapter={},AudioNetwork.Audio={},AudioNetwork.Common={},AudioNetwork.PhysicalLayer.PhysicalLayer=AudioNetwork.Injector.resolve("PhysicalLayer.PhysicalLayer"),AudioNetwork.PhysicalLayer.DefaultConfig=AudioNetwork.Injector.resolve("PhysicalLayer.DefaultConfig"),AudioNetwork.PhysicalLayer.RxInput=AudioNetwork.Injector.resolve("PhysicalLayer.RxInput"),AudioNetwork.PhysicalLayerAdapter.TransmitAdapter=AudioNetwork.Injector.resolve("PhysicalLayerAdapter.TransmitAdapter"),AudioNetwork.PhysicalLayerAdapter.ReceiveAdapter=AudioNetwork.Injector.resolve("PhysicalLayerAdapter.ReceiveAdapter"),AudioNetwork.Audio.ActiveAudioContext=AudioNetwork.Injector.resolve("Audio.ActiveAudioContext"),AudioNetwork.Audio.SimpleAudioContext=AudioNetwork.Injector.resolve("Audio.SimpleAudioContext"),AudioNetwork.Common.Queue=AudioNetwork.Injector.resolve("Common.Queue"),AudioNetwork.Common.CarrierRecovery=AudioNetwork.Injector.resolve("Common.CarrierRecovery"),AudioNetwork.Common.CarrierGenerate=AudioNetwork.Injector.resolve("Common.CarrierGenerate"),AudioNetwork.Common.WindowFunction=AudioNetwork.Injector.resolve("Common.WindowFunction"),AudioNetwork.Common.Util=AudioNetwork.Injector.resolve("Common.Util")),AudioNetwork.isNode&&(module.exports=AudioNetwork);